{"version":3,"sources":["global_parameters.js","services/auth.service.js","components/login.component.js","components/register.component.js","services/auth-header.js","services/user.service.js","components/home.component.js","components/profile.component.js","services/document.service.js","services/annotation.service.js","components/documents.component.js","services/contributor.service.js","components/document.description.contributor.component.js","components/document.description.contributor.createform.component.js","services/title.service.js","components/document.description.title.component.js","components/document.description.availablelang.component.js","components/document.description.title.createform.component.js","components/document.description.availablelang.createform.component.js","components/document.description.component.js","services/recording.service.js","services/image.service.js","components/document.resources.component.js","components/imageMultiSelector.component.js","components/document.annotation.audio.component.js","components/document.annotation.image.component.js","services/form.service.js","services/translation.service.js","services/note.service.js","components/document.annotation.text.item.createform.component.js","components/document.annotation.note.component.js","components/document.annotation.text.item.component.js","components/document.annotation.form.component.js","components/document.annotation.translation.component.js","components/document.annotation.splitform.component.js","components/document.annotation.component.js","components/document.annotations.import.component.js","components/document.annotations.component.js","components/document.component.js","components/player/DisplayOptions.js","components/player/Player.js","components/player/Picture.js","components/player/Note.js","components/player/Morpheme.js","components/player/PlayButton.js","components/player/Word.js","components/player/Sentence.js","components/player/Annotations.js","components/document.preview.component.js","components/document.export.component.js","App.js","reportWebVitals.js","translation.js","index.js"],"names":["globalParameters","window","location","hostname","API_URL","username","password","axios","post","then","response","data","token","localStorage","setItem","JSON","stringify","removeItem","email","parse","getItem","Copyright","Typography","variant","color","align","Link","href","Date","getFullYear","required","value","className","role","Login","props","handleLogin","bind","onChangeUsername","onChangePassword","state","loading","message","e","this","setState","target","preventDefault","form","validateAll","AuthService","login","history","push","reload","error","resMessage","toString","classes","Container","component","maxWidth","CssBaseline","paper","Avatar","avatar","onSubmit","ref","c","TextField","margin","fullWidth","id","label","name","autoComplete","autoFocus","onChange","validations","type","CircularProgress","FormControlLabel","control","Checkbox","Button","submit","Grid","container","item","xs","Box","mt","Component","withStyles","theme","marginTop","spacing","display","flexDirection","alignItems","backgroundColor","palette","secondary","main","width","isEmail","vusername","length","vpassword","Register","handleRegister","onChangeEmail","successful","checkBtn","context","_errors","register","src","alt","htmlFor","style","authHeader","user","Authorization","Promise","resolve","reject","get","headers","res","catch","err","Home","currentUser","getCurrentUser","content","withRouter","Profile","currentUserDocuments","organization","xmlFile","docId","formData","FormData","append","lang","put","delete","document_id","Documents","handleCloseCreateDialog","event","openCreateDialog","handleOpenCreateDialog","handleCloseDeleteDialog","openDeleteDialog","handleOpenDeleteDialog","handleLangChange","langCorpus","handleTypeChange","typeOfDocument","handleCreateDocument","DocumentService","create","responseDoc","rank","AnnotationService","responseAnnotation","handleDeleteDocument","documentToDelete","UserService","getUserDocuments","status","columns","field","headerName","renderCell","params","size","map","Chip","toUpperCase","title","editable","IconButton","aria-label","onClick","docs","forEach","d","key","titles","actions","height","Dialog","open","onClose","aria-labelledby","DialogTitle","DialogContent","DialogContentText","rel","noValidate","FormControl","InputLabel","Select","labelId","MenuItem","DialogActions","rows","pageSize","checkboxSelection","disableSelectionOnClick","Contributor","handleDelete","ContributorService","contributor","getContributors","alert","charAt","firstName","lastName","onDelete","ContributorCreateForm","onContributorFirstNameChange","firstname","onContributorLastNameChange","lastname","onContributorTypeChange","typeOfContributor","handleSubmit","inputEnabled","documentId","visibility","hidden","placeholder","Title","TitleService","getTitles","AvailableLanguage","list","splice","indexOf","available_lang","available_kindOf","update","updateLanguages","TitleCreateForm","console","log","native","inputProps","a","AvailableLanguageCreateForm","maxLength","DocumentDescription","getDocumentContributors","document","contributors","openNewContributor","getDocumentTitles","openNewTitle","handleDeleteTitle","onBlur","openNewContributorForm","openNewTitleForm","openNewAvailableLanguageForm","openNewAvailableLanguage","openNewAvailableKindOfForm","openNewAvailableKindOf","affiliation","recording_date","recording_place","t","l","helperText","InputLabelProps","shrink","split","icon","clickable","getLanguages","getKindOf","resourceFile","filename","DocumentResources","handleOpenAddDialog","openAddDialog","handleCloseAddDialog","resourceId","selectedResourceId","onNameChange","nameInDocument","handleUpload","getElementById","files","hasRecording","RecordingService","recording","errorMessage","ImageService","maxImageRank","images","handleCloseSnackBar","handleDeleteResource","selectedResourceType","refreshResources","resources","i","preview","controls","row","Input","aria-describedby","accept","FormHelperText","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","action","Fragment","fontSize","ImageMultiSelector","changeCoordinate","coordinate","index","coordinates","imageSelectionData","imageId","image","x","parseFloat","toFixed","y","currentAnnotationEdition","deleteCoordinate","divCanvas","React","createRef","imageCanvas","badgeStyleCommon","canvas","badgeStyleForm","position","top","borderRadius","fontWeight","textAlign","badgeStyleTranslation","right","hasForm","hasTranslation","coords","areaCoords","styleImageCanvas","showImageCanvas","left","border","borderColor","borderStyle","cursor","showAnnotation","imageSelectorWidth","Image","scaleX","naturalWidth","imageRatio","previousSibling","Audio","handleEdit","annotationId","annotationLabel","wavesurfer","regions","remove","addRegion","start","end","drag","resize","handleMouseSelection","handleEditionState","handleCancel","originalStart","originalEnd","handlePlay","playing","isPlaying","pause","play","on","onStartChange","onEndChange","audioStart","audioEnd","markers","filter","m","marker","addMarker","time","substring","disabled","imageAddition","imageCoords","handleEditImageAddition","originalImageCoords","currentAnnotationEditionId","imageElements","x1","y1","splitCoords","overflow","image_id","annotation_id","kindOf","text","parent_type","parent_id","TextItemCreateForm","onLangChange","onTextChange","FormService","parentId","refresh","TranslationService","NoteService","parentType","refreshNotesParent","multiline","rowsMax","Note","note_available_lang","TextItem","handleExpand","panel","isExpanded","expanded","originalLang","originalText","openNewNoteForm","openNewNote","Accordion","AccordionSummary","expandIcon","aria-controls","AccordionDetails","refreshNotes","notes","note","Form","Translation","forceUpdate","SplitForm","nbWords","splittedForm","formToSplit","audioStep","imageStep","imageWidth","imageHeight","firstImage","Math","max","imageToSplit","isOnFirstImage","j","k","audioSplitStart","audioSplitEnd","x2","successNb","responseFormCreate","join","DocumentAnnotation","handleDeleteAnnotation","undefined","refreshAnnotations","handleAddChild","childType","nextChildRank","annotationHasChanged","openNewFormForm","openNewForm","openNewTranslationForm","openNewTranslation","openSplitForm","openSplit","getAnnotationForms","forms","getAnnotationTranslations","translations","getAnnotationChildren","children","children_annotations","lastRank","apply","parentAnnotations","childrenType","gutterBottom","translation","DocumentAnnotationsImport","handleCloseImportDialog","openImportDialog","handleOpenImportDialog","getElementsByName","importedData","progress","handleImport","that","estimatedDelay","setInterval","percentUnit","import","TEXT","WORDLIST","bottom","justifyContent","round","displayOptions","DocumentAnnotations","handleSliderChange","newValue","zoom","crop","openEditionNotification","handleShowImageCanvas","querySelectorAll","checked","handleNewAnnotationTypeChange","selectParentAnnotationElement","newAnnotationType","parentAnnotationId","selectedOptions","attributes","handleParentAnnotationChange","handleCloseCreateDrawer","annotationPanel","change","hasAudioSelection","refreshParentAnnotationsList","p","audioSelection","show","annotationsPanel","editionType","editionData","editionNotification","imageSelection","handleCreateAnnotation","updateAnnotation","handleCloseEdition","image_coords","annotations","documentType","nextSentenceRank","s","nextWordRank","w","nextMorphemeRank","loadCanvas","annotation","array","imageCoord","convertAnnotationsToTree","canHide","children_annotation","canvasList","getDocumentAnnotations","refreshDocumentAnnotations","loadRegions","selectedAnnotation","playPause","toggleAnnotationsDrawer","anchor","toggleImportDrawer","importPanel","selectionExists","exist","hasImageSelection","render","docType","TabPanel","other","div","imagesTabs","imagesTabContents","area","Tab","a11yProps","tabValue","Slider","Drawer","AppBar","Tabs","Switch","FormLabel","RadioGroup","Radio","labelPlacement","selected","minHeight","previewCanvasRef","Object","keys","region","showTooltip","track","querySelector","WaveSurfer","cursorWidth","progressColor","responsive","waveColor","cursorColor","pixelRatio","scrollParent","normalize","minimap","backend","plugins","RegionsPlugin","preventContextMenu","MinimapPlugin","TimelinePlugin","MarkersPlugin","enableDragSelection","stopPropagation","shiftKey","playLoop","element","once","load","addEventListener","tagName","deltaY","passive","DisplayOptions","textTranscriptions","textTranslations","sentenceTranscriptions","options","sentence","transcriptions","sentenceTranslations","wordTranscriptions","wordTranslations","morphemeTranscriptions","morphemeTranslations","displayNotes","mode","continuousPlay","inputName","checkedTranscriptions","transName","isWordList","buildUrl","checkedTranslations","checkedNotes","FormGroup","handleCheck","Divider","transc","includes","handleTranscriptionOptions","transl","handleTranslationOptions","word","morpheme","nl","handleNotesOptions","Player","createElement","innerHTML","scriptStr","instance","appendChild","highlight","updatePosition","timeList","find","currentAnchor","currentSentence","classList","add","Event","dispatchEvent","scrollIntoView","block","playerIsLoaded","mediaElement","audioStyle","file","audio","preload","video","url","el","Picture","onmouseover","wordid","nodeValue","canva","image_scope","image_width","usemap","sentenceId","cssBGPosition","imgStyle","class","Morpheme","handleClick","anchorEl","currentTarget","handleClose","idNote","currentTime","AUDIO","node","notesJSON","NOTE","f","isGlossIncluded","thisClassName","TRANSL","getNotes","n","FORM","hasOwnProperty","wID","words","playSentence","PlayArrow","pauseSentence","Pause","PlayButton","showPlayPause","displayPlay","paused","duration","player","setTimeout","Word","isNaN","Boolean","popperId","tableBordered","visible","invisible","tableBorderedVisible","tableBorderedInvisible","availableOptions","found","styleCombined","notesSup","morphemes","M","sID","Popper","test","doi","onMouseOver","Sentence","AREA","delta_x","delta_y","W","Array","isArray","divWord","canvasStyle","click","avatarStyle","blue","Card","CardContent","imageSrc","Annotations","isLoaded","annotationData","trackTest","trackTranscription","trackTranslation","annotationItems","wholeTranscriptions","wholeTranslations","textTracks","getTrackById","sentences","S","wordlist","doiSentenceUrl","cues","transcSubtitle","translSubtitle","cueStart","cueEnd","cueTransc","VTTCue","cueTransl","line","addCue","doiWordUrl","fixed","extensionFile","urlFile","replace","DocumentPreview","hasPrimaryId","hasSecondaryId","isAnnotationsLoaded","hasMediaError","mediaError","hasAnnotationsError","annotationsError","MEDIAFILE","langOptions","playerLoaded","annotationsEditor","annotationsPlayer","shape","morph","convertToPlayerFormat","convertedAnnotations","typeOf","DocumentExport","Document","refreshDocument","tabId","parseInt","getUrlParameter","match","parseTypeOf","currentDocument","sVar","unescape","search","RegExp","escape","URLSearchParams","set","newUrl","protocol","host","pathname","pushState","types","createMuiTheme","primary","background","default","typography","fontFamily","App","handleToggle","openMenu","handleCloseMenu","redirect","notificationLink","logOut","anchorRef","logout","aria-haspopup","current","transition","disablePortal","TransitionProps","placement","Grow","transformOrigin","Paper","ClickAwayListener","onClickAway","MenuList","autoFocusItem","onKeyDown","handleListKeyDown","to","startIcon","disableElevation","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","en","fr","ReactDOM","basename","language"],"mappings":"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","file":"static/js/main.46f2735c.chunk.js","sourcesContent":["var globalParameters = {\r\n  'API_URL': (window.location.hostname==='localhost')?'http://localhost:8000/api/':'https://eastling.huma-num.fr/api/'\r\n}\r\n\r\nexport default globalParameters;","import axios from \"axios\";\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL + 'auth/';\r\n\r\nclass AuthService {\r\n  login(username, password) {\r\n  \t\r\n    return axios\r\n      .post(API_URL + \"login\", {\r\n        username,\r\n        password\r\n      })\r\n      .then(response => {\r\n        if (response.data.token) {\r\n\r\n          localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n\r\n        }\r\n\r\n        return response.data;\r\n      });\r\n  }\r\n\r\n  logout() {\r\n    localStorage.removeItem(\"user\");\r\n  }\r\n\r\n  register(username, email, password) {\r\n    return axios.post(API_URL + \"signup\", {\r\n      username,\r\n      email,\r\n      password\r\n    });\r\n  }\r\n\r\n  getCurrentUser() {\r\n    return JSON.parse(localStorage.getItem('user'));\r\n  }\r\n}\r\n\r\nexport default new AuthService();\r\n","import React, { Component } from \"react\";\r\nimport Form from \"react-validation/build/form\";\r\n//import Input from \"react-validation/build/input\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Link from '@material-ui/core/Link';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Box from '@material-ui/core/Box';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright  '}\r\n      <Link color=\"inherit\" href=\"https://eastling.huma-num.fr\">\r\n        Matthew DEO / LACITO (C.N.R.S)\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst styles = (theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n});\r\n\r\nconst required = value => {\r\n  if (!value) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        This field is required!\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nclass Login extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleLogin = this.handleLogin.bind(this);\r\n    this.onChangeUsername = this.onChangeUsername.bind(this);\r\n    this.onChangePassword = this.onChangePassword.bind(this);\r\n\r\n    this.state = {\r\n      username: \"\",\r\n      password: \"\",\r\n      loading: false,\r\n      message: \"\"\r\n    };\r\n  }\r\n\r\n  onChangeUsername(e) {\r\n    this.setState({\r\n      username: e.target.value\r\n    });\r\n  }\r\n\r\n  onChangePassword(e) {\r\n    this.setState({\r\n      password: e.target.value\r\n    });\r\n  }\r\n\r\n  handleLogin(e) {\r\n    e.preventDefault();\r\n\r\n    this.setState({\r\n      message: \"\",\r\n      loading: true\r\n    });\r\n\r\n    this.form.validateAll();\r\n\r\n      AuthService.login(this.state.username, this.state.password).then(\r\n        () => {\r\n          this.props.history.push(\"/documents\");\r\n          window.location.reload();\r\n        },\r\n        error => {\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        }\r\n      );\r\n\r\n    \r\n  }\r\n\r\n  render() {\r\n  \tconst { classes } = this.props;\r\n    return (\r\n        <Container component=\"main\" maxWidth=\"xs\">\r\n\t      <CssBaseline />\r\n\t      <div className={classes.paper}>\r\n\t        <Avatar className={classes.avatar}>\r\n\t          <LockOutlinedIcon />\r\n\t        </Avatar>\r\n\t        <Typography component=\"h1\" variant=\"h5\">\r\n\t          Sign in\r\n\t        </Typography>\r\n\t        \r\n\t        <Form\r\n            className={classes.form}\r\n            onSubmit={this.handleLogin}\r\n            ref={c => {\r\n              this.form = c;\r\n            }}\r\n          >\r\n\t          <TextField\r\n\t            variant=\"outlined\"\r\n\t            margin=\"normal\"\r\n\t            required\r\n\t            fullWidth\r\n\t            id=\"username\"\r\n\t            label=\"Username\"\r\n\t            name=\"username\"\r\n\t            autoComplete=\"username\"\r\n\t            autoFocus\r\n                value={this.state.username}\r\n                onChange={this.onChangeUsername}\r\n                validations={[required]}\r\n\t          />\r\n\t          <TextField\r\n\t            variant=\"outlined\"\r\n\t            margin=\"normal\"\r\n\t            required\r\n\t            fullWidth\r\n\t            name=\"password\"\r\n\t            label=\"Password\"\r\n\t            type=\"password\"\r\n\t            id=\"password\"\r\n\t            autoComplete=\"current-password\"\r\n                className=\"form-control\"\r\n                value={this.state.password}\r\n                onChange={this.onChangePassword}\r\n                validations={[required]}\r\n\t          />\r\n\t          \r\n\r\n            {this.state.loading && \r\n              <Container >\r\n\r\n                  <CircularProgress />\r\n\r\n              </Container>\r\n            }\r\n            {!this.state.loading && \r\n              <div>\r\n                <FormControlLabel\r\n                  control={<Checkbox value=\"remember\" color=\"primary\" />}\r\n                  label=\"Remember me\"\r\n                />\r\n                <Button\r\n                  type=\"submit\"\r\n                  fullWidth\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  className={classes.submit}\r\n                >\r\n                  Sign In\r\n                </Button>\r\n                <Grid container>\r\n                <Grid item xs>\r\n                  <Link href=\"#\" variant=\"body2\">\r\n                    Forgot password?\r\n                  </Link>\r\n                </Grid>\r\n                <Grid item>\r\n                  <Link href=\"#\" variant=\"body2\">\r\n                    {\"Don't have an account? Sign Up\"}\r\n                  </Link>\r\n                </Grid>\r\n              </Grid>\r\n            </div>\r\n            }\r\n\r\n\t          \r\n\t        </Form>\r\n\t      </div>\r\n\t      <Box mt={8}>\r\n\t        <Copyright />\r\n\t      </Box>\r\n\r\n\t    </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(Login);\r\n","import React, { Component } from \"react\";\r\nimport Form from \"react-validation/build/form\";\r\nimport Input from \"react-validation/build/input\";\r\nimport CheckButton from \"react-validation/build/button\";\r\nimport { isEmail } from \"validator\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\n\r\nconst required = value => {\r\n  if (!value) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        This field is required!\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nconst email = value => {\r\n  if (!isEmail(value)) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        This is not a valid email.\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nconst vusername = value => {\r\n  if (value.length < 3 || value.length > 20) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        The username must be between 3 and 20 characters.\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nconst vpassword = value => {\r\n  if (value.length < 6 || value.length > 40) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        The password must be between 6 and 40 characters.\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nexport default class Register extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleRegister = this.handleRegister.bind(this);\r\n    this.onChangeUsername = this.onChangeUsername.bind(this);\r\n    this.onChangeEmail = this.onChangeEmail.bind(this);\r\n    this.onChangePassword = this.onChangePassword.bind(this);\r\n\r\n    this.state = {\r\n      username: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      successful: false,\r\n      message: \"\"\r\n    };\r\n  }\r\n\r\n  onChangeUsername(e) {\r\n    this.setState({\r\n      username: e.target.value\r\n    });\r\n  }\r\n\r\n  onChangeEmail(e) {\r\n    this.setState({\r\n      email: e.target.value\r\n    });\r\n  }\r\n\r\n  onChangePassword(e) {\r\n    this.setState({\r\n      password: e.target.value\r\n    });\r\n  }\r\n\r\n  handleRegister(e) {\r\n    e.preventDefault();\r\n\r\n    this.setState({\r\n      message: \"\",\r\n      successful: false\r\n    });\r\n\r\n    this.form.validateAll();\r\n\r\n    if (this.checkBtn.context._errors.length === 0) {\r\n      AuthService.register(\r\n        this.state.username,\r\n        this.state.email,\r\n        this.state.password\r\n      ).then(\r\n        response => {\r\n          this.setState({\r\n            message: response.data.message,\r\n            successful: true\r\n          });\r\n        },\r\n        error => {\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            successful: false,\r\n            message: resMessage\r\n          });\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"col-md-12\">\r\n        <div className=\"card card-container\">\r\n          <img\r\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\r\n            alt=\"profile-img\"\r\n            className=\"profile-img-card\"\r\n          />\r\n\r\n          <Form\r\n            onSubmit={this.handleRegister}\r\n            ref={c => {\r\n              this.form = c;\r\n            }}\r\n          >\r\n            {!this.state.successful && (\r\n              <div>\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"username\">Username</label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    className=\"form-control\"\r\n                    name=\"username\"\r\n                    value={this.state.username}\r\n                    onChange={this.onChangeUsername}\r\n                    validations={[required, vusername]}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"email\">Email</label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    className=\"form-control\"\r\n                    name=\"email\"\r\n                    value={this.state.email}\r\n                    onChange={this.onChangeEmail}\r\n                    validations={[required, email]}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"password\">Password</label>\r\n                  <Input\r\n                    type=\"password\"\r\n                    className=\"form-control\"\r\n                    name=\"password\"\r\n                    value={this.state.password}\r\n                    onChange={this.onChangePassword}\r\n                    validations={[required, vpassword]}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <button className=\"btn btn-primary btn-block\">Sign Up</button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {this.state.message && (\r\n              <div className=\"form-group\">\r\n                <div\r\n                  className={\r\n                    this.state.successful\r\n                      ? \"alert alert-success\"\r\n                      : \"alert alert-danger\"\r\n                  }\r\n                  role=\"alert\"\r\n                >\r\n                  {this.state.message}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <CheckButton\r\n              style={{ display: \"none\" }}\r\n              ref={c => {\r\n                this.checkBtn = c;\r\n              }}\r\n            />\r\n          </Form>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n","export default function authHeader() {\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n  if (user && user.token) {\r\n    return { Authorization: 'Bearer ' + user.token };\r\n  } else {\r\n    return {};\r\n  }\r\n}\r\n"," import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass UserService {\r\n  getUserDocuments() {\r\n  \t//si un code 401 Unauthorized est renvoy par cette requte, cela signifie que :\r\n  \t// - le token n'est plus valable\r\n  \t// - l'utilisateur n'est pas connect\r\n  \t// dans les 2 cas il faut le rediriger vers la page de login\r\n   return new Promise((resolve, reject) => {\r\n    axios.get(API_URL + 'documents', { headers: authHeader() })\r\n      .then(res => { resolve(res) })\r\n      .catch(err => { reject(err) })\r\n    });\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default new UserService();\r\n","import React, { Component } from \"react\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\nimport UserService from \"../services/user.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass Home extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      currentUser: AuthService.getCurrentUser(),\r\n    };\r\n\r\n    if(AuthService.getCurrentUser() === null){\r\n      this.props.history.push('/login');\r\n    }else{\r\n      this.props.history.push('/documents');\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    \r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container\">\r\n        <header className=\"jumbotron\">\r\n          <h3>{this.state.content}</h3>\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Home);\r\n","import React, { Component } from \"react\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport Container from '@material-ui/core/Container';\r\n\r\nclass Profile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentUser: AuthService.getCurrentUser(),\r\n      currentUserDocuments:[]\r\n    };\r\n  }\r\n\r\n\r\n\r\n  componentDidMount() {\r\n    if(AuthService.getCurrentUser() === null){\r\n      this.props.history.push('/login');\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if(this.state.currentUser !== null){\r\n\r\n      return (\r\n        <Container>\r\n          <header className=\"jumbotron\">\r\n            <h3>\r\n             Profile\r\n            </h3>\r\n          </header>\r\n          <p>\r\n            <strong>Username:</strong>{\" \"}\r\n            {this.state.currentUser.username}\r\n          </p>\r\n          <p>\r\n            <strong>Email:</strong>{\" \"}\r\n            {this.state.currentUser.email}\r\n          </p>\r\n          <p>\r\n            <strong>Organization:</strong>{\" \"}\r\n            {this.state.currentUser.organization}\r\n          </p>\r\n        </Container>\r\n      );\r\n    }else{\r\n      return (<div></div>);\r\n    }\r\n  }\r\n}\r\n\r\nexport default withRouter(Profile);\r\n","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass DocumentService {\r\n\r\n\timport(xmlFile, docId) {\r\n\t    let formData = new FormData();\r\n\t    formData.append(\"file\", xmlFile);\r\n\t    formData.append(\"docId\", docId);\r\n\r\n\t    authHeader['Content-Type'] = 'multipart/form-data';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"import\", formData,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\r\n  \t}\r\n\r\n  \tget(docId) {\r\n\t    return axios.get(API_URL + 'documents/' + docId, { headers: authHeader() })\r\n\t      .then(response => response.data);\r\n\t  }\r\n\r\n  \tcreate(lang, type) {\r\n  \t\tlet formData = new FormData();\r\n\t    formData.append(\"lang\", lang);\r\n\t    formData.append(\"type\", type);\r\n\r\n\t    authHeader['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"documents\", formData,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tupdate(docId,data) {\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.put(API_URL + \"documents/\" + docId, data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n\r\n  \tdelete(docId) {\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"documents/\" + docId,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new DocumentService();\r\n","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass AnnotationService {\r\n\r\n\tgetDocumentAnnotations(document_id) {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"documents/\"+document_id+\"/annotations\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\r\n\t}\r\n\r\n\tgetAnnotationChildren(id) {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"annotations/\"+id+\"/children\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\r\n\t}\r\n\r\n  \tget(id) {\r\n\t    return axios.get(API_URL + 'annotations/' + id, { headers: authHeader() })\r\n\t      .then(response => response.data);\r\n\t }\r\n\r\n\t update(id,data){\r\n/*\r\n\t    let data = {\r\n\t    \taudioStart:audioStart,\r\n\t    \taudioEnd:audioEnd,\r\n\t    \timage_id:imageId,\r\n\t    \tareaCoords:areaCoords\r\n\t    };\r\n\r\n*/\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.put(API_URL + \"annotations/\" +id, data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tcreate(data) {\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"annotations\",data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"annotations/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new AnnotationService();\r\n","import React, { Component } from \"react\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport UserService from \"../services/user.service\";\r\nimport DocumentService from \"../services/document.service\";\r\nimport AnnotationService from \"../services/annotation.service\";\r\n\r\nimport { DataGrid } from '@material-ui/data-grid';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass Documents extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentUser: AuthService.getCurrentUser(),\r\n      currentUserDocuments:[],\r\n      openCreateDialog: false,\r\n      openDeleteDialog: false,\r\n      typeOfDocument: \"TEXT\",\r\n      langCorpus: \"\",\r\n      loading: false,\r\n      documentToDelete: null\r\n    };\r\n\r\n    if(AuthService.getCurrentUser() === null)\r\n      this.props.history.push('/login');\r\n  }\r\n\r\n  handleCloseCreateDialog = (event) => {\r\n    this.setState({\r\n        openCreateDialog: false\r\n      });\r\n  };\r\n\r\n  handleOpenCreateDialog = (event) => {\r\n    this.setState({\r\n        openCreateDialog: true\r\n      });\r\n  };\r\n\r\n  handleCloseDeleteDialog = (event) => {\r\n    this.setState({\r\n        openDeleteDialog: false\r\n      });\r\n  };\r\n\r\n  handleOpenDeleteDialog = (event) => {\r\n    this.setState({\r\n        openDeleteDialog: true\r\n      });\r\n  };\r\n\r\n  handleLangChange = (event) => {\r\n    this.setState({\r\n        langCorpus: event.target.value\r\n      });\r\n  };\r\n\r\n  handleTypeChange = (event) => {\r\n    this.setState({\r\n        typeOfDocument: event.target.value\r\n      });\r\n  };\r\n\r\n  handleCreateDocument = (event) => {\r\n    event.preventDefault();\r\n\r\n    this.setState({\r\n      loading: true\r\n    });\r\n\r\n      DocumentService.create(this.state.langCorpus, this.state.typeOfDocument).then(\r\n        (responseDoc) => {\r\n          //When the document is successfully created, we automatically create the top level node annotation (TEXT)\r\n          var data={\r\n            document_id:responseDoc.data.id,\r\n            type:'T',\r\n            rank:1\r\n          };\r\n          AnnotationService.create(data).then(\r\n            (responseAnnotation) => {\r\n              this.props.history.push(\"/documents/\"+responseDoc.data.id+\"?tab=0\");\r\n            },\r\n            error => {\r\n              const resMessage =\r\n                (error.responseAnnotation &&\r\n                  error.responseAnnotation.data &&\r\n                  error.responseAnnotation.data.message) ||\r\n                error.message ||\r\n                error.toString();\r\n\r\n              this.setState({\r\n                loading: false,\r\n                message: resMessage\r\n              });\r\n            }\r\n          );\r\n\r\n        },\r\n        error => {\r\n          const resMessage =\r\n            (error.responseDoc &&\r\n              error.responseDoc.data &&\r\n              error.responseDoc.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        }\r\n      );\r\n  };\r\n\r\n  handleDeleteDocument = (event) => {\r\n    this.setState({\r\n      loading: true,\r\n    });\r\n    DocumentService.delete(this.state.documentToDelete).then(\r\n      (response) => {\r\n          window.location.reload();\r\n        },\r\n        error => {\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        });\r\n  };\r\n\r\n\r\n  componentDidMount() {\r\n\r\n      this.setState({\r\n        loading: true,\r\n      });\r\n\r\n      if(this.state.currentUser !== null)\r\n        {\r\n          UserService.getUserDocuments().then(\r\n            response => {\r\n              this.setState({\r\n                currentUserDocuments:response.data,\r\n                loading:false\r\n              });\r\n            },\r\n            error => {\r\n              if(error.response.status===401) this.props.history.push('/login');\r\n              this.setState({\r\n                currentUserDocuments:\r\n                  (error.response && error.response.data) ||\r\n                  error.message ||\r\n                  error.toString(),\r\n                  loading:false\r\n              });\r\n            }\r\n          );\r\n        }\r\n\r\n  }\r\n\r\n  render() {\r\n    if(this.state.currentUser !== null){\r\n\r\n      const columns: GridColDef[] = [\r\n        { field: 'id', headerName: 'ID', width: 90 },\r\n        {\r\n          field: 'titles',\r\n          headerName: 'Title(s)',\r\n          width: 300,\r\n          renderCell: (params) => (\r\n            <Container\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              component=\"div\"\r\n            >\r\n            {params.value.map(\r\n              (item) => <Chip\r\n                key={item.id}\r\n                avatar={<Avatar>{item.lang.toUpperCase()}</Avatar>}\r\n                label={item.title} \r\n                color=\"secondary\"\r\n                />\r\n              )\r\n            }\r\n            </Container>\r\n        )\r\n        },\r\n        {\r\n          field: 'lang',\r\n          headerName: 'Language',\r\n          width: 120,\r\n          editable: true,\r\n          renderCell: (params) => (\r\n            <Container\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              component=\"div\"\r\n            >\r\n            <Chip\r\n              key={params.id}\r\n              label={params.value} \r\n              color=\"secondary\"\r\n            />\r\n\r\n            </Container>\r\n        )\r\n        },\r\n        {\r\n          field: 'type',\r\n          headerName: 'Type',\r\n          width: 120,\r\n          editable: true,\r\n        },\r\n        {\r\n          field: 'actions',\r\n          headerName: 'Actions',\r\n          width: 200,\r\n          editable: false,\r\n\r\n          renderCell: (params) => {\r\n            const onClick = () => {\r\n              this.setState({\r\n                openDeleteDialog: true,\r\n                documentToDelete: params.id\r\n              });\r\n            };\r\n\r\n            return(\r\n            <div id={\"actionsDocument_\"+params.id}>\r\n            <IconButton color=\"primary\" aria-label=\"Edit document\" onClick={()=>this.props.history.push(\"/documents/\" + params.id + \"?tab=0\")}>\r\n                <EditIcon />\r\n            </IconButton>\r\n            <IconButton color=\"primary\" aria-label=\"Download document\">\r\n              <CloudDownloadIcon />\r\n            </IconButton>\r\n            <IconButton color=\"primary\" aria-label=\"Send document for deposit\">\r\n              <SendIcon />\r\n            </IconButton>\r\n            <IconButton color=\"primary\" aria-label=\"Delete document\" onClick={onClick}>\r\n              <DeleteIcon />\r\n            </IconButton>\r\n            </div>\r\n            );\r\n            }\r\n        }\r\n      ];\r\n\r\n      var docs = [];\r\n      \r\n      if(typeof this.state.currentUserDocuments !== 'string' && this.state.currentUserDocuments.length > 0){\r\n        this.state.currentUserDocuments.forEach((d) => {\r\n           docs.push({key:d.id,id:d.id,titles:d.titles,lang:d.lang,type:d.type,actions:d.id}\r\n              );\r\n\r\n        });\r\n      }\r\n\r\n      return (\r\n        <Container>\r\n          <header className=\"jumbotron\">\r\n            <h3>\r\n             My documents\r\n            </h3>\r\n          </header>\r\n          <div>\r\n            <div style={{ height: 600, width: '80%' }}>\r\n              <IconButton color=\"primary\" aria-label=\"Add document\" onClick={this.handleOpenCreateDialog}>\r\n                  <AddIcon />\r\n              </IconButton>\r\n              <Dialog open={this.state.openCreateDialog} onClose={this.handleCloseCreateDialog} aria-labelledby=\"form-createdialog-title\">\r\n                <DialogTitle id=\"form-createdialog-title\">Create a new document</DialogTitle>\r\n                <DialogContent>\r\n                  <DialogContentText>\r\n                    Please refer to the <a target=\"_blank\" rel=\"noreferrer\" href=\"https://iso639-3.sil.org/code_tables/639/data/all\">ISO 639-3 code tables</a>.\r\n                  </DialogContentText>\r\n                    <form noValidate>\r\n                      <div>\r\n                        <TextField\r\n                          autoFocus\r\n                          margin=\"dense\"\r\n                          id=\"name\"\r\n                          label=\"Language ISO 639-3 Code\"\r\n                          type=\"text\"\r\n                          fullWidth\r\n                          onChange={this.handleLangChange}\r\n                        />\r\n                      </div>\r\n                      <FormControl>\r\n                        <InputLabel id=\"select-type-label\">Type of document</InputLabel>\r\n                        <Select\r\n                          labelId=\"select-type-label\"\r\n                          id=\"type\"\r\n                          value={this.state.typeOfDocument}\r\n                          onChange={this.handleTypeChange}\r\n                        >\r\n                          <MenuItem value={\"TEXT\"}>Text</MenuItem>\r\n                          <MenuItem value={\"WORDLIST\"}>Wordlist</MenuItem>\r\n                        </Select>\r\n                      </FormControl>\r\n                    </form>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  <Button onClick={this.handleCloseCreateDialog} color=\"primary\">\r\n                    Cancel\r\n                  </Button>\r\n                  <Button onClick={this.handleCreateDocument} color=\"primary\">\r\n                    Create document\r\n                  </Button>\r\n                </DialogActions>\r\n              </Dialog>\r\n\r\n              <Dialog open={this.state.openDeleteDialog} onClose={this.handleCloseDeleteDialog} aria-labelledby=\"form-createdialog-title\">\r\n                <DialogTitle id=\"form-deletedialog-title\">Delete a document</DialogTitle>\r\n                <DialogContent>\r\n                  <DialogContentText>\r\n                    Delete document {this.state.documentToDelete} ?\r\n                  </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  <Button onClick={this.handleCloseDeleteDialog} color=\"primary\">\r\n                    Cancel\r\n                  </Button>\r\n                  {\r\n                    !this.state.loading && <Button onClick={this.handleDeleteDocument} color=\"primary\">\r\n                  Delete document\r\n                  </Button>\r\n                  }\r\n                  {this.state.loading && <CircularProgress />}\r\n                </DialogActions>\r\n              </Dialog>\r\n              {this.state.loading ? <CircularProgress size=\"1.5rem\" /> : \r\n                <DataGrid\r\n                  rows={docs}\r\n                  columns={columns}\r\n                  pageSize={10}\r\n                  checkboxSelection\r\n                  disableSelectionOnClick\r\n                />\r\n              }\r\n            </div>\r\n          </div>\r\n\r\n        </Container>\r\n      );\r\n    }else{\r\n      return (<div></div>);\r\n    }\r\n  }\r\n}\r\n\r\nexport default withRouter(Documents);","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass ContributorService {\r\n\r\n  \tcreate(data) {\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"contributors\", data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"contributors/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tgetDocumentContributors(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"documents/\" + id + \"/contributors\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new ContributorService();\r\n","import React, { Component } from \"react\";\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport ContributorService from \"../services/contributor.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\n\r\nclass Contributor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading:false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n      \r\n  }\r\n\r\n  handleDelete = () => {\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    ContributorService.delete(this.props.contributor.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.props.getContributors();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  }\r\n\r\n\r\n  render() {\r\n\r\n    return(\r\n        <Chip\r\n          avatar={<Avatar>{this.props.contributor.type.charAt(0).toUpperCase()}</Avatar>}\r\n          label={this.props.contributor.firstName + \" \" + this.props.contributor.lastName} \r\n          onDelete={this.handleDelete}\r\n          color=\"secondary\"\r\n        />\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Contributor);\r\n","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport ContributorService from \"../services/contributor.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\n\r\nclass ContributorCreateForm extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      loading:false,\r\n      firstname:\"\",\r\n      lastname:\"\",\r\n      typeOfContributor:\"annotator\"\r\n    };\r\n\r\n  }\r\n\r\n  onContributorFirstNameChange = (event) => {\r\n    this.setState({firstname:event.target.value});\r\n  }\r\n\r\n  onContributorLastNameChange = (event) => {\r\n    this.setState({lastname:event.target.value});\r\n  }\r\n\r\n  onContributorTypeChange = (event) => {\r\n    this.setState({typeOfContributor:event.target.value});\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleSubmit = () => {\r\n\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n    var data = {\r\n      firstName:this.state.firstname,\r\n      lastName:this.state.lastname,\r\n      type:this.state.typeOfContributor,\r\n      document_id:this.props.documentId\r\n    };\r\n\r\n    ContributorService.create(data).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false,\r\n            firstname:\"\",\r\n            lastname:\"\"\r\n          });\r\n          this.props.getContributors();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  };\r\n\r\n\r\n  render() {\r\n    var visibility = (this.props.hidden)?\"none\":\"\";\r\n\r\n    return (\r\n\r\n      <Container style={{display:visibility}}>\r\n      {this.state.loading && <CircularProgress />}\r\n        <TextField\r\n          label=\"First Name\"\r\n          placeholder=\"First Name\"\r\n          size=\"small\"\r\n          value={this.state.firstname}\r\n          onChange={this.onContributorFirstNameChange}\r\n        />\r\n        <TextField\r\n          label=\"Last Name\"\r\n          placeholder=\"Last Name\"\r\n          size=\"small\"\r\n          value={this.state.lastname}\r\n          onChange={this.onContributorLastNameChange}\r\n        />\r\n        <FormControl>\r\n          <InputLabel id=\"select-type-label\">Type of contributor</InputLabel>\r\n          <Select\r\n            labelId=\"select-type-label\"\r\n            id=\"type\"\r\n            value={this.state.typeOfContributor}\r\n            onChange={this.onContributorTypeChange}\r\n          >\r\n            <MenuItem value={\"speaker\"}>Speaker</MenuItem>\r\n            <MenuItem value={\"researcher\"}>Researcher</MenuItem>\r\n            <MenuItem value={\"annotator\"}>Annotator</MenuItem>\r\n          </Select>\r\n        </FormControl>\r\n        <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit} hidden={!(this.state.firstname.length >=1 && this.state.lastname.length >=1)}>\r\n            <SaveIcon />\r\n        </IconButton>\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(ContributorCreateForm);","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass TitleService {\r\n\r\n  \tcreate(data) {\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"titles\", data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"titles/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tgetDocumentTitles(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"documents/\" + id + \"/titles\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new TitleService();\r\n","import React, { Component } from \"react\";\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport TitleService from \"../services/title.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\n\r\nclass Title extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading:false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n      \r\n  }\r\n\r\n  handleDelete = () => {\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    TitleService.delete(this.props.title.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.props.getTitles();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  }\r\n\r\n\r\n  render() {\r\n\r\n    return(\r\n        <Chip\r\n          avatar={<Avatar>{this.props.title.lang.toUpperCase()}</Avatar>}\r\n          label={this.props.title.title} \r\n          onDelete={this.handleDelete}\r\n          color=\"secondary\"\r\n        />\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Title);","import React, { Component } from \"react\";\r\nimport Chip from '@material-ui/core/Chip';\r\n\r\nimport DocumentService from \"../services/document.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass AvailableLanguage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading:false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n  }\r\n\r\n  handleDelete = () => {\r\n\r\n    var list = this.props.list;\r\n\r\n    list.splice(list.indexOf(this.props.lang),1);\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    var data = {};\r\n    \r\n    this.props.type === \"lang\" ? data.available_lang = list : data.available_kindOf = list;\r\n\r\n    DocumentService.update(this.props.documentId,data).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false,\r\n            lang:\"\"\r\n          });\r\n          this.props.updateLanguages(this.props.type,list);\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  }\r\n\r\n\r\n  render() {\r\n\r\n    return(\r\n        <Chip\r\n          label={this.props.lang} \r\n          onDelete={this.handleDelete}\r\n          color=\"secondary\"\r\n        />\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(AvailableLanguage);\r\n","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport TitleService from \"../services/title.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass TitleCreateForm extends Component {\r\n\r\n  constructor(props){\r\n    console.log(props.available_lang);\r\n    super(props);\r\n    this.state = {\r\n      loading:false,\r\n      lang:(props.available_lang!==null && props.available_lang.length > 0) ? props.available_lang[0]:\"\",\r\n      title:\"\"\r\n    };\r\n\r\n  }\r\n\r\n  onChange = (e) => {\r\n    this.setState({\r\n      [e.target.id]:e.target.value\r\n    });\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleSubmit = () => {\r\n\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n    var data = {\r\n      lang:this.state.lang,\r\n      title:this.state.title,\r\n      document_id:this.props.documentId\r\n    };\r\n\r\n    TitleService.create(data).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false,\r\n            lang:\"\",\r\n            title:\"\"\r\n          });\r\n          this.props.getTitles();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  };\r\n\r\n\r\n  render() {\r\n    var visibility = (this.props.hidden)?\"none\":\"\";\r\n\r\n    return (\r\n\r\n      <Container style={{display:visibility}}>\r\n      {this.state.loading && <CircularProgress />}\r\n        <FormControl>\r\n          <InputLabel htmlFor=\"lang\">\r\n            Language\r\n          </InputLabel>\r\n          <Select\r\n            native\r\n            value={this.state.lang}\r\n            inputProps={{\r\n              id: 'lang',\r\n            }}\r\n            onChange={this.onChange}\r\n          >\r\n            {this.props.available_lang && this.props.available_lang.map((a) => (\r\n              <option value={a}>\r\n                {a}\r\n              </option>\r\n            ))}\r\n\r\n          </Select>\r\n        </FormControl>\r\n        \r\n        <TextField\r\n          id=\"title\"\r\n          label=\"Title\"\r\n          placeholder=\"Title\"\r\n          size=\"small\"\r\n          value={this.state.title}\r\n          onChange={this.onChange}\r\n        />\r\n        <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit} hidden={!(this.state.lang.length >=1 && this.state.title.length >=1)}>\r\n            <SaveIcon />\r\n        </IconButton>\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(TitleCreateForm);","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport DocumentService from \"../services/document.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\n\r\nclass AvailableLanguageCreateForm extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      loading:false,\r\n      lang:\"\"\r\n    };\r\n\r\n  }\r\n\r\n  onChange = (e) => {\r\n    this.setState({\r\n      lang:e.target.value\r\n    });\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleSubmit = () => {\r\n    var list = (this.props.list) === null ? [] : this.props.list;\r\n\r\n    list.indexOf(this.state.lang) >0 && list.splice(list.indexOf(this.state.lang),1);\r\n    list.push(this.state.lang);\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    var data = {};\r\n    \r\n    this.props.type === \"lang\" ? data.available_lang = list : data.available_kindOf = list;\r\n\r\n    DocumentService.update(this.props.documentId,data).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false,\r\n            lang:\"\"\r\n          });\r\n          this.props.updateLanguages(this.props.type,list);\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n    \r\n  };\r\n\r\n\r\n  render() {\r\n\r\n    var visibility = (this.props.hidden)?\"none\":\"\";\r\n\r\n    return (\r\n\r\n      <Container style={{display:visibility}}>\r\n      {this.state.loading && <CircularProgress />}\r\n\r\n        <TextField\r\n          id=\"lang\"\r\n          label=\"ISO 6391 Code\"\r\n          placeholder=\"ISO 6391 Code\"\r\n          size=\"medium\"\r\n          value={this.state.lang}\r\n          onChange={this.onChange}\r\n          inputProps={(this.props.type === \"lang\")?{maxLength:2}:{}}\r\n        />\r\n      \r\n        \r\n        <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit} hidden={!this.state.lang.length >=1}>\r\n            <SaveIcon />\r\n        </IconButton>\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(AvailableLanguageCreateForm);","import React, { Component } from \"react\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport {Typography} from '@material-ui/core';\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport RemoveIcon from '@material-ui/icons/RemoveCircle';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Contributor from './document.description.contributor.component';\r\nimport ContributorCreateForm from './document.description.contributor.createform.component';\r\nimport Title from './document.description.title.component';\r\nimport AvailableLanguage from './document.description.availablelang.component';\r\nimport TitleCreateForm from './document.description.title.createform.component';\r\nimport AvailableLanguageCreateForm from './document.description.availablelang.createform.component';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport DocumentService from \"../services/document.service\";\r\nimport ContributorService from \"../services/contributor.service\";\r\nimport TitleService from \"../services/title.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass DocumentDescription extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading:false,\r\n      currentUser: AuthService.getCurrentUser(),\r\n      titles:props.document.titles,\r\n      contributors:props.document.contributors,\r\n      affiliation:props.document.affiliation,\r\n      recording_date:props.document.recording_date,\r\n      recording_place:props.document.recording_place,\r\n      lang:props.document.lang,\r\n      available_lang:props.document.available_lang,\r\n      available_kindOf:props.document.available_kindOf,\r\n      document:props.document\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n      \r\n  }\r\n\r\n  getContributors = () => {\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    ContributorService.getDocumentContributors(this.props.document.id).then(\r\n      (response) => {\r\n        \r\n          this.setState({\r\n            loading:false,\r\n            contributors:response.data,\r\n            openNewContributor:false\r\n          });\r\n\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  getTitles = () => {\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    TitleService.getDocumentTitles(this.props.document.id).then(\r\n      (response) => {\r\n        \r\n          this.setState({\r\n            loading:false,\r\n            titles:response.data,\r\n            openNewTitle:false\r\n          });\r\n\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  updateLanguages = (type,list) => {\r\n    type === \"lang\" ? this.setState({available_lang: list}) : this.setState({available_kindOf: list});\r\n  }\r\n\r\n  handleDeleteTitle = (e) => {\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    TitleService.delete(e.target.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.getTitles();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  onBlur = (e) => {\r\n\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    DocumentService.update(this.props.document.id,{[e.target.id]:e.target.value}).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  onChange = (e) => {\r\n    this.setState({\r\n      [e.target.id]:e.target.value\r\n    });\r\n  }\r\n\r\n  openNewContributorForm = () => {\r\n    this.setState({openNewContributor:!this.state.openNewContributor});\r\n  }\r\n\r\n  openNewTitleForm = () => {\r\n    this.setState({openNewTitle:!this.state.openNewTitle});\r\n  }\r\n\r\n  openNewAvailableLanguageForm = () => {\r\n    this.setState({openNewAvailableLanguage:!this.state.openNewAvailableLanguage});\r\n  }\r\n\r\n  openNewAvailableKindOfForm = () => {\r\n    this.setState({openNewAvailableKindOf:!this.state.openNewAvailableKindOf});\r\n  }\r\n\r\n\r\n  render() {\r\n    var titles = [];\r\n    var contributors = [];\r\n    var available_lang = [];\r\n    var available_kindOf = [];\r\n\r\n\r\n    if(this.state.titles){\r\n      this.state.titles.forEach((t)=>{\r\n        titles.push(<Title key={t.id} getTitles={this.getTitles} title={t} />);\r\n      });\r\n    }\r\n\r\n    if(this.state.contributors){\r\n      this.state.contributors.forEach((c)=>{\r\n        contributors.push(<Contributor key={c.id} getContributors={this.getContributors} contributor={c} />);\r\n      });\r\n    }\r\n\r\n    if(this.state.available_lang){\r\n      this.state.available_lang.forEach((l)=>{\r\n        available_lang.push(\r\n          <AvailableLanguage \r\n            key={l}\r\n            type=\"lang\"\r\n            updateLanguages={this.updateLanguages}\r\n            lang={l}\r\n            list={this.state.available_lang}\r\n            documentId={this.props.document.id}\r\n          />\r\n        );\r\n      });\r\n    }\r\n\r\n    if(this.state.available_kindOf){\r\n      this.state.available_kindOf.forEach((l)=>{\r\n        available_kindOf.push(\r\n          <AvailableLanguage\r\n            key={l}\r\n            type=\"kindOf\"\r\n            updateLanguages={this.updateLanguages}\r\n            lang={l}\r\n            list={this.state.available_kindOf}\r\n            documentId={this.props.document.id}\r\n          />\r\n        );\r\n      });\r\n    }\r\n      \r\n\r\n    return(\r\n\r\n      <div>\r\n        {this.state.loading && <CircularProgress />}\r\n       <div>\r\n        \r\n         <div>\r\n            <TextField\r\n                id=\"lang\"\r\n                label=\"Corpus\"\r\n                placeholder=\"Title, ISO 639-2 language code\"\r\n                helperText=\"use format 'Title, ISO 639-2 language code'\"\r\n                value={this.state.lang}\r\n                onChange={this.onChange}\r\n                onBlur={this.onBlur}\r\n              />\r\n          </div>\r\n          <div>\r\n            <Typography component=\"h3\">Recording</Typography>\r\n            <TextField \r\n                id=\"recording_date\" \r\n                label=\"Date\" \r\n                type=\"date\" \r\n                InputLabelProps={{ shrink: true}}\r\n                value={this.state.recording_date && this.state.recording_date.split(' ')[0]} \r\n                onChange={this.onChange}\r\n                onBlur={this.onBlur}\r\n                />\r\n            \r\n            <TextField \r\n                id=\"recording_place\" \r\n                label=\"Place\" \r\n                placeholder=\"Place of recording\"\r\n                type=\"text\"\r\n                value={this.state.recording_place}\r\n                onChange={this.onChange}\r\n                onBlur={this.onBlur}\r\n                />\r\n          </div>\r\n\r\n          <div id=\"available_kindOf\">\r\n              <Typography component=\"h3\">Available kind of transcription</Typography>\r\n              {available_kindOf} \r\n              <Chip\r\n                icon={this.state.openNewAvailableKindOf ? <RemoveIcon /> : <AddIcon /> }\r\n                label=\"kindOf\"\r\n                clickable\r\n                size=\"small\"\r\n                color=\"primary\"\r\n                onClick={this.openNewAvailableKindOfForm}\r\n              />\r\n              <AvailableLanguageCreateForm \r\n                type=\"kindOf\"\r\n                list={this.state.available_kindOf}\r\n                getLanguages={this.getKindOf} \r\n                documentId={this.state.document.id} \r\n                hidden={!this.state.openNewAvailableKindOf}\r\n                updateLanguages={this.updateLanguages}\r\n              />\r\n          </div>\r\n\r\n          <div id=\"available_lang\">\r\n              <Typography component=\"h3\">Available translation languages</Typography>\r\n              {available_lang} \r\n              <Chip\r\n                icon={this.state.openNewAvailableLanguage ? <RemoveIcon /> : <AddIcon /> }\r\n                label=\"language\"\r\n                clickable\r\n                size=\"small\"\r\n                color=\"primary\"\r\n                onClick={this.openNewAvailableLanguageForm}\r\n              />\r\n              <AvailableLanguageCreateForm \r\n                type=\"lang\"\r\n                list={this.state.available_lang}\r\n                getLanguages={this.getLanguages} \r\n                documentId={this.state.document.id} \r\n                hidden={!this.state.openNewAvailableLanguage}\r\n                updateLanguages={this.updateLanguages}\r\n              />\r\n          </div>\r\n\r\n          <div id=\"titles\">\r\n              <Typography component=\"h3\">Titles</Typography>\r\n              {titles} \r\n\r\n              <Chip\r\n                icon={this.state.openNewTitle ? <RemoveIcon /> : <AddIcon /> }\r\n                label=\"title\"\r\n                clickable\r\n                size=\"small\"\r\n                color=\"primary\"\r\n                onClick={this.openNewTitleForm}\r\n              />\r\n              <TitleCreateForm \r\n                getTitles={this.getTitles}\r\n                documentId={this.state.document.id}\r\n                hidden={!this.state.openNewTitle}\r\n                available_lang={this.state.available_lang}\r\n              />\r\n          </div>\r\n\r\n          <div id=\"contributors\">\r\n              <Typography component=\"h3\">Contributors</Typography>\r\n              {contributors} \r\n\r\n              <Chip\r\n                icon={this.state.openNewContributor ? <RemoveIcon /> : <AddIcon /> }\r\n                label=\"contributor\"\r\n                clickable\r\n                size=\"small\"\r\n                color=\"primary\"\r\n                onClick={this.openNewContributorForm}\r\n              />\r\n              <ContributorCreateForm getContributors={this.getContributors} documentId={this.state.document.id} hidden={!this.state.openNewContributor} />\r\n          </div>\r\n          \r\n          <div>\r\n              <TextField \r\n                id=\"depositorAffiliation\" \r\n                label=\"Depositor's affiliation\" \r\n                placeholder=\"Depositor's affiliation\"\r\n                type=\"text\"\r\n                onChange={this.onChange}\r\n                />\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(DocumentDescription);","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass RecordingService {\r\n\r\n\r\n  \tcreate(resourceFile, type, name, document_id) {\r\n\r\n\t\tlet formData = new FormData();\r\n\t    formData.append(\"resourceFile\", resourceFile);\r\n\t    formData.append(\"type\", type);\r\n\t    formData.append(\"filename\", name);\r\n\t    formData.append(\"name\", name);\r\n\t    formData.append(\"document_id\", document_id);\r\n\r\n\t    authHeader['Content-Type'] = 'multipart/form-data';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"recordings\",formData,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"recordings/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new RecordingService();\r\n","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass ImageService {\r\n\r\n\r\n  \tcreate(resourceFile, rank, filename, name, document_id) {\r\n\r\n\t\tlet formData = new FormData();\r\n\t    formData.append(\"resourceFile\", resourceFile);\r\n\t    formData.append(\"rank\", rank);\r\n\t    formData.append(\"filename\", filename);\r\n\t    formData.append(\"name\", name);\r\n\t    formData.append(\"document_id\", document_id);\r\n\r\n\r\n\t    authHeader['Content-Type'] = 'multipart/form-data';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"images\",formData,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"images/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new ImageService();\r\n","import React, { Component } from \"react\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport RecordingService from \"../services/recording.service\";\r\nimport ImageService from \"../services/image.service\";\r\n\r\nimport {Container, Button, IconButton} from '@material-ui/core';\r\nimport { DataGrid } from '@material-ui/data-grid';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport {FormControl,Input, FormHelperText, TextField} from '@material-ui/core';\r\n\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass DocumentResources extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      currentUser: AuthService.getCurrentUser(),\r\n      resources: [],\r\n      openAddDialog:false,\r\n      maxImageRank:0,\r\n      nameInDocument:null,\r\n      openDeleteDialog:false,\r\n      selectedResourceId:null,\r\n      images:this.props.images,\r\n      recording:this.props.recording\r\n    };\r\n\r\n  }\r\n\r\n  handleOpenAddDialog = () => {\r\n    this.setState({openAddDialog:true});\r\n  };\r\n\r\n  handleCloseAddDialog = () => {\r\n    this.setState({openAddDialog:false});\r\n  };\r\n\r\n  handleCloseDeleteDialog = (event) => {\r\n    this.setState({\r\n        openDeleteDialog: false\r\n      });\r\n  };\r\n\r\n  handleOpenDeleteDialog = (resourceId) => {\r\n    this.setState({\r\n        openDeleteDialog: true,\r\n        selectedResourceId : resourceId\r\n      });\r\n    alert(resourceId);\r\n  };\r\n\r\n  onNameChange = (event) => {\r\n    this.setState({nameInDocument:event.target.value});\r\n  }\r\n\r\n  handleUpload = () => {\r\n    this.setState({\r\n      loading: true\r\n    });\r\n\r\n    var type = 'AUDIO';\r\n\r\n    if(document.getElementById('resourceFile').files[0].type === 'video/mp4') type='VIDEO';\r\n    if(document.getElementById('resourceFile').files[0].type === 'audio/mpeg' || document.getElementById('resourceFile').files[0].type === 'audio/wav') type='AUDIO';\r\n    if(document.getElementById('resourceFile').files[0].type === 'image/jpeg' || document.getElementById('resourceFile').files[0].type === 'image/png') type='IMAGE';\r\n\r\n    \r\n    (type === 'AUDIO' || type === 'VIDEO') && !this.state.hasRecording && RecordingService.create(document.getElementById('resourceFile').files[0], type, this.state.nameInDocument || document.getElementById('resourceFile').files[0].name, this.props.documentId).then(\r\n        (response) => {\r\n\r\n            this.setState({\r\n              recording:response.data,\r\n              loading: false,\r\n              openAddDialog:false\r\n            });\r\n\r\n            window.location.reload();\r\n          },\r\n          error => {\r\n            if(error.response.status===401) this.props.history.push('/login');\r\n            console.log(error.response);\r\n            const resMessage =\r\n              (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n\r\n            this.setState({\r\n              loading: false,\r\n              errorMessage: resMessage,\r\n              openAddDialog:false\r\n            });\r\n      });\r\n\r\n      type === 'IMAGE' && ImageService.create(document.getElementById('resourceFile').files[0], this.state.maxImageRank+1, document.getElementById('resourceFile').files[0].name,this.state.nameInDocument || document.getElementById('resourceFile').files[0].name, this.props.documentId).then(\r\n        (response) => {\r\n\r\n            var images = this.state.images;\r\n            images.push(response.data);\r\n\r\n            this.setState({\r\n              images:images,\r\n              loading: false,\r\n              openAddDialog:false\r\n            });\r\n\r\n            window.location.reload();\r\n\r\n          },\r\n          error => {\r\n            if(error.response.status===401) this.props.history.push('/login');\r\n            const resMessage =\r\n              (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n\r\n            this.setState({\r\n              loading: false,\r\n              errorMessage: resMessage,\r\n              openAddDialog:false\r\n            });\r\n      });\r\n\r\n\r\n      (type === 'AUDIO' || type === 'VIDEO') && this.state.hasRecording && alert(\"You can attach only one recording to the document\");\r\n  };\r\n\r\n\r\n  handleCloseSnackBar = (event) => {\r\n    this.setState({errorMessage:null});\r\n  }\r\n\r\n  handleDeleteResource = () => {\r\n    this.setState({\r\n      loading: true\r\n    });\r\n\r\n    var type = this.state.selectedResourceType;\r\n    \r\n    (type === 'AUDIO' || type === 'VIDEO') && RecordingService.delete(this.state.selectedResourceId).then(\r\n        (response) => {\r\n            window.location.reload();\r\n          },\r\n          error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n            const resMessage =\r\n              (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n\r\n            this.setState({\r\n              loading: false,\r\n              errorMessage: resMessage\r\n            });\r\n      });\r\n\r\n      type === 'IMAGE' && ImageService.delete(this.state.selectedResourceId).then(\r\n        (response) => {\r\n            window.location.reload();\r\n            //this.refreshResources();\r\n          },\r\n          error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n            const resMessage =\r\n              (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n\r\n            this.setState({\r\n              loading: false,\r\n              errorMessage: resMessage\r\n            });\r\n      });\r\n\r\n\r\n      this.setState({openDeleteDialog:false});\r\n  \r\n  }\r\n\r\n  refreshResources = () => {\r\n    var resources = [];\r\n\r\n    if(this.state.images){\r\n      var maxImageRank = 0;\r\n      this.state.images.forEach((i) => {\r\n        maxImageRank = (maxImageRank<i.rank)?i.rank:maxImageRank;\r\n\r\n         resources.push({\r\n          id:\"IMAGE\"+i.id,\r\n          filename:i.filename,\r\n          name:i.name,\r\n          type:\"IMAGE\",\r\n          rank:i.rank,\r\n          preview:{type:\"IMAGE\",content:i[\"TO_BASE64(content)\"]},\r\n          actions:i.id\r\n        });\r\n         this.setState({\r\n          maxImageRank:maxImageRank,\r\n          resources:resources\r\n        });\r\n      });\r\n      \r\n    }\r\n\r\n    if(this.state.recording){\r\n      resources.push({\r\n        id:this.state.recording.type+this.state.recording.id,\r\n        filename:this.state.recording.filename,\r\n        name:this.state.recording.name,\r\n        type:this.state.recording.type,\r\n        rank:1,\r\n        preview:{type:this.state.recording.type,content:this.state.recording[\"TO_BASE64(content)\"]},\r\n        actions:this.state.recording.id\r\n      });\r\n      this.setState({\r\n        hasRecording:true,\r\n        resources:resources\r\n      });\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    this.refreshResources();\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    const columns: GridColDef[] = [\r\n        { field: 'id', headerName: 'ID', width: 50 },\r\n        {\r\n          field: 'filename',\r\n          headerName: 'Original file name',\r\n          width: 200,\r\n          editable: true,\r\n        },\r\n        {\r\n          field: 'name',\r\n          headerName: 'Name in document',\r\n          width: 200,\r\n          editable: true,\r\n        },\r\n        {\r\n          field: 'type',\r\n          headerName: 'Type',\r\n          width: 110,\r\n          editable: true,\r\n        },\r\n        {\r\n          field: 'rank',\r\n          headerName: 'Rank',\r\n          width: 110,\r\n          editable: true,\r\n        },\r\n        {\r\n          field: 'preview',\r\n          headerName: 'Preview',\r\n          width: 150,\r\n          editable: true,\r\n          renderCell: (params) => (\r\n            (params.value.type === \"IMAGE\") ?\r\n            <img alt={params.value.filename} src={\"data:image/png;base64,\"+params.value.content} width=\"100px\" height=\"100px\"/>\r\n            :\r\n            <audio controls=\"controls\" src={\"data:audio/mpeg;base64,\"+params.value.content} type=\"audio/mp3\"></audio>\r\n          )\r\n        },\r\n        {\r\n          field: 'actions',\r\n          headerName: 'Actions',\r\n          width: 200,\r\n          editable: false,\r\n          renderCell: (params) => {\r\n            const onClick = () => {\r\n              console.log(params.row.type);\r\n              this.setState({\r\n                openDeleteDialog: true,\r\n                selectedResourceId: params.value,\r\n                selectedResourceType : params.row.type\r\n              });\r\n            };\r\n\r\n            return(\r\n            <div>\r\n              <IconButton color=\"primary\" aria-label=\"Delete resource\" onClick={onClick} >\r\n                <DeleteIcon />\r\n              </IconButton>\r\n            </div>\r\n            );\r\n            }\r\n        }\r\n      ];\r\n      \r\n    return(\r\n    <Container>\r\n          <header className=\"jumbotron\">\r\n            <h3>\r\n             Resources\r\n            </h3>\r\n          </header>\r\n          <div>\r\n            <div style={{ height: 300, width: '80%' }}>\r\n              <IconButton color=\"primary\" aria-label=\"Add document\" onClick={this.handleOpenAddDialog}>\r\n                  <AddIcon />\r\n              </IconButton>\r\n              <DataGrid\r\n                rows={this.state.resources}\r\n                columns={columns}\r\n                pageSize={10}\r\n                checkboxSelection\r\n                disableSelectionOnClick\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <Dialog open={this.state.openAddDialog} onClose={this.handleCloseAddDialog} aria-labelledby=\"form-dialog-title\">\r\n              <DialogTitle id=\"form-dialog-title\">Add a resource</DialogTitle>\r\n              <DialogContent>\r\n                <DialogContentText>\r\n                  1 audio or 1 video maximum, if multiple images, please define a rank for each one.\r\n                </DialogContentText>\r\n                <FormControl>\r\n                  <Input\r\n                    id=\"resourceFile\"\r\n                    type=\"file\"\r\n                    aria-describedby=\"standard-weight-helper-text\"\r\n                    inputProps={{\r\n                      accept: 'image/png, image/jpeg, audio/wav, audio/mpeg, video/mp4',\r\n                    }}\r\n                  />\r\n                  <FormHelperText id=\"standard-weight-helper-text\">Accepted formats : JPG, PNG, WAV, MP3, MP4</FormHelperText>\r\n                </FormControl>\r\n                <FormControl>\r\n                  <TextField\r\n                    label=\"Name in document\"\r\n                    placeholder=\"Name in document\"\r\n                    fullWidth\r\n                    value={this.state.nameInDocument}\r\n                    onChange={this.onNameChange}\r\n                  />\r\n                </FormControl>\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={this.handleCloseAddDialog} color=\"primary\">\r\n                  Cancel\r\n                </Button>\r\n                {this.state.loading ?\r\n                   <CircularProgress />\r\n                   :\r\n                  <Button onClick={this.handleUpload} color=\"primary\">\r\n                    Upload\r\n                  </Button>\r\n                }\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog open={this.state.openDeleteDialog} onClose={this.handleCloseDeleteDialog} aria-labelledby=\"form-deletedialog-title\">\r\n            <DialogTitle id=\"form-deletedialog-title\">Delete resource</DialogTitle>\r\n            <DialogContent>\r\n              <DialogContentText>\r\n                Delete resource {this.state.selectedResourceId} ?\r\n              </DialogContentText>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={this.handleCloseDeleteDialog} color=\"primary\">\r\n                Cancel\r\n              </Button>\r\n              {!this.state.loading && <Button onClick={this.handleDeleteResource} color=\"primary\">\r\n                Delete resource\r\n              </Button>\r\n              }\r\n              {this.state.loading && <CircularProgress />}\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n          <Snackbar\r\n            anchorOrigin={{\r\n              vertical: 'bottom',\r\n              horizontal: 'left',\r\n            }}\r\n            open={this.state.errorMessage}\r\n            autoHideDuration={null}\r\n            message={this.state.errorMessage}\r\n            action={\r\n              <React.Fragment>\r\n                <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={this.handleCloseSnackBar}>\r\n                  <CloseIcon fontSize=\"small\" />\r\n                </IconButton>\r\n              </React.Fragment>\r\n            }\r\n          />\r\n          </div>\r\n        </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(DocumentResources);","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport MultiCrops from 'react-multi-crops'\r\n\r\nexport default class ImageMultiSelector extends React.Component {\r\n  \r\n  constructor(props){\r\n    super(props);\r\n    this.divCanvas = React.createRef();\r\n\r\n    /////////////////////////////////\r\n    //var pCoords = [];\r\n    var imageCanvas = [];\r\n      var badgeStyleCommon = {\r\n        position: \"absolute\",\r\n        top:\"0px\",\r\n        width: \"12px\",\r\n        height: \"12px\",\r\n        //boxShadow: \"0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12)\",\r\n        borderRadius: \"50%\",\r\n        color: \"white\",\r\n        fontSize: \"0.6rem\",\r\n        fontWeight: \"bold\",\r\n        textAlign: \"center\"\r\n      };\r\n\r\n    this.props.canvas && this.props.canvas.forEach((c) => {\r\n\r\n      var badgeStyleForm = {\r\n        position: badgeStyleCommon.position,\r\n        top:badgeStyleCommon.top,\r\n        width: badgeStyleCommon.width,\r\n        height: badgeStyleCommon.height,\r\n        //boxShadow: badgeStyleCommon.boxShadow,\r\n        borderRadius: badgeStyleCommon.borderRadius,\r\n        color: badgeStyleCommon.color,\r\n        fontSize: badgeStyleCommon.fontSize,\r\n        fontWeight: badgeStyleCommon.fontWeight,\r\n        textAlign: badgeStyleCommon.textAlign\r\n      };\r\n\r\n      var badgeStyleTranslation = {\r\n        position: badgeStyleCommon.position,\r\n        top:badgeStyleCommon.top,\r\n        width: badgeStyleCommon.width,\r\n        height: badgeStyleCommon.height,\r\n        //boxShadow: badgeStyleCommon.boxShadow,\r\n        borderRadius: badgeStyleCommon.borderRadius,\r\n        color: badgeStyleCommon.color,\r\n        fontSize: badgeStyleCommon.fontSize,\r\n        fontWeight: badgeStyleCommon.fontWeight,\r\n        textAlign: badgeStyleCommon.textAlign\r\n      };\r\n\r\n      badgeStyleForm.right = \"10px\";\r\n      badgeStyleTranslation.right = \"0px\";\r\n\r\n      badgeStyleForm.backgroundColor = (c.hasForm > 0) ? \"green\":\"red\";\r\n      badgeStyleTranslation.backgroundColor = (c.hasTranslation > 0) ? \"green\":\"red\";\r\n\r\n      var coords = c.areaCoords.split(',');\r\n\r\n      var styleImageCanvas = {\r\n        display:props.showImageCanvas?\"block\":\"none\",\r\n        position: \"absolute\",\r\n        top: coords[1]/coords[4]+\"px\", // #21\r\n        left:coords[0]/coords[4]+\"px\", // #21\r\n        border: \"solid\",\r\n        borderColor:(c.type==='S')?\"blue\":\"blue\",\r\n        borderStyle: (c.type==='S')?\"solid\":\"dotted\",\r\n        cursor:\"pointer\"\r\n      };\r\n      var canvas = (\r\n        <div style={styleImageCanvas}>\r\n            <canvas \r\n              className=\"imageCanvas\"\r\n              title={c.type+c.rank} \r\n              style={{position: \"relative\"}} \r\n              width={(coords[2]-coords[0])/coords[4]} // #21\r\n              height={(coords[3]-coords[1])/coords[4]} // #21\r\n              onClick={()=>{props.showAnnotation(c.id)}}\r\n            />\r\n            <span style={badgeStyleForm}>F</span>\r\n            <span style={badgeStyleTranslation}>T</span>\r\n        </div>);\r\n\r\n      imageCanvas.push(canvas);\r\n  });\r\n\r\n    this.state = {\r\n      coordinates: this.props.coordinates,\r\n      canvas: imageCanvas,\r\n      imageSelectorWidth:1000\r\n    }\r\n\r\n    // #21\r\n    var image = new Image();\r\n    image.src = \"data:image/png;base64,\"+this.props.image[\"TO_BASE64(content)\"];\r\n    const scaleX = image.naturalWidth / this.state.imageSelectorWidth;\r\n    window.imageRatio = scaleX;\r\n\r\n  }\r\n \r\n  changeCoordinate = (coordinate, index, coordinates) => {\r\n    this.setState({\r\n      coordinates,\r\n    });\r\n\r\n    var imageSelectionData=[];\r\n\r\n\r\n    coordinates.forEach((c)=>{\r\n      imageSelectionData.push({\r\n        imageId:this.props.image.id,\r\n        x:parseFloat(c.x.toFixed(2)),\r\n        y:parseFloat(c.y.toFixed(2)),\r\n        width:parseFloat(c.width.toFixed(2)),\r\n        height:parseFloat(c.height.toFixed(2)),\r\n      });\r\n    });\r\n\r\n    window.coordinates=coordinates;\r\n    window.imageSelectionData = imageSelectionData;\r\n\r\n    if(window.currentAnnotationEdition){\r\n      window.currentAnnotationEdition.data = imageSelectionData;\r\n    }\r\n\r\n\r\n  }\r\n  deleteCoordinate = (coordinate, index, coordinates) => {\r\n    this.setState({\r\n      coordinates,\r\n    });\r\n    window.coordinates=coordinates;\r\n  }\r\n\r\n  componentDidMount(){\r\n    console.log(this.divCanvas);\r\n    var divImageSelector = this.divCanvas.previousSibling;\r\n    divImageSelector.append(this.divCanvas);\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div id={\"ImageSelector_\"+this.props.image.id} className=\"ImageSelector\">\r\n\r\n        <MultiCrops\r\n          src={\"data:image/png;base64,\"+this.props.image[\"TO_BASE64(content)\"]}\r\n          width={this.state.imageSelectorWidth}\r\n          coordinates={this.state.coordinates}\r\n          onChange={this.changeCoordinate}\r\n          onDelete={this.deleteCoordinate}\r\n          //canvas={this.state.canvas}\r\n        />\r\n        <div ref={ref => this.divCanvas = ref}>{this.state.canvas}</div>\r\n        \r\n\r\n      </div>\r\n\r\n    );\r\n  }\r\n}\r\n\r\n","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PlayIcon from '@material-ui/icons/PlayCircleFilledWhite';\r\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport MouseIcon from '@material-ui/icons/Mouse';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport Chip from '@material-ui/core/Chip';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport AnnotationService from \"../services/annotation.service\";\r\n\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass Audio extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      playing: false,\r\n      inputEnabled:false,\r\n      originalStart:props.audioStart,\r\n      originalEnd:props.audioEnd,\r\n      start:props.audioStart,\r\n      end:props.audioEnd\r\n    };\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n  }\r\n\r\n  handleEdit = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled});\r\n    window.currentAnnotationEdition = {id:this.props.annotationId,label:this.props.annotationLabel};\r\n    //window.wavesurfer.disableDragSelection();\r\n    window.wavesurfer.regions.list[this.props.annotationId] && window.wavesurfer.regions.list[this.props.annotationId].remove();\r\n           window.wavesurfer.addRegion({\r\n            id:this.props.annotationId,\r\n            start: this.state.start,\r\n            end: this.state.end,\r\n            drag: true,\r\n            resize: true,\r\n            color:\"rgba(0,0,0,0.2)\",\r\n\r\n          });\r\n\r\n  };\r\n\r\n  handleMouseSelection = () => {\r\n    this.props.handleEditionState(true,\"audio\",{annotationLabel:this.props.annotationLabel,annotationId:this.props.annotationId,start:this.state.start,end:this.state.end});\r\n    //this.props.handleExpand('panel1');\r\n  };\r\n\r\n  handleCancel = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled,start:this.state.originalStart,end:this.state.originalEnd});\r\n    window.currentAnnotationEdition = null;\r\n  };\r\n\r\n  handlePlay = () => {\r\n    this.setState({ playing: !this.state.playing });\r\n    window.wavesurfer.isPlaying()?window.wavesurfer.pause():window.wavesurfer.play(this.state.start,this.state.end);\r\n    window.wavesurfer.on('pause',()=>{this.setState({ playing: false });})\r\n  };\r\n\r\n  onStartChange = (event) => {\r\n    this.setState({start:event.target.value});\r\n  }\r\n\r\n  onEndChange = (event) => {\r\n    this.setState({end:event.target.value});\r\n  }\r\n\r\n\r\n  handleSubmit = () => {\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false,\r\n      originalStart:this.state.start,\r\n      originalEnd:this.state.end,\r\n    });\r\n\r\n    AnnotationService.update(this.props.annotationId,{audioStart:this.state.start,audioEnd:this.state.end}).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          //this.props.annotationHasChanged();\r\n          window.currentAnnotationEdition=null;\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  render() {\r\n\r\n       window.wavesurfer.regions.list[this.props.annotationId] && window.wavesurfer.regions.list[this.props.annotationId].remove();\r\n           window.wavesurfer.addRegion({\r\n            id:this.props.annotationId,\r\n            start: this.state.start,\r\n            end: this.state.end,\r\n            drag: false,\r\n            resize: false,\r\n            color:\"rgba(0,0,0,0.2)\",\r\n          });\r\n\r\n      window.wavesurfer.markers.markers\r\n      .filter((m)=>m.label ===this.props.annotationLabel)\r\n      .forEach((marker,index)=>{window.wavesurfer.markers.remove(index);});\r\n\r\n      //window.wavesurfer.markers.remove\r\n      this.props.annotationLabel &&\r\n        window.wavesurfer.addMarker({\r\n          time: this.state.start,\r\n          label: this.props.annotationLabel,\r\n          color: (this.props.annotationLabel.substring(0,1)===\"S\")?\"red\":\"blue\",\r\n          position: (this.props.annotationLabel.substring(0,1)===\"S\")?\"bottom\":\"top\"\r\n        });\r\n    \r\n\r\n    return (\r\n      <Container>\r\n        {this.state.loading && <CircularProgress size=\"1.5rem\" />}\r\n        <Chip label=\"audio\" size=\"small\" />\r\n          <IconButton color=\"primary\" aria-label=\"Play\" onClick={this.handlePlay}>\r\n            {!this.state.playing ? <PlayIcon /> : <PauseIcon /> }\r\n          </IconButton>\r\n          <TextField\r\n            id={\"start\"+this.props.id}\r\n            label=\"Start\"\r\n            disabled={!this.state.inputEnabled}\r\n            value={this.state.start}\r\n            onChange={this.onStartChange}\r\n            size=\"small\"\r\n            style = {{width: \"5rem\"}}\r\n          />\r\n          \r\n          <TextField\r\n            id={\"end\"+this.props.id}\r\n            label=\"End\"\r\n            disabled={!this.state.inputEnabled}\r\n            value={this.state.end}\r\n            onChange={this.onEndChange}\r\n            size=\"small\"\r\n            style = {{width: \"5rem\"}}\r\n          />\r\n            {!this.state.inputEnabled?\r\n            <IconButton title=\"Edit\" color=\"primary\" aria-label=\"Edit\" onClick={this.handleEdit}>\r\n                <EditIcon />\r\n            </IconButton>\r\n            :\r\n            <span>\r\n              <IconButton title=\"Select on waveform\" color=\"primary\" aria-label=\"Save\" onClick={this.handleMouseSelection}>\r\n                  <MouseIcon />\r\n              </IconButton>\r\n              <IconButton title=\"Save\" color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit}>\r\n                  <SaveIcon />\r\n              </IconButton>\r\n              <IconButton title=\"Cancel\" color=\"primary\" aria-label=\"Cancel\" onClick={this.handleCancel}>\r\n                  <CancelIcon />\r\n              </IconButton>\r\n            </span>\r\n            }\r\n          <IconButton title=\"Delete\" color=\"primary\" aria-label=\"Delete\">\r\n              <DeleteIcon />\r\n          </IconButton>\r\n\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(Audio);","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport AddIcon from '@material-ui/icons/Add';\r\n\r\nexport default class Image extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      inputEnabled:false,\r\n      imageCoords:this.props.imageCoords,\r\n      originalImageCoords:this.props.imageCoords\r\n    };\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleEdit = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled});\r\n    window.currentAnnotationEdition = {};\r\n    window.currentAnnotationEdition.annotationId = this.props.annotationId;\r\n    window.currentAnnotationEdition.annotationLabel = this.props.annotationLabel;\r\n    window.currentAnnotationEdition.imageAddition = false;\r\n    window.currentAnnotationEdition.imageCoords = this.props.imageCoords;\r\n    this.props.handleEditionState(true,\"image\",{annotationLabel:this.props.annotationLabel,annotationId:this.props.annotationId,imageCoords:this.state.imageCoords});\r\n  };\r\n\r\n  handleEditImageAddition = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled});\r\n    window.currentAnnotationEdition = {};\r\n    window.currentAnnotationEdition.annotationId = this.props.annotationId;\r\n    window.currentAnnotationEdition.annotationLabel = this.props.annotationLabel;\r\n    window.currentAnnotationEdition.imageAddition = true;\r\n    window.currentAnnotationEdition.imageCoords = this.props.imageCoords;\r\n    this.props.handleEditionState(true,\"image\",{annotationLabel:this.props.annotationLabel,annotationId:this.props.annotationId,imageCoords:this.state.imageCoords});\r\n  };\r\n\r\n  handleCancel = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled,imageCoords:this.state.originalImageCoords});\r\n    window.currentAnnotationEditionId = null;\r\n  };\r\n\r\n  handleSubmit = () => {\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n  }\r\n\r\n  render() {\r\n\r\n    \r\n    var imageElements = [];\r\n\r\n    this.props.imageCoords && this.props.imageCoords.forEach((i)=>{\r\n\r\n      var splitCoords = i.areaCoords.split(\",\");\r\n      var x1 = 0;\r\n      var y1 = 0;\r\n      var x2 = 0;\r\n      var y2 = 0;\r\n\r\n      x1 = splitCoords[0];\r\n      y1 = splitCoords[1];\r\n      x2 = splitCoords[2];\r\n      y2 = splitCoords[3];\r\n\r\n      var width = x2 - x1;\r\n      var height = y2 - y1;\r\n\r\n      imageElements.push(\r\n          <div style={{overflow:\"hidden\",width:width,height:height}}>\r\n            <img alt={\"image\"+i.image_id} style={{margin:\"-\"+y1+\"px 0px 0px -\"+x1+\"px\"}} src={\"data:image/png;base64,\"+localStorage.getItem(\"image\"+i.image_id)} />\r\n          </div>\r\n        );\r\n\r\n      });\r\n    \r\n\r\n    return (\r\n       \r\n      <Container>\r\n        {this.state.loading && <CircularProgress size=\"1.5rem\" />}\r\n        <Chip label=\"image\" size=\"small\" />\r\n            {!this.state.inputEnabled?\r\n                <IconButton color=\"primary\" aria-label=\"Edit\" onClick={this.handleEdit}>\r\n                    <EditIcon />\r\n                </IconButton>\r\n                :\r\n                <span>\r\n                  <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit}>\r\n                      <SaveIcon />\r\n                  </IconButton>\r\n                  <IconButton color=\"primary\" aria-label=\"Cancel\" onClick={this.handleCancel}>\r\n                      <CancelIcon />\r\n                  </IconButton>\r\n                </span>\r\n            }\r\n            <div>{imageElements}</div>\r\n            {(imageElements.length > 0)?\r\n                <IconButton color=\"primary\" aria-label=\"Edit\" onClick={this.handleEditImageAddition}>\r\n                    <AddIcon />\r\n                </IconButton>\r\n                :\r\n                <span></span>\r\n            }\r\n        \r\n      </Container>\r\n\r\n    );\r\n  }\r\n};","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass FormService {\r\n\r\n\tgetAnnotationForms(annotation_id) {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"annotations/\"+annotation_id+\"/forms\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\r\n\t}\r\n\r\n\tget(id) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"forms/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\t}\r\n\r\n  \tcreate(kindOf, text, annotation_id) {\r\n\r\n\t\tlet data = {kindOf:kindOf,text:text,annotation_id:annotation_id};\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"forms\", data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \t//update(id,kindOf,text){\r\n  \tupdate(id,kindOf,text){\r\n\r\n\t    let data = {kindOf:kindOf,text:text};\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.put(API_URL + \"forms/\" +id, data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"forms/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new FormService();\r\n","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass TranslationService {\r\n\r\n\tgetAnnotationTranslations(annotation_id) {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"annotations/\"+annotation_id+\"/translations\",{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\t    \r\n\t}\r\n\r\n\tget(id) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t    axios.get(API_URL + \"translations/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n\t}\r\n\r\n  \tcreate(lang, text, annotation_id) {\r\n\r\n\t\tlet data = {lang:lang,text:text,annotation_id:annotation_id};\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + \"translations\", data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \t//update(id,lang,text){\r\n  \tupdate(id,lang,text){\r\n  \t\tlet formData = new FormData();\r\n\t    formData.append(\"lang\", lang);\r\n\t    formData.append(\"text\", text);\r\n\r\n\t    let form = {lang:lang,text:text};\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.put(API_URL + \"translations/\" +id, form,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"translations/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new TranslationService();\r\n","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport globalParameters from '../global_parameters';\r\n\r\nconst API_URL = globalParameters.API_URL;\r\n\r\nclass NoteService {\r\n\r\n  \tcreate(lang, text, parent_type, parent_id) {\r\n\r\n\t\tlet data = {lang:lang,text:text};\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.post(API_URL + parent_type +\"s/\" + parent_id + \"/notes\", data,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \t//update(id,lang,text){\r\n  \tupdate(id,lang,text){\r\n  \t\tlet formData = new FormData();\r\n\t    formData.append(\"lang\", lang);\r\n\t    formData.append(\"text\", text);\r\n\r\n\t    let form = {lang:lang,text:text};\r\n\r\n\t    authHeader['Content-Type'] = 'application/json';\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.put(API_URL + \"notes/\" +id, form,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n\r\n  \tdelete(id) {\r\n\r\n\t    return new Promise((resolve, reject) => {\r\n\t    axios.delete(API_URL + \"notes/\" + id,{headers: authHeader()})\r\n\t      .then(res => { resolve(res) })\r\n\t      .catch(err => { reject(err) })\r\n\t    });\r\n  \t}\r\n}\r\n\r\nexport default new NoteService();\r\n","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormService from \"../services/form.service\";\r\nimport TranslationService from \"../services/translation.service\";\r\nimport NoteService from \"../services/note.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass TextItemCreateForm extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      text:\"\",\r\n      lang:(this.props.available_lang != null && this.props.available_lang.length > 0) ? this.props.available_lang[0]:\"\",\r\n      open: props.open,\r\n      loading:false\r\n    };\r\n\r\n  }\r\n\r\n  onLangChange = (event) => {\r\n    this.setState({lang:event.target.value});\r\n  }\r\n\r\n  onTextChange = (event) => {\r\n    this.setState({text:event.target.value});\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleSubmit = () => {\r\n\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n\r\n    this.props.type==='form' && FormService.create(this.state.lang,this.state.text,this.props.parentId).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.props.refresh('form');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='translation' && TranslationService.create(this.state.lang,this.state.text,this.props.parentId).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.props.refresh('translation');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='note' && NoteService.create(this.state.lang,this.state.text,this.props.parentType,this.props.parentId).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          this.props.refreshNotesParent();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  };\r\n\r\n\r\n  render() {\r\n    var visibility = (this.props.hidden)?\"none\":\"\";\r\n\r\n    return (\r\n       \r\n      <Container style={{display:visibility}}>\r\n              <FormControl>\r\n                <InputLabel htmlFor=\"select-lang\">\r\n                  {this.props.type === \"translation\"?\"Language\":\"Kind of form\"}\r\n                </InputLabel>\r\n                <Select\r\n                  native\r\n                  value={this.state.lang}\r\n                  inputProps={{\r\n                    id: 'select-lang',\r\n                  }}\r\n                  onChange={this.onLangChange}\r\n                >\r\n                  {(this.props.available_lang!=null) && this.props.available_lang.map((a) => (\r\n                    <option value={a}>\r\n                      {a}\r\n                    </option>\r\n                  ))}\r\n\r\n                </Select>\r\n              </FormControl>\r\n\r\n              <TextField\r\n                label={this.props.type === \"translation\"?\"Translation text\":\"Form text\"}\r\n                placeholder={this.props.type === \"translation\"?\"Translation text\":\"Form text\"}\r\n                multiline\r\n                fullWidth\r\n                rowsMax={4}\r\n                value={this.state.text}\r\n                onChange={this.onTextChange}\r\n              />\r\n                {\r\n                  this.state.loading ? <CircularProgress size=\"1.5rem\" /> :\r\n                  <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit} hidden={!(this.state.lang.length >=2 && this.state.text.length >=1)}>\r\n                      <SaveIcon />\r\n                  </IconButton>\r\n                }\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(TextItemCreateForm);","import TextItem from './document.annotation.text.item.component';\r\nimport React, { Component } from 'react';\r\n\r\nexport default class Note extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <TextItem \r\n      type=\"note\" \r\n      id={this.props.data.id} \r\n      lang={this.props.data.lang} \r\n      text={this.props.data.text}\r\n      refresh={this.props.refresh} \r\n      refreshNotesParent={this.props.refreshNotesParent} \r\n      available_lang={this.props.available_lang}\r\n      note_available_lang={this.props.note_available_lang}\r\n      parent_type={this.props.parent_type}\r\n      />\r\n    );\r\n  }\r\n};","//Same component used for Form/Translation/Note\r\n\r\nimport React, { Component } from 'react';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Container from '@material-ui/core/Container';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport RemoveIcon from '@material-ui/icons/RemoveCircle';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport TextItemCreateForm from './document.annotation.text.item.createform.component';\r\n\r\nimport Note from './document.annotation.note.component';\r\n\r\nimport FormService from \"../services/form.service\";\r\nimport TranslationService from \"../services/translation.service\";\r\nimport NoteService from \"../services/note.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nexport default class TextItem extends React.Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      text:this.props.text,\r\n      lang:this.props.lang,\r\n      originalText:this.props.text,\r\n      originalLang:this.props.lang,\r\n      expanded: false,\r\n      inputEnabled: false,\r\n      loading:false,\r\n      openNewNote:false\r\n    };\r\n\r\n  }\r\n\r\n  handleExpand = (panel) => (event, isExpanded) => {\r\n    this.setState({expanded: isExpanded ? panel : false});\r\n  };\r\n\r\n  handleEdit = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled});\r\n  };\r\n\r\n  onLangChange = (event) => {\r\n    this.setState({lang:event.target.value});\r\n  }\r\n\r\n  onTextChange = (event) => {\r\n    this.setState({text:event.target.value});\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.setState({inputEnabled:!this.state.inputEnabled,lang:this.state.originalLang,text:this.state.originalText});\r\n  };\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n\r\n  handleDelete = () => {\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n    this.props.type==='form' && FormService.delete(this.props.id).then(\r\n      (response) => {\r\n          this.props.refresh('form');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='translation' && TranslationService.delete(this.props.id).then(\r\n      (response) => {\r\n          this.props.refresh('translation');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          \r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='note' && NoteService.delete(this.props.id).then(\r\n      (response) => {\r\n        \r\n          this.setState({\r\n            inputEnabled:false,\r\n            loading:false\r\n          },this.props.refreshNotesParent());\r\n          \r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  };\r\n\r\n\r\n  handleSubmit = () => {\r\n\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n\r\n    this.props.type==='form' && FormService.update(this.props.id,this.state.lang,this.state.text).then(\r\n      (response) => {\r\n          this.setState({\r\n            inputEnabled:false,\r\n            originalLang:this.state.lang,\r\n            originalText:this.state.text,\r\n            expanded:false,\r\n            loading:false\r\n          });\r\n          this.props.refresh('form');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='translation' && TranslationService.update(this.props.id,this.state.lang,this.state.text).then(\r\n      (response) => {\r\n          this.setState({\r\n            inputEnabled:false,\r\n            originalLang:this.state.lang,\r\n            originalText:this.state.text,\r\n            expanded:false,\r\n            loading:false\r\n          });\r\n          this.props.refresh('translation');\r\n        },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    this.props.type==='note' && NoteService.update(this.props.id,this.state.lang,this.state.text).then(\r\n      (response) => {\r\n            this.setState({\r\n              inputEnabled:false,\r\n              loading:false\r\n            },this.props.refreshNotesParent());\r\n          },\r\n        error => {\r\n          this.setState({\r\n            inputEnabled:true,\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  };\r\n\r\n  openNewNoteForm = () => {\r\n    this.setState({openNewNote:!this.state.openNewNote});\r\n  }\r\n\r\n\r\n  render() {\r\n    \r\n    return (\r\n       \r\n      <Container>\r\n\r\n        <Accordion \r\n         expanded={this.state.expanded === 'panel1'} \r\n         onChange={this.handleExpand('panel1')}\r\n         >\r\n           <AccordionSummary\r\n            expandIcon={<ExpandMoreIcon />}\r\n            aria-controls=\"panel1bh-content\"\r\n            id=\"panel1bh-header\"\r\n          >\r\n          <Chip label={this.props.type} size=\"small\" />\r\n\r\n          <Chip label={this.props.lang} size=\"small\" color=\"secondary\" />\r\n\r\n          {this.props.text.substring(0,50)}{this.props.text.length>50?\"...\":\"\"}\r\n\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n\r\n            <Grid container>\r\n              <Grid item  xs={2}>\r\n                  <FormControl>\r\n                    <InputLabel htmlFor=\"select-lang\">\r\n                      {this.props.type === \"form\"?\"Kind of form\":\"Language\"}\r\n                    </InputLabel>\r\n                    <Select\r\n                      native\r\n                      value={this.state.lang}\r\n                      inputProps={{\r\n                        id: 'select-lang',\r\n                      }}\r\n                      onChange={this.onLangChange}\r\n                    >\r\n                      {this.props.available_lang.map((a) => (\r\n                        <option value={a}>\r\n                          {a}\r\n                        </option>\r\n                      ))}\r\n\r\n                    </Select>\r\n                  </FormControl>\r\n              </Grid>\r\n\r\n\r\n                <Grid item  xs={10}>\r\n                  <TextField\r\n                    id={this.props.type+this.props.id}\r\n                    label={this.props.type === \"form\"?\"Form text\":\"Text\"}\r\n                    placeholder={this.props.type === \"form\"?\"Form text\":\"Text\"}\r\n                    multiline\r\n                    disabled={!this.state.inputEnabled}\r\n                    fullWidth\r\n                    rowsMax={4}\r\n                    value={this.state.text}\r\n                    onChange={this.onTextChange}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n\r\n              {this.props.type !== 'note' && \r\n              <Grid container>\r\n                <Grid item xs={12}>\r\n                <Chip\r\n                    icon={this.state.openNewNote ? <RemoveIcon /> : <AddIcon /> }\r\n                    label=\"note\"\r\n                    clickable\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={this.openNewNoteForm}\r\n                  />\r\n                  <TextItemCreateForm \r\n                  type=\"note\" \r\n                  parentId={this.props.id}\r\n                  parentType={this.props.type} \r\n                  refresh={this.props.refresh}\r\n                  refreshNotesParent={this.props.refreshNotes} \r\n                  hidden={!this.state.openNewNote}\r\n                  available_lang={this.props.note_available_lang}\r\n                  />\r\n                {this.props.notes && this.props.notes.length > 0 && this.props.notes.map((note) => (\r\n                    <Note\r\n                      data={note}\r\n                      refresh={this.props.refresh}\r\n                      refreshNotesParent={this.props.refreshNotes}\r\n                      available_lang={this.props.note_available_lang}\r\n                      parent_type={this.props.type}\r\n                    />\r\n                  ))}\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n              \r\n              {\r\n                this.state.loading ? <CircularProgress size=\"1.5rem\" />\r\n              :\r\n              (\r\n                !this.state.inputEnabled ?\r\n                <div>\r\n                  <IconButton color=\"primary\" aria-label=\"Edit\" onClick={this.handleEdit}>\r\n                      <EditIcon />\r\n                  </IconButton>\r\n                  <IconButton color=\"primary\" aria-label=\"Delete\" onClick={this.handleDelete}>\r\n                    <DeleteIcon />\r\n                  </IconButton>\r\n                </div>\r\n                :\r\n                <div>\r\n                  <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit}>\r\n                      <SaveIcon />\r\n                  </IconButton>\r\n                  <IconButton color=\"primary\" aria-label=\"Cancel\" onClick={this.handleCancel}>\r\n                      <CancelIcon />\r\n                  </IconButton>\r\n                </div>\r\n                \r\n                )\r\n              }\r\n\r\n           \r\n          </AccordionDetails>\r\n        </Accordion>\r\n\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\n/*export default withRouter(TextItem);*/","import TextItem from './document.annotation.text.item.component';\r\nimport FormService from \"../services/form.service\";\r\n\r\nexport default class Form extends TextItem {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = { \r\n      notes:this.props.data.notes\r\n    };\r\n\r\n  }\r\n\r\n    refreshNotes = () => {\r\n    //rafrachit le contenu de l'annotation\r\n      FormService.get(this.props.data.id).then(\r\n        (response) => {\r\n          this.setState({\r\n            notes:response.data.notes\r\n          });\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  render() {\r\n    console.log(\"render Form\");\r\n    console.log(this.state.notes);\r\n\r\n    return (\r\n      <TextItem \r\n      type=\"form\" \r\n      id={this.props.data.id} \r\n      lang={this.props.data.kindOf} \r\n      text={this.props.data.text}\r\n      notes={this.state.notes} \r\n      refresh={this.props.refresh}\r\n      refreshNotes={this.refreshNotes}  \r\n      available_lang={this.props.available_lang}\r\n      note_available_lang={this.props.note_available_lang}\r\n      />\r\n    );\r\n  }\r\n};","import TextItem from './document.annotation.text.item.component';\r\nimport TranslationService from \"../services/translation.service\";\r\n\r\nexport default class Translation extends TextItem {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      notes:this.props.data.notes\r\n    };\r\n\r\n  }\r\n\r\n  refreshNotes = () => {\r\n    //rafrachit le contenu de l'annotation\r\n      TranslationService.get(this.props.data.id).then(\r\n        (response) => {\r\n          this.setState({\r\n            notes:response.data.notes\r\n          },this.forceUpdate());\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <TextItem\r\n        type=\"translation\"\r\n        id={this.props.data.id}\r\n        lang={this.props.data.lang}\r\n        text={this.props.data.text}\r\n        notes={this.state.notes}\r\n        refresh={this.props.refresh}\r\n        refreshNotes={this.refreshNotes}\r\n        available_lang={this.props.available_lang}\r\n        note_available_lang={this.props.note_available_lang}\r\n      />\r\n    );\r\n  }\r\n};","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport OkIcon from '@material-ui/icons/Check';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormService from \"../services/form.service\";\r\nimport AnnotationService from \"../services/annotation.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass SplitForm extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      nbWords:this.props.nbWords,\r\n      loading:false\r\n    };\r\n\r\n  }\r\n\r\n  onTextChange = (event) => {\r\n    this.setState({nbWords:event.target.value});\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleSubmit = () => {\r\n\r\n    this.setState({\r\n      loading:true,\r\n      inputEnabled:false\r\n    });\r\n\r\n    \r\n\r\n    const splittedForm = this.props.formToSplit.split(' ');\r\n    var audioStep = 0;\r\n    var imageStep = 0;\r\n    var imageWidth = 0;\r\n    var imageHeight = 0;\r\n    var audioPadding = 0.1;\r\n    var imagePadding = 2;\r\n\r\n    var firstX1 = 0;\r\n    var firstX2 = 0;\r\n\r\n\r\n    if(this.props.audioStart && this.props.audioEnd && (this.props.audioEnd - this.props.audioStart) > 0){\r\n\r\n      audioStep = (this.props.audioEnd - this.props.audioStart) / this.state.nbWords;\r\n\r\n    }\r\n\r\n    if(this.props.imageCoords.length > 0){\r\n\r\n      var firstImage = true;\r\n\r\n      this.props.imageCoords.forEach((i) => {\r\n\r\n        var coords = i.areaCoords.split(',');\r\n        imageWidth += (coords[2]-coords[0]);\r\n        imageHeight = Math.max(imageHeight,(coords[3]-coords[1]));\r\n\r\n        if(firstImage){\r\n          firstX1 = coords[0];\r\n          firstX2 = coords[2];\r\n          firstImage = false;\r\n        }\r\n      });\r\n\r\n      imageStep = imageWidth / this.state.nbWords;\r\n    }\r\n\r\n    var isOnFirstImage = true;\r\n    var imageToSplit;\r\n    var j = 0;\r\n    //var splittedFormTimeKey = [];\r\n    //var splittedFormImageKey = [];\r\n\r\n    for(var k = 0; k < this.state.nbWords ;k++){\r\n\r\n      imageToSplit = (isOnFirstImage)?this.props.imageCoords[0]:this.props.imageCoords[1];\r\n      var imageCoords = imageToSplit.areaCoords.split(',');\r\n\r\n      var audioSplitStart = ((k * audioStep) + audioPadding) + parseFloat(this.props.audioStart);\r\n      var audioSplitEnd = (((k+1) * audioStep) - audioPadding) + parseFloat(this.props.audioStart);\r\n      var x1 = ((k-j) * imageStep) + imagePadding + parseFloat(imageCoords[0]);\r\n      var x2 = ((k-j+1) * imageStep) - imagePadding + parseFloat(imageCoords[0]);\r\n\r\n      if(x1 > imageCoords[2]){\r\n        j = k;\r\n        isOnFirstImage = false;\r\n      }\r\n\r\n      var data={\r\n        document_id:this.props.documentId,\r\n        type:\"W\",\r\n        rank:(k+1),\r\n        parent_id:this.props.parentId,\r\n        imageCoords:[{\r\n            \"image_id\":imageToSplit.image_id,\r\n            \"areaCoords\":x1+\",\"+imageCoords[1]+\",\"+x2+\",\"+imageCoords[3]+\",\"+imageCoords[4]\r\n          }],\r\n        audioStart:parseFloat(audioSplitStart.toFixed(2)),\r\n        audioEnd:parseFloat(audioSplitEnd.toFixed(2))\r\n      };\r\n\r\n      //splittedFormTimeKey[audioSplitStart.toFixed(2)] = splittedForm[k];\r\n      //splittedFormImageKey[x1] = splittedForm[k];\r\n\r\n      var successNb = 0;\r\n      \r\n      AnnotationService.create(data).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          \r\n          //var key = response.data.audioStart.toFixed(2);\r\n\r\n          (this.props.formToSplit.length > 0) && FormService.create(this.props.kindOf,splittedForm[response.data.rank-1],response.data.id).then(\r\n            (responseFormCreate) => {\r\n              successNb++;\r\n            },\r\n            error => {\r\n              this.setState({\r\n                loading:false\r\n              });\r\n\r\n              if(error.response.status===401) this.props.history.push('/login');\r\n\r\n              const resMessage =\r\n                (error.response &&\r\n                  error.response.data &&\r\n                  error.response.data.message) ||\r\n                error.message ||\r\n                error.toString();\r\n\r\n              alert(resMessage);\r\n            }\r\n          );\r\n          \r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n        \r\n\r\n    }\r\n\r\n    console.log(k,successNb);\r\n\r\n    \r\n\r\n\r\n  };\r\n\r\n\r\n  render() {\r\n    var visibility = (this.props.hidden)?\"none\":\"\";\r\n    var splittedForm = this.props.formToSplit.split(' ').join(' / ');\r\n\r\n    return (\r\n       \r\n      <Container style={{display:visibility}}>\r\n\r\n              <TextField\r\n                label=\"Number of words\"\r\n                placeholder=\"Number of words\"\r\n                value={this.state.nbWords}\r\n                onChange={this.onTextChange}\r\n              />\r\n                {\r\n                  this.state.loading ? <CircularProgress size=\"1.5rem\" /> :\r\n                  <IconButton color=\"primary\" aria-label=\"Save\" onClick={this.handleSubmit} hidden={!this.state.nbWords.length}>\r\n                      <OkIcon />\r\n                  </IconButton>\r\n                }\r\n\r\n                <p>\r\n                  <small>{splittedForm}</small>\r\n                </p>\r\n      </Container>\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(SplitForm);","import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport RemoveIcon from '@material-ui/icons/RemoveCircle';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport SplitIcon from '@material-ui/icons/PowerInput';\r\n\r\n\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Audio from './document.annotation.audio.component';\r\nimport Image from './document.annotation.image.component';\r\nimport Form from './document.annotation.form.component';\r\nimport Translation from './document.annotation.translation.component';\r\n\r\nimport TextItemCreateForm from './document.annotation.text.item.createform.component';\r\nimport SplitForm from './document.annotation.splitform.component';\r\nimport Button from '@material-ui/core/Button';\r\n\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\n\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\n\r\n\r\nimport FormService from \"../services/form.service\";\r\nimport TranslationService from \"../services/translation.service\";\r\nimport AnnotationService from \"../services/annotation.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\n/*import { withRouter } from 'react-router-dom';*/\r\n\r\nexport default class DocumentAnnotation extends React.Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      loading:false,\r\n      expanded: (this.props.data.type === 'T' || (window.currentAnnotationEdition && this.props.data.id ===window.currentAnnotationEdition.id))?'panel1':false,\r\n      forms:this.props.data.forms,\r\n      translations:this.props.data.translations,\r\n      children:this.props.data.children_annotations,\r\n      audioStart:this.props.data.audioStart,\r\n      audioEnd:this.props.data.audioEnd,\r\n      openNewForm:false,\r\n      openNewTranslation:false,\r\n      openSplit:false,\r\n      nextChildRank:0,\r\n      openDeleteDialog:false\r\n    };\r\n\r\n  }\r\n\r\n  handleExpand = (panel) => (event, isExpanded) => {\r\n    this.setState({expanded: isExpanded ? panel : false});\r\n  };\r\n\r\n\r\n  handleCloseDeleteDialog = (event) => {\r\n    this.setState({\r\n        openDeleteDialog: false\r\n      });\r\n  };\r\n\r\n  handleOpenDeleteDialog = (event) => {\r\n    this.setState({\r\n        openDeleteDialog: true\r\n      });\r\n  };\r\n\r\n\r\n  handleDeleteAnnotation = (event) => {\r\n    this.setState({\r\n      loading: true\r\n    });\r\n\r\n    window.coordinates = undefined;\r\n\r\n    AnnotationService.delete(this.props.data.id).then(\r\n      (response) => {\r\n          this.props.refreshAnnotations();\r\n          this.handleCloseDeleteDialog();\r\n          this.setState({\r\n            loading: false\r\n          });\r\n          this.refresh(\"children\");\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        });\r\n  };\r\n\r\n\r\n  handleAddChild = ()=>{\r\n    var childTypes = {\"T\":\"S\",\"S\":\"W\",\"W\":\"M\"};\r\n    var childType = childTypes[this.props.data.type];\r\n\r\n    var data={\r\n      document_id:this.props.data.document_id,\r\n      type:childType,\r\n      rank:this.state.nextChildRank,\r\n      parent_id:this.props.data.id\r\n    };\r\n\r\n\r\n    AnnotationService.create(data).then(\r\n        (response) => {\r\n          this.setState({\r\n            nextChildRank:this.state.nextChildRank+1\r\n          });\r\n          this.refresh(\"children\");\r\n          this.props.annotationHasChanged();\r\n          window.coordinates = undefined;\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        }\r\n      );\r\n\r\n  }\r\n\r\n  openNewFormForm = () => {\r\n    this.setState({openNewForm:!this.state.openNewForm});\r\n  }\r\n\r\n  openNewTranslationForm = () => {\r\n    this.setState({openNewTranslation:!this.state.openNewTranslation});\r\n  }\r\n\r\n  openSplitForm = () => {\r\n    this.setState({openSplit:!this.state.openSplit});\r\n  }\r\n\r\n  refresh = (type) => {\r\n    //rafrachit le contenu de l'annotation\r\n    console.log(\"refresh called \"+type);\r\n\r\n    window.coordinates = undefined;\r\n    \r\n    type===\"form\" && this.setState({openNewForm:false});\r\n    type===\"translation\" && this.setState({openNewTranslation:false});\r\n\r\n    type===\"form\" && FormService.getAnnotationForms(this.props.data.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            forms:response.data\r\n          });\r\n          this.props.annotationHasChanged();\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    type===\"translation\" && TranslationService.getAnnotationTranslations(this.props.data.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            translations:response.data\r\n          });\r\n          this.props.annotationHasChanged();\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    type===\"children\" && AnnotationService.getAnnotationChildren(this.props.data.id).then(\r\n      (response) => {\r\n          this.setState({\r\n            children:response.data\r\n          });\r\n          this.props.refreshAnnotations();\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          this.setState({\r\n            loading:false\r\n          });\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n    var lastRank = (this.state.children && this.state.children.length > 0)\r\n    ?\r\n    Math.max.apply(Math, this.state.children.map(function(a) { return a.rank; }))\r\n    :\r\n    0\r\n    ;\r\n    this.setState({nextChildRank:lastRank+1});\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div>\r\n          <Grid container>\r\n            <Grid item xs={1}>\r\n              <Container>\r\n                <Chip\r\n                    label={this.props.data.type+this.props.data.rank}\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                  />\r\n              </Container>\r\n\r\n              <Container>\r\n                <FormControl>\r\n                  <InputLabel htmlFor=\"select-parent-annotation\">\r\n                    Parent annotation\r\n                  </InputLabel>\r\n                  <Select\r\n                    native\r\n                    value={this.props.data.parent_id}\r\n                    inputProps={{\r\n                      id: 'select-parent-annotation',\r\n                    }}\r\n                  >\r\n                    {this.props.parentAnnotations.map((a) => (\r\n                      <option key={a.id} value={a.id} nextChildRank={a.nextChildRank} disabled={this.props.data.type!==a.childrenType} hidden={this.props.type!==a.childrenType}>\r\n                        {a.label}\r\n                      </option>\r\n                    ))}\r\n\r\n                  </Select>\r\n                </FormControl>\r\n              </Container>\r\n\r\n            </Grid>\r\n\r\n            <Grid item xs={10}>\r\n              <Container item xs={6}>\r\n                {\r\n                  (this.props.data.type !== 'T') && (window.wavesurfer !== null) &&\r\n                  <Audio \r\n                    annotationHasChanged={this.props.annotationHasChanged} \r\n                    handleEditionState={this.props.handleEditionState} \r\n                    audioStart={this.state.audioStart} \r\n                    audioEnd={this.state.audioEnd} \r\n                    annotationId={this.props.data.id} \r\n                    annotationLabel={this.props.data.type+this.props.data.rank} \r\n                  />\r\n                }\r\n              </Container>\r\n\r\n              <Container item xs={6}>\r\n                    {\r\n                      (this.props.data.type !== 'T') && \r\n                      <Image \r\n                        imageCoords={this.props.data.imageCoords} \r\n                        handleEditionState={this.props.handleEditionState}\r\n                        annotationId={this.props.data.id} \r\n                        annotationLabel={this.props.data.type+this.props.data.rank} \r\n                      />\r\n                    }\r\n              </Container>\r\n\r\n              <Container item xs={6}>\r\n                <Container item  xs={12}>\r\n                  \r\n                  <Chip\r\n                    icon={this.state.openNewForm ? <RemoveIcon /> : <AddIcon /> }\r\n                    label=\"form\"\r\n                    clickable\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={this.openNewFormForm}\r\n                  />\r\n                  <TextItemCreateForm \r\n                  type=\"form\" \r\n                  parentId={this.props.data.id} \r\n                  refresh={this.refresh} \r\n                  hidden={!this.state.openNewForm}\r\n                  available_lang={this.props.available_kindOf}\r\n                  />\r\n                  {this.state.forms && this.state.forms.length > 0 && this.state.forms.map((form) => (\r\n                    <Form\r\n                      data={form}\r\n                      refresh={this.refresh}\r\n                      available_lang={this.props.available_kindOf}\r\n                      note_available_lang={this.props.available_lang}\r\n                    />\r\n                  ))}\r\n\r\n                </Container>\r\n\r\n                <Container item xs={12}>\r\n                  <Typography variant=\"h5\" gutterBottom>\r\n                  </Typography>\r\n                  \r\n                  <Chip\r\n                    icon={this.state.openNewTranslation ? <RemoveIcon /> : <AddIcon /> }\r\n                    label=\"translation\"\r\n                    clickable\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={this.openNewTranslationForm}\r\n                  />\r\n                  <TextItemCreateForm \r\n                  type=\"translation\" \r\n                  parentId={this.props.data.id} \r\n                  refresh={this.refresh} \r\n                  hidden={!this.state.openNewTranslation} \r\n                  available_lang={this.props.available_lang}\r\n                  />\r\n                  {this.state.translations && this.state.translations.length >0 && this.state.translations.map((translation) => (\r\n                    <Translation\r\n                      data={translation}\r\n                      refresh={this.refresh}\r\n                      available_lang={this.props.available_lang}\r\n                      note_available_lang={this.props.available_lang}\r\n                    />\r\n                  ))}\r\n\r\n                </Container>\r\n\r\n\r\n              {(this.props.data.type===\"S\" && this.props.data.children_annotations.length===0) && <Container item xs={12}>\r\n                  <Typography variant=\"h5\" gutterBottom>\r\n                  </Typography>\r\n                  <Chip\r\n                  clickable\r\n                    icon=<SplitIcon />\r\n                    label=\"words auto-split\"\r\n                    size=\"small\"\r\n                    color=\"primary\"\r\n                    onClick={this.openSplitForm}\r\n                  />\r\n                  <SplitForm \r\n                  parentId={this.props.data.id} \r\n                  refresh={this.refresh} \r\n                  hidden={!this.state.openSplit}\r\n                  nbWords={(this.state.forms.length>0)?this.state.forms[0].text.split(' ').length:2}\r\n                  audioStart={this.state.audioStart}\r\n                  audioEnd={this.state.audioEnd}\r\n                  imageCoords={this.props.data.imageCoords}\r\n                  formToSplit = {(this.state.forms.length>0)?this.state.forms[0].text:\"\"}\r\n                  kindOf = {(this.state.forms.length>0)?this.state.forms[0].kindOf:\"\"}\r\n                  documentId = {this.props.data[\"document_id\"]}\r\n                  />\r\n              </Container>\r\n              }\r\n\r\n                {this.props.data.type !== 'T' && \r\n                  <IconButton color=\"primary\" aria-label=\"Delete\" onClick={this.handleOpenDeleteDialog} title=\"Delete annotation\">\r\n                    <DeleteIcon />\r\n                  </IconButton>\r\n                }\r\n              </Container>\r\n            </Grid>\r\n\r\n            <Grid item xs={1}>\r\n              <Container>\r\n                <IconButton aria-label=\"close\" onClick={this.props.onClose}>\r\n                  <CancelIcon />\r\n                </IconButton>\r\n              </Container>\r\n            </Grid>\r\n \r\n          </Grid>\r\n\r\n          <Dialog open={this.state.openDeleteDialog} onClose={this.handleCloseDeleteDialog} aria-labelledby=\"form-deletedialog-title\">\r\n            <DialogTitle id=\"form-deletedialog-title\">Delete annotation</DialogTitle>\r\n            <DialogContent>\r\n              <DialogContentText>\r\n                Delete annotation {this.props.data.type+this.props.data.rank} ?\r\n              </DialogContentText>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={this.handleCloseDeleteDialog} color=\"primary\">\r\n                Cancel\r\n              </Button>\r\n              {!this.state.loading && <Button onClick={this.handleDeleteAnnotation} color=\"primary\">\r\n                Delete annotation\r\n              </Button>\r\n              }\r\n              {this.state.loading && <CircularProgress />}\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n        </div>\r\n    );\r\n  }\r\n};\r\n\r\n/*export default withRouter(DocumentAnnotation);*/"," import React, { Component } from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport Box from '@material-ui/core/Box';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Input from '@material-ui/core/Input';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport DocumentService from \"../services/document.service\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass DocumentAnnotationsImport extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      message: \"\",\r\n      loading: false,\r\n      openImportDialog: false,\r\n      importedData: {\"TEXT\":\"nothing\"},\r\n      progress:0\r\n    };\r\n\r\n    this.handleImport = this.handleImport.bind(this);\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n  }\r\n\r\n  handleCloseImportDialog = (event) => {\r\n    this.setState({\r\n        openImportDialog: false\r\n      });\r\n  };\r\n\r\n  handleOpenImportDialog = (event) => {\r\n    document.getElementsByName('xmlInputFile')[0].files.length > 0 &&\r\n    this.setState({\r\n        openImportDialog: true\r\n      });\r\n  };\r\n\r\n  handleImport(e) {\r\n    e.preventDefault();\r\n\r\n    this.setState({\r\n      message: \"\",\r\n      loading: true,\r\n      progress:0\r\n    });\r\n\r\n    var that = this;\r\n\r\n    function increaseProgress(percentUnit){\r\n      that.setState({\r\n        progress:(that.state.progress + percentUnit)>100 ? 100 : (that.state.progress + percentUnit)\r\n      });\r\n    }\r\n    \r\n    //Ratio observ sur 3 imports :\r\n    // - wordlist crdo-MTQ_TUPHONG_VOC.xml : 1825 W, 1480 Ko, 480 secondes\r\n    // - wordlist crdo-TOU_VOC1.xml : 367 W, 303 Ko, 96 secondes\r\n    // - text crdo-TWH_T19.xml : 13 S et 154 W, 71 Ko, 30 secondes\r\n\r\n    var ratio = ((480/1480)+(96/303)+(30/71))/3;\r\n\r\n    var estimatedDelay = ratio * document.getElementsByName('xmlInputFile')[0].files[0].size / 1000;\r\n    var percentUnit = 100 / estimatedDelay;\r\n\r\n    setInterval(increaseProgress,1000, percentUnit);\r\n\r\n    DocumentService.import(document.getElementsByName('xmlInputFile')[0].files[0],this.props.documentId).then(\r\n        response => {\r\n          this.setState({\r\n            importedData:response.data,\r\n            openImportDialog:false\r\n          });\r\n          this.props.refreshAnnotations();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            importedData:\r\n              (error.response && error.response.data) ||\r\n              error.message ||\r\n              error.toString(),\r\n              openImportDialog:false\r\n          });\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n        });\r\n    \r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <Container>\r\n\r\n        <Input\r\n            type=\"file\"\r\n            accept=\"text/xml\"\r\n            name=\"xmlInputFile\"\r\n          />\r\n          <Button onClick={this.handleOpenImportDialog} color=\"primary\">\r\n            Import\r\n          </Button>\r\n          {this.state.importedData && this.state.importedData.TEXT && this.state.importedData.TEXT['xml:lang']}\r\n          {this.state.importedData && this.state.importedData.WORDLIST && this.state.importedData.WORDLIST['xml:lang']}\r\n\r\n        <Dialog open={this.state.openImportDialog} onClose={this.handleCloseImportDialog} aria-labelledby=\"form-createdialog-title\">\r\n          <DialogTitle id=\"form-importdialog-title\">Import annotations from XML file</DialogTitle>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Importing annotations from a XML file (DTD Pangloss) will delete all annotations for this document. Confirm ?\r\n            </DialogContentText>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={this.handleCloseImportDialog} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            {!this.state.loading && <Button onClick={this.handleImport} color=\"primary\">Import</Button>}\r\n            {this.state.loading && \r\n              <Box position=\"relative\" display=\"inline-flex\">\r\n                <CircularProgress variant=\"determinate\" value={this.state.progress}/>\r\n                <Box\r\n                  top={0}\r\n                  left={0}\r\n                  bottom={0}\r\n                  right={0}\r\n                  position=\"absolute\"\r\n                  display=\"flex\"\r\n                  alignItems=\"center\"\r\n                  justifyContent=\"center\"\r\n                >\r\n                  <Typography variant=\"caption\" component=\"div\" color=\"textSecondary\">\r\n                  {Math.round(this.state.progress)}%\r\n                  </Typography>\r\n                </Box>\r\n              </Box>\r\n            }\r\n\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n      </Container>\r\n\r\n\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(DocumentAnnotationsImport);","/*\r\nhttps://medium.com/trackstack/simple-audio-waveform-with-wavesurfer-js-and-react-ae6c0653b240\r\nhttps://github.com/katspaugh/window.wavesurfer.js/blob/master/example/annotation/app.js\r\n*/\r\nimport React, { Component } from 'react';\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\nimport WaveSurfer from 'wavesurfer.js';\r\nimport TimelinePlugin from 'wavesurfer.js/dist/plugin/wavesurfer.timeline.js';\r\nimport MinimapPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.minimap.js';\r\nimport RegionsPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.regions.js';\r\nimport MarkersPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.markers.js';\r\n\r\nimport { AppBar, Button, Drawer, Tabs, Tab, Typography, Box, Switch } from '@material-ui/core';\r\nimport Chip from '@material-ui/core/Chip';\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle';\r\nimport ImportIcon from '@material-ui/icons/CloudDownload';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PlayIcon from '@material-ui/icons/PlayCircleFilledWhite';\r\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport ZoomIn from '@material-ui/icons/ZoomIn';\r\nimport ZoomOut from '@material-ui/icons/ZoomOut';\r\n\r\nimport Slider from '@material-ui/core/Slider';\r\n\r\nimport ImageMultiSelector from './imageMultiSelector.component';\r\n\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Radio from '@material-ui/core/Radio';\r\nimport RadioGroup from '@material-ui/core/RadioGroup';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport FormLabel from '@material-ui/core/FormLabel';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Select from '@material-ui/core/Select';\r\n\r\nimport DocumentAnnotation from './document.annotation.component';\r\nimport DocumentAnnotationsImport from './document.annotations.import.component';\r\nimport AnnotationService from \"../services/annotation.service\";\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport Tree from 'react-animated-tree';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nwindow.wavesurfer = null;\r\n\r\nclass DocumentAnnotations extends React.Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      playing: false,\r\n      zoom: 10,\r\n      tabValue:window.tabValue?window.tabValue:0,\r\n      crop:null,\r\n      annotationsPanel: false,\r\n      annotationPanel: false,\r\n      importPanel: false,\r\n      annotations: this.props.annotations,\r\n      change:0,\r\n      openEditionNotification:window.currentAnnotationEdition && window.currentAnnotationEdition!==null,\r\n      editionNotification:\"\",\r\n      editionType:\"audio\",\r\n      editionData:{},\r\n      audioSelection:false,\r\n      imageSelection:false,\r\n      openCreateDialog:false,\r\n      newAnnotationType:null,\r\n      parentAnnotations:[],\r\n      parentAnnotationId:0,\r\n      nextChildRank:0,\r\n      selectedAnnotation: {},\r\n      imageCanvas:[],\r\n      showImageCanvas:true,\r\n      hasAudioSelection:false\r\n    };\r\n    this.previewCanvasRef = React.createRef();\r\n  }\r\n\r\n  handleSliderChange = (event, newValue) => {\r\n\r\n    window.wavesurfer && window.wavesurfer.zoom(newValue*10);\r\n    this.setState({\r\n      zoom:newValue,\r\n      crop:window.crop,\r\n      openEditionNotification:this.state.openEditionNotification\r\n    });\r\n\r\n  };\r\n\r\n  handleShowImageCanvas = (event) => {\r\n\r\n    document.querySelectorAll('canvas.imageCanvas').forEach(e => e.style.display = (event.target.checked)?\"block\":\"none\");\r\n    \r\n    this.setState({\r\n      showImageCanvas:event.target.checked,\r\n    });\r\n\r\n  };\r\n\r\n  handleNewAnnotationTypeChange = (event, newValue) => {\r\n\r\n    var selectParentAnnotationElement = document.getElementById(\"select-parent-annotation\");\r\n    this.setState({\r\n      newAnnotationType:event.target.value,\r\n      parentAnnotationId:selectParentAnnotationElement.selectedOptions[0] && selectParentAnnotationElement.value,\r\n      nextChildRank:selectParentAnnotationElement.selectedOptions[0] && selectParentAnnotationElement.selectedOptions[0].attributes[\"nextChildRank\"].value\r\n    });\r\n    \r\n    //document.querySelectorAll(\"#select-parent-annotation option:not([hidden=''])\")[0].selected=true;\r\n  }\r\n\r\n  handleParentAnnotationChange = (event) => {\r\n    event.target.selectedOptions[0] && this.setState({\r\n      parentAnnotationId:event.target.value,\r\n      nextChildRank: event.target.selectedOptions[0].attributes[\"nextChildRank\"].value\r\n    });\r\n  }\r\n\r\n  handleCloseCreateDrawer = (event) => {\r\n    this.setState({\r\n        annotationPanel: false\r\n      });\r\n    if(this.state.change > 0)\r\n    this.refreshAnnotations();\r\n  };\r\n\r\n  handleCloseCreateDialog = (event) => {\r\n    this.setState({\r\n        openCreateDialog: false,\r\n        newAnnotationType:null,\r\n        parentAnnotationId:null\r\n      });\r\n    window.coordinates = undefined;\r\n  };\r\n\r\n  handleOpenCreateDialog = (event) => {\r\n\r\n    if((window.coordinates === undefined || window.coordinates.length === 0) && !this.state.hasAudioSelection){\r\n      alert(\"shit\");\r\n      return;\r\n    }\r\n    this.refreshParentAnnotationsList();\r\n\r\n    // Autoselection of the right parent annotation\r\n    var that = this;\r\n\r\n    that.setState({\r\n      parentAnnotationId:this.state.parentAnnotations[0].id,\r\n      newAnnotationType:this.state.parentAnnotations[0].childrenType,\r\n      nextChildRank: this.state.parentAnnotations[0].nextChildRank\r\n    });\r\n\r\n    this.state.parentAnnotations.forEach(function(p){\r\n      if((parseFloat(that.state.audioSelection.end) <= parseFloat(p.audioEnd) ) && (parseFloat(that.state.audioSelection.start) >= parseFloat(p.audioStart))){\r\n        that.setState({\r\n          parentAnnotationId:p.id,\r\n          newAnnotationType:p.childrenType,\r\n          nextChildRank: p.nextChildRank\r\n        });\r\n      }\r\n    });\r\n\r\n    this.setState({\r\n      openCreateDialog: true\r\n    });\r\n\r\n  };\r\n\r\n  handleEditionState = (show,type,data) => {\r\n\r\n    var message = (type===\"audio\")\r\n    ?\r\n    \"Editing \"+data.annotationLabel+\" Start: \"+data.start+\"/End: \"+data.end\r\n    :\r\n    \"Editing \"+window.currentAnnotationEdition.annotationLabel+\" Image\";\r\n\r\n    var coordinates = [];\r\n\r\n    window.currentAnnotationEdition.imageCoords.forEach((i) => {\r\n      var areaCoords = i.areaCoords.split(\",\");\r\n      coordinates.push({\r\n        x: parseFloat(areaCoords[0]) / parseFloat(areaCoords[4]),\r\n        y: parseFloat(areaCoords[1]) / parseFloat(areaCoords[4]),\r\n        width: (parseFloat(areaCoords[2]) - parseFloat(areaCoords[0])) / parseFloat(areaCoords[4]),\r\n        height: (parseFloat(areaCoords[3]) - parseFloat(areaCoords[1])) / parseFloat(areaCoords[4]),\r\n      });\r\n\r\n    });\r\n\r\n    this.setState({\r\n      annotationsPanel:false,\r\n      annotationPanel:false,\r\n      openEditionNotification:show,\r\n      editionType:type,\r\n      editionData:data,\r\n      editionNotification:message,\r\n      imageSelection:data,\r\n      coordinates:coordinates,\r\n      showImageCanvas:(type ===\"image\")?false:this.state.showImageCanvas,\r\n    });\r\n  };\r\n\r\n  handleCreateAnnotation = () => {\r\n\r\n    this.setState({\r\n      loading: true,\r\n    });\r\n\r\n    var imageCoords = [];\r\n\r\n    window.imageSelectionData && window.imageSelectionData.forEach((c)=>{\r\n        var coords=[];\r\n        coords.push(c.x*window.imageRatio);\r\n        coords.push(c.y*window.imageRatio);\r\n        coords.push((c.x + c.width)*window.imageRatio);\r\n        coords.push((c.y + c.height)*window.imageRatio);\r\n        coords.push(window.imageRatio);\r\n\r\n        imageCoords.push({\r\n          \"image_id\":c.imageId,\r\n          \"areaCoords\":coords.join(',')\r\n        });\r\n      });\r\n\r\n    var data={\r\n      document_id:this.props.documentId,\r\n      type:this.state.newAnnotationType,\r\n      rank:this.state.nextChildRank,\r\n      parent_id:this.state.parentAnnotationId,\r\n      //image_id:window.imageSelectionData?window.imageSelectionData.image_id:null,\r\n      //areaCoords:window.imageSelectionData?(window.imageSelectionData.x*window.imageRatio)+\",\"+(window.imageSelectionData.y*window.imageRatio)+\",\"+((window.imageSelectionData.x+window.imageSelectionData.width)*window.imageRatio)+\",\"+((window.imageSelectionData.y+window.imageSelectionData.height)*window.imageRatio)+\",\"+window.imageRatio:null,\r\n      imageCoords:imageCoords,\r\n      audioStart:parseFloat(this.state.audioSelection.start),\r\n      audioEnd:parseFloat(this.state.audioSelection.end)\r\n    };\r\n\r\n    (this.state.parentAnnotationId && this.state.parentAnnotationId !== 0) && AnnotationService.create(data).then(\r\n        (response) => {\r\n          \r\n          this.refreshAnnotations();\r\n          this.setState({\r\n            editionData:response.data,\r\n            annotationPanel:true\r\n          });\r\n          \r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          this.setState({\r\n            loading: false,\r\n            message: resMessage\r\n          });\r\n        }\r\n      );\r\n  }\r\n\r\n  updateAnnotation = () => {\r\n    this.setState({\r\n      loading:true\r\n    });\r\n\r\n    this.state.editionType==='audio' && AnnotationService.update(this.state.editionData.annotationId,{audioStart:this.state.editionData.start,audioEnd:this.state.editionData.end}).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n           window.wavesurfer.markers.markers\r\n          .filter((m)=>m.label === this.state.editionData.annotationLabel)\r\n          .forEach((marker,index)=>{window.wavesurfer.markers.remove(index);});\r\n          this.refreshAnnotations();\r\n          this.handleCloseEdition();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n\r\n    //Multi image crops feature\r\n    \r\n    var image_coords = [];\r\n\r\n    // #21 window.imageRatio\r\n    //TODO si multi image\r\n    if(this.state.editionType==='image'){\r\n      \r\n      if(window.currentAnnotationEdition.imageAddition){\r\n        image_coords = window.currentAnnotationEdition.imageCoords;\r\n      }\r\n\r\n      window.currentAnnotationEdition.data.forEach((c)=>{\r\n        var coords=[];\r\n        coords.push(c.x*window.imageRatio);\r\n        coords.push(c.y*window.imageRatio);\r\n        coords.push((c.x + c.width)*window.imageRatio);\r\n        coords.push((c.y + c.height)*window.imageRatio);\r\n        coords.push(window.imageRatio);\r\n\r\n        image_coords.push({\r\n          \"image_id\":c.imageId,\r\n          \"areaCoords\":coords.join(',')\r\n        });\r\n      });\r\n\r\n    }\r\n\r\n    this.state.editionType==='image' && AnnotationService.update(this.state.editionData.annotationId,{imageCoords:image_coords}).then(\r\n      (response) => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n           window.wavesurfer &&  window.wavesurfer.markers.markers\r\n          .filter((m)=>m.label === this.state.editionData.annotationLabel)\r\n          .forEach((marker,index)=>{window.wavesurfer.markers.remove(index);});\r\n          this.refreshAnnotations();\r\n          this.handleCloseEdition();\r\n        },\r\n        error => {\r\n          this.setState({\r\n            loading:false\r\n          });\r\n\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  handleCloseEdition = (event) => {\r\n    this.setState({openEditionNotification:false,editionNotification:\"\",editionData:{}});\r\n    window.currentAnnotationEdition = null;\r\n  }\r\n\r\n      /**\r\n   * Save annotations to localStorage.\r\n   */\r\n   saveRegions() {\r\n      localStorage.regions = JSON.stringify(\r\n          Object.keys(window.wavesurfer.regions.list).map(function(id) {\r\n              let region = window.wavesurfer.regions.list[id];\r\n              return {\r\n                  start: region.start,\r\n                  end: region.end,\r\n                  attributes: region.attributes,\r\n                  data: region.data\r\n              };\r\n          })\r\n      );\r\n  }\r\n\r\n  refreshParentAnnotationsList = () => {\r\n    var list = [];\r\n    var that = this;\r\n\r\n    this.state.annotations.forEach(function(t){\r\n      list.push({\r\n        'id':t.id,\r\n        'label':that.props.documentType,\r\n        'childrenType':that.props.documentType===\"TEXT\"?'S':'W',\r\n        'audioStart':t.audioStart,\r\n        'audioEnd':t.audioEnd\r\n      });\r\n      var nextSentenceRank = 0;\r\n\r\n      t.children_annotations.forEach(function(s){\r\n        list.push({\r\n          'id':s.id,\r\n          'label':((that.props.documentType===\"TEXT\"?'S':'W')+s.rank),\r\n          'childrenType':that.props.documentType===\"TEXT\"?'W':'M',\r\n          'audioStart':s.audioStart,\r\n          'audioEnd':s.audioEnd\r\n        });\r\n        var nextWordRank = 0;\r\n\r\n        s.children_annotations.forEach(function(w){\r\n          list.push({\r\n            'id':w.id,\r\n            'label':('S'+s.rank+'>W'+w.rank),\r\n            'childrenType':'M',\r\n            'audioStart':w.audioStart,\r\n            'audioEnd':w.audioEnd\r\n          });\r\n          var nextMorphemeRank = 0;\r\n\r\n          var w_list = list.filter(a => a.id === w.id)[0];\r\n          w_list.nextChildRank = nextMorphemeRank+1;\r\n\r\n          nextWordRank = (nextWordRank < w.rank) ? (w.rank) : nextWordRank;\r\n        });\r\n\r\n        var s_list = list.filter(a => a.id === s.id)[0];\r\n        s_list.nextChildRank = nextWordRank+1;\r\n\r\n        nextSentenceRank = (nextSentenceRank < s.rank) ? (s.rank) : nextSentenceRank;\r\n      });\r\n\r\n      var t_list = list.filter(a => a.id === t.id)[0];\r\n      t_list.nextChildRank = nextSentenceRank+1;\r\n    });\r\n\r\n\r\n    this.setState({parentAnnotations:list});\r\n  }\r\n\r\n  loadCanvas = (annotation,array) => {\r\n    annotation.imageCoords && annotation.imageCoords.forEach((imageCoord)=>{\r\n      array.push({\r\n        image_id:imageCoord.image_id,\r\n        id:annotation.id,\r\n        type:annotation.type,\r\n        rank:annotation.rank,\r\n        areaCoords:imageCoord.areaCoords,\r\n        hasForm:annotation.forms.length,\r\n        hasTranslation:annotation.translations.length\r\n      });\r\n    });\r\n\r\n    annotation.children_annotations.forEach((a)=>{\r\n      this.loadCanvas(a,array);\r\n    });\r\n\r\n  }\r\n\r\n  convertAnnotationsToTree = (annotation) => {\r\n    return (\r\n      <Tree \r\n        key={annotation.id}\r\n        canHide = {annotation.type !== 'T'}\r\n        content={annotation.forms && annotation.forms.length > 0 && annotation.forms[0].text} \r\n        type={annotation.type === 'T' ? 'Annotations' : (annotation.type+annotation.rank)}\r\n        onClick={() => this.showAnnotation(annotation.id)}\r\n        open={this.props.expanded}\r\n        >\r\n        {\r\n          annotation.children_annotations && annotation.children_annotations.map((children_annotation) => this.convertAnnotationsToTree(children_annotation))\r\n        }\r\n      </Tree>\r\n    );\r\n\r\n  }\r\n\r\n  /**\r\n   * Get all document annotations from database and refresh the page content\r\n   */\r\n  refreshAnnotations = () => {\r\n\r\n    var canvasList = [];\r\n\r\n    AnnotationService.getDocumentAnnotations(this.props.documentId).then(\r\n      (response) => {\r\n          this.setState({\r\n            annotations:response.data.annotations,\r\n            change:0\r\n          });\r\n          this.refreshParentAnnotationsList();\r\n          this.props.refreshDocumentAnnotations(response.data.annotations);\r\n          this.loadRegions(response.data.annotations);\r\n          this.loadCanvas(response.data.annotations[0],canvasList);\r\n          this.setState({\r\n            imageCanvas:canvasList\r\n          });\r\n          window.coordinates = undefined;\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          const resMessage =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n\r\n          alert(resMessage);\r\n        });\r\n  }\r\n\r\n  /**\r\n   * Load regions from localStorage.\r\n   */\r\n   loadRegions(regions) {\r\n      var that = this;\r\n\r\n      //Adapt to the recursive structure of annotation --> children annotations\r\n      window.wavesurfer && regions.forEach(function(region) {\r\n        var annotationLabel = region.id+\"_\"+region.type+region.rank;\r\n        window.wavesurfer.regions.list[region.id] && window.wavesurfer.regions.list[region.id].remove();\r\n             \r\n        if(region.type!==\"T\"){\r\n          window.wavesurfer.addRegion({\r\n              id:region.id,\r\n              start: region.audioStart,\r\n              end: region.audioEnd,\r\n              drag: false,\r\n              resize: false,\r\n              color:\"rgba(0,0,0,0.2)\",\r\n              showTooltip:true,\r\n              attributes: {\r\n                  title: 'Region',\r\n                }\r\n            });\r\n\r\n          window.wavesurfer.markers.markers\r\n          .filter((m)=>m.label === annotationLabel)\r\n          .forEach((marker,index)=>{window.wavesurfer.markers.remove(index);});\r\n\r\n          //window.wavesurfer.markers.remove\r\n          window.wavesurfer.addMarker({\r\n            time: region.audioStart,\r\n            label: annotationLabel,\r\n            color: (region.type===\"S\")?\"red\":\"blue\",\r\n            position: (region.type===\"S\")?\"bottom\":\"top\",\r\n          });\r\n\r\n        }\r\n\r\n        region.children_annotations.length > 0 && that.loadRegions(region.children_annotations);\r\n        \r\n      });\r\n  }\r\n\r\n  showAnnotation = (annotationId) => {\r\n    AnnotationService.get(annotationId).then(\r\n        (response) => {\r\n            this.setState({\r\n              annotationPanel:true,\r\n              selectedAnnotation:response\r\n            });\r\n          },\r\n          error => {\r\n            if(error.response.status===401) this.props.history.push('/login');\r\n            const resMessage =\r\n              (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n\r\n            alert(resMessage);\r\n          });\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n    this.refreshParentAnnotationsList();\r\n\r\n    if(this.props.recording !== null){\r\n      const track = document.querySelector('#track');\r\n      var that = this;\r\n\r\n      window.wavesurfer = WaveSurfer.create({\r\n        /*barWidth: 1,*/\r\n        cursorWidth: 1,\r\n        container: '#waveform',\r\n        progressColor: '#2D5BFF',\r\n        responsive: true,\r\n        waveColor: '#999999',\r\n        cursorColor: 'transparent',\r\n        height: 100,\r\n        pixelRatio: 1,\r\n        scrollParent: true,\r\n        normalize: true,\r\n        minimap: true,\r\n        backend: 'MediaElement',\r\n        plugins: [\r\n              RegionsPlugin.create({\r\n                container: '#wave-regions',\r\n                preventContextMenu: false\r\n              }),\r\n              MinimapPlugin.create({\r\n                height: 30,\r\n                waveColor: '#ddd',\r\n                progressColor: '#999',\r\n                cursorColor: '#999'\r\n              }),\r\n              TimelinePlugin.create({\r\n                container: '#wave-timeline'\r\n              }),\r\n              MarkersPlugin.create({\r\n                markers: []\r\n            })\r\n          ]\r\n      });\r\n\r\n      /* Regions */\r\n\r\n      window.wavesurfer.on('ready', function() {\r\n          window.wavesurfer.enableDragSelection({\r\n              color: \"rbga(0,150,90,0.5)\"\r\n          });\r\n\r\n          //Adapt the annotations props to fit with the Wavesurfer API\r\n          if (that.state.annotations){\r\n            that.state.annotations.forEach((a) => {\r\n              a.start = a.audioStart;\r\n              a.end = a.audioEnd;\r\n              a.data = {};\r\n              a.attributes = {\r\n                label : a.type === 'W' ? a.type+a.rank : ''\r\n              };\r\n\r\n            });\r\n          }\r\n      });\r\n\r\n      window.wavesurfer.on('pause', function() {\r\n         that.setState({playing:false});\r\n\r\n      });\r\n\r\n      window.wavesurfer.on('region-click', function(region, e) {\r\n          that.setState({playing:true});\r\n          e.stopPropagation();\r\n          // Play on click, loop on shift click\r\n          e.shiftKey ? region.playLoop() : region.play();\r\n      });\r\n     // window.wavesurfer.on('region-click', that.editAnnotation);\r\n      window.wavesurfer.on('region-updated', function(region){\r\n          var regions = region.wavesurfer.regions.list;\r\n          var keys = Object.keys(regions).filter((key)=>key.indexOf(\"wavesurfer\")>=0);\r\n\r\n          if(keys.length > 1){\r\n            regions[keys[0]].remove();\r\n          }\r\n\r\n          region.element.style['z-index']=10;\r\n\r\n          window.currentAnnotationEdition && that.handleEditionState(true,\"audio\",{annotationLabel:window.currentAnnotationEdition.label,annotationId:window.currentAnnotationEdition.id,start:region.start.toFixed(2),end:region.end.toFixed(2)});\r\n          \r\n          that.setState({\r\n            audioSelection:{\r\n              start:region.start.toFixed(2),\r\n              end:region.end.toFixed(2)\r\n            },\r\n            hasAudioSelection:true\r\n          });\r\n      });\r\n\r\n      window.wavesurfer.on('region-dblclick', function(region, e){\r\n        window.wavesurfer.pause();\r\n        e.stopPropagation();\r\n      });\r\n\r\n      window.wavesurfer.on('marker-click', function(region, e){\r\n\r\n        that.showAnnotation(region.label.split(\"_\")[0]);\r\n        e.stopPropagation();\r\n      });\r\n\r\n      window.wavesurfer.on('region-play', function(region) {\r\n          region.once('out', function() {\r\n              window.wavesurfer.play(region.start);\r\n              window.wavesurfer.pause();\r\n          });\r\n      });\r\n\r\n      window.wavesurfer.load(track);\r\n    }\r\n\r\n    this.handleSliderChange(100,10);\r\n\r\n    var canvasList = [];\r\n    this.loadCanvas(this.state.annotations[0],canvasList);\r\n    this.setState({imageCanvas:canvasList});\r\n\r\n    window.addEventListener('wheel', (e) => {  \r\n      if(e.target.tagName === 'WAVE' || e.target.tagName === 'REGION'){\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var newValue = this.state.zoom+Math.round(e.deltaY/50);\r\n        if(newValue >= 0 && newValue <= 100) this.handleSliderChange(100,newValue);\r\n\r\n        return false;}\r\n    },{passive: false});\r\n    \r\n  }\r\n\r\n\r\n  handlePlay = () => {\r\n    this.setState({ \r\n      playing: !this.state.playing, \r\n      //crop: window.crop \r\n    });\r\n    window.wavesurfer.playPause();\r\n  };\r\n\r\n  toggleAnnotationsDrawer = (anchor, open) => (event) => {\r\n    if(this.state.change > 0) this.refreshAnnotations();\r\n    this.setState({annotationsPanel: open });\r\n  };\r\n\r\n  toggleImportDrawer = (anchor, open) => (event) => {\r\n    this.setState({importPanel: open });\r\n  };\r\n\r\n  selectionExists = (exist) => {\r\n    this.setState({hasImageSelection:exist});\r\n  }\r\n\r\n  annotationHasChanged = () => {\r\n    this.setState({change:this.state.change+1});\r\n  }\r\n\r\n  render = () => {\r\n\r\n    this.loadRegions(this.state.annotations);\r\n\r\n    var docType = this.props.documentType;\r\n\r\n    function TabPanel(props) {\r\n\r\n      const { children, value, index, id,...other } = props;\r\n\r\n      return (\r\n        <div\r\n          role=\"tabpanel\"\r\n          hidden={value !== index}\r\n          id={`image-tabpanel-${id}`}\r\n          aria-labelledby={`image-tab-${index}`}\r\n          {...other}\r\n        >\r\n          {value === index && (\r\n            <Box div={3}>\r\n              <Typography component=\"div\">{children}</Typography>\r\n            </Box>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const handleChange = (event, newValue) => {\r\n      this.setState({tabValue:newValue});\r\n      window.tabValue = newValue;\r\n    };\r\n\r\n    function a11yProps(index) {\r\n      return {\r\n        id: `image-tab-${index}`,\r\n        'aria-controls': `image-tabpanel-${index}`,\r\n      };\r\n    }\r\n\r\n    var imagesTabs = [];\r\n    var imagesTabContents = [];\r\n\r\n    var that = this;\r\n\r\n    this.props.images.forEach(function(image,index){\r\n\r\n      if(localStorage[\"image\"+image.id]!==undefined){\r\n        localStorage[\"image\"+image.id]=image[\"TO_BASE64(content)\"];\r\n      }else{\r\n        localStorage.setItem(\"image\"+image.id, image[\"TO_BASE64(content)\"]);\r\n      }\r\n\r\n      var imageCanvas = that.state.imageCanvas.filter((area) => area.image_id === image.id);\r\n\r\n\r\n      imagesTabs.push(<Tab label={image.name} {...a11yProps(image.name)} />)\r\n      imagesTabContents.push(\r\n        <TabPanel key={image.id} value={that.state.tabValue} index={index} id={image.id}>\r\n        <ImageMultiSelector\r\n          key={image.id}\r\n          image={image}\r\n          annotations={that.state.annotations}\r\n          canvas={imageCanvas}\r\n          coordinates={that.state.coordinates}\r\n          showAnnotation={that.showAnnotation}\r\n          showImageCanvas={that.state.showImageCanvas}\r\n          selectionExists={that.selectionExists}\r\n          children={0}\r\n        />\r\n\r\n\r\n        \r\n\r\n        </TabPanel>);\r\n    });\r\n\r\n    return (\r\n      <React.Fragment>\r\n        \r\n        {this.props.recording === null ? <Typography>No recording</Typography> : \r\n          <div>\r\n            <IconButton color=\"primary\" aria-label=\"Play\" onClick={this.handlePlay}>\r\n              {!this.state.playing ? <PlayIcon /> : <PauseIcon /> }\r\n            </IconButton>\r\n\r\n            <Grid container spacing={2}>\r\n              <Grid item>\r\n                  <ZoomOut />\r\n              </Grid>\r\n              <Grid item xs>\r\n              <Slider value={this.state.zoom} onChange={this.handleSliderChange} aria-labelledby=\"zoom-slider\" />\r\n              </Grid>\r\n              <Grid item>\r\n                  <ZoomIn />\r\n              </Grid>\r\n            </Grid>\r\n\r\n            <div hidden={this.props.recording === null} >\r\n              <div id=\"wave-timeline\"></div>\r\n              <div id=\"wave-minimap\"></div>\r\n              <div id=\"wave-regions\"></div>\r\n              <div id=\"waveform\">\r\n                <audio id=\"track\" src={\"data:audio/mpeg;base64,\"+this.props.recording[\"TO_BASE64(content)\"]} type=\"audio/mp3\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n\r\n        <span>\r\n          <Chip\r\n            icon={<ImportIcon />}\r\n            label=\"Import Annotations\"\r\n            clickable\r\n            size=\"small\"\r\n            color=\"primary\"\r\n            onClick={this.toggleImportDrawer(this.state.importPanel, true)}\r\n          />\r\n          <Drawer anchor=\"right\" open={this.state.importPanel} onClose={this.toggleImportDrawer(this.state.importPanel, false)}>\r\n            <div\r\n              role=\"presentation\"\r\n            >\r\n            <DocumentAnnotationsImport \r\n              documentId={this.props.documentId} \r\n              refreshAnnotations={this.refreshAnnotations} \r\n             />\r\n            </div>\r\n          </Drawer>\r\n        </span>\r\n\r\n        <span>\r\n\r\n            <Chip\r\n              icon={<AddIcon />}\r\n              label=\"Create Annotation\"\r\n              clickable\r\n              size=\"small\"\r\n              color=\"primary\"\r\n              onClick={this.handleOpenCreateDialog}\r\n            />\r\n\r\n          <Drawer anchor=\"bottom\" open={this.state.annotationPanel} onClose={this.handleCloseCreateDrawer}>\r\n            <div\r\n              role=\"presentation\"\r\n            >\r\n              <DocumentAnnotation \r\n                data={this.state.selectedAnnotation}\r\n                documentType={docType}\r\n                refreshAnnotations={this.refreshAnnotations}\r\n                handleEditionState={this.handleEditionState}\r\n                parentAnnotations={this.state.parentAnnotations}\r\n                available_lang={this.props.available_lang}\r\n                available_kindOf={this.props.available_kindOf}\r\n                annotationHasChanged={this.annotationHasChanged}\r\n                onClose={this.handleCloseCreateDrawer}\r\n              />\r\n            </div>\r\n          </Drawer>\r\n        </span>\r\n        \r\n\r\n        \r\n\r\n        {this.convertAnnotationsToTree(this.state.annotations[0])}\r\n\r\n        {this.props.images.length > 0 ? \r\n          (\r\n            <div>\r\n              <AppBar position=\"static\">\r\n                <Tabs value={this.state.tabValue} onChange={handleChange} aria-label=\"simple tabs example\">\r\n                  {imagesTabs}\r\n                </Tabs>\r\n               </AppBar>\r\n               <FormControlLabel\r\n                  control={<Switch checked={this.state.showImageCanvas} onChange={this.handleShowImageCanvas} name=\"showImageCanvas\" />}\r\n                  label=\"Show image selections\"\r\n                />\r\n              {imagesTabContents}\r\n            </div>\r\n          )\r\n        :\r\n        <Typography>No image</Typography> \r\n      }\r\n        \r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'left',\r\n          }}\r\n          open={this.state.openEditionNotification}\r\n          autoHideDuration={null}\r\n          message={this.state.editionNotification}\r\n          action={\r\n            <React.Fragment>\r\n            {this.state.loading ?\r\n              <CircularProgress />\r\n              :\r\n              <Button color=\"secondary\" size=\"small\" onClick={this.updateAnnotation}>\r\n                Update\r\n              </Button>\r\n            }\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={this.handleCloseEdition}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n\r\n        <Dialog open={this.state.openCreateDialog} onClose={this.handleCloseCreateDialog} aria-labelledby=\"form-createdialog-title\">\r\n            <DialogTitle id=\"form-createdialog-title\">Create annotation</DialogTitle>\r\n            <DialogContent>\r\n              <DialogContentText>\r\n                <FormControl component=\"fieldset\">\r\n                  <FormLabel component=\"legend\">Level</FormLabel>\r\n                  <RadioGroup \r\n                    row\r\n                    aria-label=\"position\"\r\n                    name=\"newAnnotationType\"\r\n                    onChange={this.handleNewAnnotationTypeChange}\r\n                    value={this.state.newAnnotationType}\r\n                  >\r\n                    {this.props.documentType === \"TEXT\" && <FormControlLabel\r\n                      value=\"S\"\r\n                      control={<Radio color=\"primary\" />}\r\n                      label=\"Sentence\"\r\n                      labelPlacement=\"top\"\r\n                    />}\r\n                    <FormControlLabel\r\n                      value=\"W\"\r\n                      control={<Radio color=\"primary\" />}\r\n                      label=\"Word\"\r\n                      labelPlacement=\"top\"\r\n                    />\r\n                    <FormControlLabel\r\n                      value=\"M\"\r\n                      control={<Radio color=\"primary\" />}\r\n                      label=\"Morpheme\"\r\n                      labelPlacement=\"top\"\r\n                    />\r\n                  </RadioGroup>\r\n                </FormControl>\r\n                <FormControl>\r\n                  <InputLabel shrink htmlFor=\"select-multiple-native\">\r\n                    Parent annotation\r\n                  </InputLabel>\r\n                  <Select\r\n                    native\r\n                    value={this.state.parentAnnotationId}\r\n                    onChange={this.handleParentAnnotationChange}\r\n                    inputProps={{\r\n                      id: 'select-parent-annotation',\r\n                    }}\r\n                  >\r\n                    {this.state.parentAnnotations.map((a) => (\r\n                      <option\r\n                        key={a.id}\r\n                        value={a.id}\r\n                        childrenType={a.childrenType}\r\n                        nextChildRank={a.nextChildRank}\r\n                        disabled={this.state.newAnnotationType!==a.childrenType}\r\n                        hidden={this.state.newAnnotationType!==a.childrenType}\r\n                        audioStart={a.audioStart}\r\n                        audioEnd={a.audioEnd}\r\n                        selected={this.state.newAnnotationType===a.childrenType && a.audioStart<=this.state.audioSelection.start && a.audioEnd>=this.state.audioSelection.end}\r\n                        >\r\n                        {a.label}\r\n                      </option>\r\n                    ))}\r\n\r\n                  </Select>\r\n                </FormControl>\r\n\r\n              </DialogContentText>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={this.handleCloseCreateDialog} color=\"primary\">\r\n                Cancel\r\n              </Button>\r\n              {!this.state.loading && (this.state.parentAnnotationId>0) && (this.state.newAnnotationType) && <Button onClick={this.handleCreateAnnotation} color=\"primary\">\r\n                Create annotation\r\n              </Button>\r\n              }\r\n              {this.state.loading && <CircularProgress />}\r\n            </DialogActions>\r\n          </Dialog>\r\n          <div style={{minHeight:\"90px\"}}></div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n};\r\n\r\nexport default withRouter(DocumentAnnotations);","import React, { Component } from \"react\";\r\nimport AuthService from \"../services/auth.service\";\r\nimport DocumentService from \"../services/document.service\";\r\nimport { Container, AppBar, Tabs, Tab, Typography, Box } from '@material-ui/core';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport DocumentDescription from \"./document.description.component\";\r\nimport DocumentResources from \"./document.resources.component\";\r\nimport DocumentAnnotations from \"./document.annotations.component\";\r\nimport DocumentPreview from \"./document.preview.component\";\r\nimport DocumentExport from \"./document.export.component\";\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nvar displayOptions = {};\r\n\r\ndisplayOptions = {\r\n  textTranscriptions : [],\r\n  textTranslations : [],\r\n  sentenceTranscriptions : [],\r\n  sentenceTranslations : [],\r\n  wordTranscriptions : [],\r\n  wordTranslations : [],\r\n  morphemeTranscriptions : [],\r\n  morphemeTranslations :[],\r\n  notes : [],\r\n  lang : \"fr\",\r\n  mode : \"normal\",\r\n  continuousPlay : true,\r\n};\r\n\r\nclass Document extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentUser: AuthService.getCurrentUser(),\r\n      currentDocument: {},\r\n      value:0,\r\n      loading: true,\r\n      expanded:false\r\n    }\r\n  }\r\n\r\n  getUrlParameter (sVar) {\r\n    return unescape(window.location.search.replace(new RegExp(\"^(?:.*[&\\\\?]\" + escape(sVar).replace(/[\\.\\+\\*]/g, \"\\\\$&\") + \"(?:\\\\=([^&]*))?)?.*$\", \"i\"), \"$1\"));\r\n  }\r\n\r\n  buildUrl(){\r\n      var params = new URLSearchParams(window.location.search);\r\n      params.set('tab',this.state.value);\r\n      params.set('expanded',this.state.expanded);\r\n      var newUrl = window.location.protocol + \"//\" + window.location.host + window.location.pathname + \"?\" + params.toString();\r\n      window.history.pushState('test','',newUrl);\r\n  }\r\n\r\n  parseTypeOf(annotation,typeOf){\r\n    var types = {\r\n      'T':'text',\r\n      'S':'sentence',\r\n      'W':'word',\r\n      'M':'morpheme'\r\n    };\r\n\r\n    annotation.forms.forEach((f)=>{\r\n      !typeOf[types[annotation.type]].transcriptions.includes(f.kindOf) && typeOf[types[annotation.type]].transcriptions.push(f.kindOf);\r\n    });\r\n\r\n    annotation.translations.forEach((t)=>{\r\n      !typeOf[types[annotation.type]].translations.includes(t.lang) && typeOf[types[annotation.type]].translations.push(t.lang);\r\n    });\r\n\r\n    annotation.children_annotations.forEach((a)=>{\r\n      this.parseTypeOf(a,typeOf);\r\n    });\r\n\r\n    return typeOf;\r\n  }\r\n\r\n  refreshDocument = () => {\r\n    var tabId = parseInt(this.getUrlParameter(\"tab\"));\r\n    var expanded = this.getUrlParameter(\"expanded\");\r\n\r\n    this.setState({loading:true});\r\n\r\n      for (var i = 0; i < localStorage.length; i++) {\r\n        if(localStorage.key(i).indexOf('image')===0) localStorage.removeItem(localStorage.key(i));\r\n      }\r\n\r\n      DocumentService.get(this.props.match.params.docId).then(\r\n        response => {\r\n          if(typeof response === 'object'){\r\n\r\n            var typeOf = {};\r\n            typeOf.text = {}; typeOf.text.transcriptions = []; typeOf.text.translations = [];\r\n            typeOf.sentence = {}; typeOf.sentence.transcriptions = []; typeOf.sentence.translations = [];\r\n            typeOf.word = {}; typeOf.word.transcriptions = []; typeOf.word.translations = [];\r\n            typeOf.morpheme = {}; typeOf.morpheme.transcriptions = []; typeOf.morpheme.translations = [];\r\n            typeOf.note = {}; typeOf.note.translations = [];\r\n\r\n            this.parseTypeOf(response.annotations[0],typeOf);\r\n\r\n            response.typeOf = typeOf;\r\n\r\n            this.setState({\r\n              currentDocument:response,\r\n              typeOf:typeOf,\r\n              loading:false,\r\n              value:tabId,\r\n              expanded:(expanded==='true')\r\n            });\r\n\r\n          }\r\n\r\n        },\r\n        error => {\r\n          if(error.response.status===401) this.props.history.push('/login');\r\n          this.setState({\r\n            currentDocument:\r\n              (error.response && error.response.data) ||\r\n              error.message ||\r\n              error.toString(),\r\n              loading:false\r\n          });\r\n        }\r\n      );\r\n  }\r\n\r\n  refreshDocumentAnnotations = (annotations) => {\r\n    var currentDocument = this.state.currentDocument;\r\n    currentDocument.annotations = annotations;\r\n\r\n    var typeOf = {};\r\n    typeOf.text = {}; typeOf.text.transcriptions = []; typeOf.text.translations = [];\r\n    typeOf.sentence = {}; typeOf.sentence.transcriptions = []; typeOf.sentence.translations = [];\r\n    typeOf.word = {}; typeOf.word.transcriptions = []; typeOf.word.translations = [];\r\n    typeOf.morpheme = {}; typeOf.morpheme.transcriptions = []; typeOf.morpheme.translations = [];\r\n    typeOf.note = {}; typeOf.note.translations = [];\r\n\r\n    this.parseTypeOf(annotations[0],typeOf);\r\n\r\n    currentDocument.typeOf = typeOf;\r\n\r\n    this.setState({\r\n      currentDocument: currentDocument\r\n    });\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.refreshDocument();\r\n  }\r\n\r\n  \r\n  render() {\r\n\r\n    function TabPanel(props) {\r\n\r\n      const { children, value, index, ...other } = props;\r\n\r\n      return (\r\n        <div\r\n          role=\"tabpanel\"\r\n          hidden={value !== index}\r\n          id={`simple-tabpanel-${index}`}\r\n          aria-labelledby={`simple-tab-${index}`}\r\n          {...other}\r\n        >\r\n          {value === index && (\r\n            <Box div={3}>\r\n              <Typography component=\"div\">{children}</Typography>\r\n            </Box>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const handleChangeTab = (event, newValue) => {\r\n      this.setState({value:newValue}, function() {this.buildUrl();});\r\n    };\r\n\r\n    function a11yProps(index) {\r\n      return {\r\n        id: `simple-tab-${index}`,\r\n        'aria-controls': `simple-tabpanel-${index}`,\r\n      };\r\n    }\r\n\r\n    return (\r\n      \r\n      <Container>\r\n        {this.state.loading && <CircularProgress />}\r\n          {!this.state.loading && <AppBar position=\"static\">\r\n            <Tabs value={this.state.value} onChange={handleChangeTab} aria-label=\"tabs\">\r\n              <Tab label=\"Description\" {...a11yProps(0)} />\r\n              <Tab label=\"Resources\" {...a11yProps(1)} />\r\n              <Tab label=\"Annotations\" {...a11yProps(2)} />\r\n              <Tab label=\"Preview\" {...a11yProps(3)} />\r\n              <Tab label=\"Export\" {...a11yProps(4)} />\r\n            </Tabs>\r\n          </AppBar>}\r\n          {!this.state.loading && <TabPanel value={this.state.value} index={0}>\r\n            <DocumentDescription \r\n              document={this.state.currentDocument} \r\n            />\r\n          </TabPanel>}\r\n          <TabPanel value={this.state.value} index={1}>\r\n            <DocumentResources \r\n              documentId={this.state.currentDocument.id} \r\n              recording={this.state.currentDocument.recording} \r\n              images={this.state.currentDocument.images} \r\n            />\r\n          </TabPanel>\r\n          <TabPanel value={this.state.value} index={2}>\r\n            <DocumentAnnotations \r\n              documentId={this.state.currentDocument.id} \r\n              documentType={this.state.currentDocument.type} \r\n              recording={this.state.currentDocument.recording} \r\n              images={this.state.currentDocument.images} \r\n              annotations={this.state.currentDocument.annotations}\r\n              available_kindOf={this.state.currentDocument.available_kindOf}\r\n              available_lang={this.state.currentDocument.available_lang}\r\n              refreshDocumentAnnotations={this.refreshDocumentAnnotations}\r\n              expanded={this.state.expanded}\r\n            />\r\n          </TabPanel>\r\n          <TabPanel value={this.state.value} index={3}>\r\n            <DocumentPreview  \r\n              documentId={this.state.currentDocument.id} \r\n              documentType={this.state.currentDocument.type} \r\n              recording={this.state.currentDocument.recording} \r\n              images={this.state.currentDocument.images} \r\n              annotations={this.state.currentDocument.annotations}\r\n              typeOf={this.state.currentDocument.typeOf}\r\n              displayOptions={displayOptions}\r\n            />\r\n          </TabPanel>\r\n          <TabPanel value={this.state.value} index={4}>\r\n            <DocumentExport\r\n              annotations={this.state.currentDocument.annotations}\r\n             />\r\n          </TabPanel>\r\n      </Container>\r\n    \r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Document);","import React from 'react';\r\nimport { FormGroup, FormControlLabel, FormLabel, Checkbox, Divider  } from '@material-ui/core';\r\nimport { Translate } from 'react-translated';\r\n\r\nclass DisplayOptions extends React.Component {\r\n\r\n  constructor(props) {\r\n    \r\n    super(props);\r\n\r\n    this.state = {\r\n        //#41 words : this.props.displayOptions.words,\r\n        textTranscriptions: (this.props.displayOptions.textTranscriptions.length > 0) ? this.props.displayOptions.textTranscriptions:[],\r\n        textTranslations: (this.props.displayOptions.textTranslations.length > 0) ? this.props.displayOptions.textTranslations:[],\r\n        sentenceTranscriptions: (this.props.displayOptions.sentenceTranscriptions.length > 0) ? this.props.displayOptions.sentenceTranscriptions:[this.props.options.sentence.transcriptions[0]],\r\n        sentenceTranslations: (this.props.displayOptions.sentenceTranslations.length > 0) ? this.props.displayOptions.sentenceTranslations:[this.props.options.sentence.translations[0]],\r\n        wordTranscriptions: (this.props.displayOptions.wordTranscriptions.length > 0) ? this.props.displayOptions.wordTranscriptions:[],\r\n        wordTranslations: (this.props.displayOptions.wordTranslations.length > 0) ? this.props.displayOptions.wordTranslations:[],\r\n        morphemeTranscriptions: (this.props.displayOptions.morphemeTranscriptions.length > 0) ? this.props.displayOptions.morphemeTranscriptions:[],\r\n        morphemeTranslations: (this.props.displayOptions.morphemeTranslations.length > 0) ? this.props.displayOptions.morphemeTranslations:[],\r\n        displayNotes: this.props.displayOptions.notes,\r\n        lang:this.props.displayOptions.lang,\r\n        mode:this.props.displayOptions.mode,\r\n        continuousPlay:this.props.displayOptions.continuousPlay,\r\n    };\r\n\r\n  }\r\n\r\n\r\n  buildUrl(){\r\n\r\n  }\r\n\r\n\r\n  handleTranscriptionOptions(event){\r\n\r\n    console.log(event.target.name);\r\n    console.log(this.props.options);\r\n    if(event.target.name.length >0 ){\r\n      var inputName = event.target.name.split('-');\r\n      var s = [inputName[0]]+\"Transcriptions\";\r\n      var checkedTranscriptions = this.state[[inputName[0]]+\"Transcriptions\"];\r\n      \r\n      console.log(s);\r\n\r\n      //transName is used because some kindOf or Translation type can contain \"-\" character\r\n      var transName = event.target.name.split(inputName[0]+'-');\r\n\r\n      const index = checkedTranscriptions.indexOf(transName[1]);\r\n\r\n      if (index > -1) {\r\n        //if the transcription is disabled\r\n        checkedTranscriptions.splice(index, 1);\r\n        console.log(checkedTranscriptions);\r\n\r\n        document.querySelectorAll('.transcription.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display='none';\r\n          });\r\n\r\n      }else{\r\n        checkedTranscriptions.push(transName[1]);\r\n        var isWordList = this.props.isWordList;\r\n        document.querySelectorAll('.transcription.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display=(isWordList)?'table-cell':'block';\r\n          });\r\n      }\r\n\r\n/////////////////////\r\n      this.setState({\r\n        [inputName[0]+'Transcriptions']: checkedTranscriptions\r\n      },this.buildUrl());\r\n\r\n      console.log(this.props.options);\r\n\r\n    }\r\n    \r\n  }\r\n\r\n  handleTranslationOptions(event){\r\n    if(event.target.name.length >0 ){\r\n      var inputName = event.target.name.split('-');\r\n      var checkedTranslations = this.state[[inputName[0]]+\"Translations\"];\r\n\r\n\r\n      var transName = event.target.name.split(inputName[0]+'-');\r\n\r\n      \r\n      const index = checkedTranslations.indexOf(transName[1]);\r\n      if (index > -1) {\r\n        checkedTranslations.splice(index, 1);\r\n        document.querySelectorAll('.translation.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display='none';\r\n\r\n          });\r\n      }else{\r\n        checkedTranslations.push(transName[1]);\r\n        var isWordList = this.props.isWordList;\r\n        document.querySelectorAll('.translation.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display=(isWordList)?'table-cell':'block';\r\n          });\r\n      }\r\n\r\n      this.setState({[inputName[0]+'Translations']: checkedTranslations},this.buildUrl());\r\n\r\n    }\r\n    \r\n  }\r\n\r\n  handleNotesOptions(event){\r\n    if(event.target.name.length >0 ){\r\n      var checkedNotes = this.state.displayNotes;\r\n\r\n      const index = checkedNotes.indexOf(event.target.name);\r\n      if (index > -1) {\r\n        checkedNotes.splice(index, 1);\r\n        document.querySelectorAll('.note.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display='none';\r\n          });\r\n      }else{\r\n        checkedNotes.push(event.target.name);\r\n        document.querySelectorAll('.note.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display='block';\r\n          });\r\n        document.querySelectorAll('sup.note.'+event.target.name).forEach(\r\n          function(e){\r\n            e.style.display='inline-block';\r\n          });\r\n      }\r\n\r\n      this.setState({displayNotes: checkedNotes},this.buildUrl());\r\n\r\n    }\r\n    \r\n  }\r\n\r\n  handleCheck(event){\r\n    if(event.target.name.length >0 ){\r\n\r\n      this.setState({[event.target.name]: event.target.checked},this.buildUrl());\r\n\r\n    }\r\n    \r\n  }\r\n\r\n  render() {\r\n    this.buildUrl();\r\n\r\n    return (\r\n      <div>\r\n        <h2><Translate text='Display options'/></h2>\r\n        \r\n        <FormGroup row>\r\n          <div className=\"optionContinuousPlay\" hidden={this.state.continuousPlay.length===0}>\r\n            <FormControlLabel \r\n              key={\"continuousPlay\"} \r\n              labelPlacement=\"start\"\r\n              control={<Checkbox checked={this.state.continuousPlay===true} onChange={this.handleCheck.bind(this)} name=\"continuousPlay\" />}\r\n              label={<Translate text='Continuous play'/>}\r\n            />\r\n          </div>\r\n        </FormGroup>\r\n\r\n        <Divider></Divider>\r\n        \r\n        <FormGroup row>\r\n        \r\n        <div className=\"optionTransc\" hidden={this.props.options.text.transcriptions.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Text transcription'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.text.transcriptions.map(transc => (\r\n            <FormControlLabel key={\"textTranscription\"+transc}\r\n              control={<Checkbox checked={this.state.textTranscriptions.includes(transc)} onChange={this.handleTranscriptionOptions.bind(this)} name={\"text-\"+transc} />}\r\n              label={transc}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransl\" hidden={this.props.options.text.translations.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Text translation'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.text.translations.map(transl => (\r\n            <FormControlLabel key={\"textTranslation\"+transl}\r\n              control={<Checkbox checked={this.state.textTranslations.includes(transl)} onChange={this.handleTranslationOptions.bind(this)} name={\"text-\"+transl} />}\r\n              label={transl}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransc\" hidden={this.props.options.sentence.transcriptions.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Sentence transcription'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.sentence.transcriptions.map(transc => (\r\n            <FormControlLabel key={\"sentenceTranscription\"+transc}\r\n              control={<Checkbox checked={this.state.sentenceTranscriptions.includes(transc)} onChange={this.handleTranscriptionOptions.bind(this)} name={\"sentence-\"+transc} />}\r\n              label={transc}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransl\" hidden={this.props.options.sentence.translations.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Sentence translation'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.sentence.translations.map(transl => (\r\n            <FormControlLabel key={\"textTranslation\"+transl}\r\n              control={<Checkbox checked={this.state.sentenceTranslations.includes(transl)} onChange={this.handleTranslationOptions.bind(this)} name={\"sentence-\"+transl} />}\r\n              label={transl}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransc\" hidden={this.props.options.word.transcriptions.length===0} >\r\n          <FormLabel component=\"legend\"><Translate text='Word transcription'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.word.transcriptions.map(transc => (\r\n            <FormControlLabel key={\"wordTranscription\"+transc}\r\n              control={<Checkbox checked={this.state.wordTranscriptions.includes(transc)} onChange={this.handleTranscriptionOptions.bind(this)} name={\"word-\"+transc} />}\r\n              label={transc}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransl\" hidden={this.props.options.word.translations.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Word translation'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.word.translations.map(transl => (\r\n            <FormControlLabel key={\"wordTranslation\"+transl}\r\n              control={<Checkbox checked={this.state.wordTranslations.includes(transl)} onChange={this.handleTranslationOptions.bind(this)} name={\"word-\"+transl} />}\r\n              label={transl}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransc\" hidden={this.props.options.morpheme.transcriptions.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Morpheme transcription'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.morpheme.transcriptions.map(transc => (\r\n            <FormControlLabel key={\"morphemeTranscription\"+transc}\r\n              control={<Checkbox checked={this.state.morphemeTranscriptions.includes(transc)} onChange={this.handleTranscriptionOptions.bind(this)} name={\"morpheme-\"+transc} />}\r\n              label={transc}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        <div className=\"optionTransl\" hidden={this.props.options.morpheme.translations.length===0}>\r\n          <FormLabel component=\"legend\"><Translate text='Morpheme translation'/></FormLabel>\r\n          <FormGroup>\r\n          {this.props.options.morpheme.translations.map(transl => (\r\n            <FormControlLabel key={\"morphemeTranslation\"+transl}\r\n              control={<Checkbox checked={this.state.morphemeTranslations.includes(transl)} onChange={this.handleTranslationOptions.bind(this)} name={\"morpheme-\"+transl} />}\r\n              label={transl}\r\n            />\r\n          ))}\r\n          </FormGroup>\r\n        </div>                  \r\n\r\n        <div className=\"optionNotes\" hidden={this.props.options.note.translations.length===0}>\r\n          <FormLabel component=\"legend\">Notes</FormLabel>\r\n          <FormGroup>\r\n            {this.props.options.note.translations.map(nl => (\r\n              <FormControlLabel key={\"note\"+nl}\r\n                control={<Checkbox checked={this.state.displayNotes.includes(nl)} onChange={this.handleNotesOptions.bind(this)} name={nl} />}\r\n                label={nl}\r\n              />\r\n            ))}\r\n          </FormGroup>\r\n        </div>\r\n\r\n        </FormGroup>\r\n\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DisplayOptions;","import React from 'react';\r\n\r\n\r\nclass Player extends React.Component {\r\n\r\n    componentDidMount() {\r\n\r\n\t    const s = document.createElement('script');\r\n\t    \r\n\t    s.type = 'text/javascript';\r\n\r\n\t    var scriptStr = \"var wordidList=[];var startTimeList=[];var endTimeList=[];var timeList=[];\"\r\n\t\tscriptStr +=\"document.getElementById('player').ontimeupdate=function(){updatePosition(this.currentTime)};\";\r\n\r\n\t    s.innerHTML = scriptStr;\r\n\t    this.instance.appendChild(s);\r\n\r\n\t    //Mise en lumire du mot sur l'image\r\n\t    window.highlight=function highlight(id,type){\r\n\r\n\t      if(type!==\"S\"){\r\n\r\n\t        document.querySelectorAll('canvas:not([wordid=\"\"]').forEach(e => { \r\n\t                  e.style.border='none'; \r\n\t                });\r\n\t        document.querySelectorAll('[wordid=\"'+id+'\"]').forEach(e => { \r\n\t                  e.style.border='solid'; \r\n\t                });\r\n\r\n\t        document.querySelectorAll('.WORD').forEach(e => { \r\n\t                  e.style.border='none'; \r\n\t                });\r\n\r\n\t        document.querySelector('#'+id).style.border='solid';\r\n\t      }\r\n\r\n\t    };\r\n\r\n\r\n\t    window.updatePosition=function updatePosition(time){\r\n\r\n\t\t    var t = window.timeList.find((e)=>(e.start < time && e.end > time));\r\n\r\n\t\t    if(t !== undefined){\r\n\t\t    \tvar currentAnchor = (!window.isWordList)?t.sentence:t.word;\r\n\r\n\t            if(window.currentSentence !== currentAnchor){ \r\n\t              if(window.currentSentence !== undefined) \r\n\t                document.getElementById(window.currentSentence).classList.remove(\"currentSentence\");\r\n\t              \r\n\t              if(currentAnchor){\r\n\t                document.getElementById(currentAnchor).classList.add(\"currentSentence\");\r\n\t                window.currentSentence = currentAnchor;\r\n\t                let event = new Event(\"sentence-changed\");\r\n\t                document.dispatchEvent(event);\r\n\t                //window.scrollTo(0,document.getElementById(currentAnchor).offsetTop - 150);\r\n\t                document.getElementById(currentAnchor).scrollIntoView({block: \"center\"});\r\n\t              }\r\n\t            }\r\n\t\t    }\r\n\r\n\t\t    var w = window.timeList.find((e)=>(e.start < time && e.end > time && e.type !== \"S\"));\r\n\t\t    \r\n\t            if((w !== undefined) && !window.isWordList){\r\n\t                //console.log(\"highlight\");\r\n\t              \twindow.highlight(w.morpheme ?? w.word,w.type);  \r\n\t         }\r\n\r\n\t\t};\r\n\r\n\t\tthis.props.playerIsLoaded();\r\n\t}\r\n\t\r\n  render(){\r\n    const audioStyle = {\r\n          'width': '80%',\r\n        };\r\n    var mediaElement;\r\n\r\n\r\n    if(this.props.file.type === \"audio\"){\r\n      mediaElement = <audio ref={audio => (this.audio = audio)} id=\"player\" controls preload='auto' style={audioStyle}>\r\n          <source src={\"data:audio/mpeg;base64,\"+this.props.file.content} type=\"audio/mpeg\" />\r\n          <track label=\"Transcription & Translation\" id=\"test\" />\r\n          <track label=\"Transcription\" id=\"trackTranscription\" />\r\n          <track label=\"Translation\" id=\"trackTranslation\" />\r\n          \r\n\r\n        Your browser does not support the\r\n            <code>audio</code> element.</audio>;\r\n    }else{\r\n      mediaElement = <video ref={video => (this.video = video)} id=\"player\" controls preload='auto' style={audioStyle}>\r\n          <source src={this.props.file.url} type=\"video/mp4\" />\r\n          <track label=\"Transcription & Translation\" id=\"test\" />\r\n          <track label=\"Transcription\" id=\"trackTranscription\" />\r\n          <track label=\"Translation\" id=\"trackTranslation\" />\r\n          \r\n           \r\n        Your browser does not support the\r\n            <code>video</code> element.</video>;\r\n    }\r\n    return (\r\n      <div ref={el => (this.instance = el)}>\r\n        {mediaElement}\r\n      </div>\r\n        \r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default Player;","import React from 'react';\r\n\r\nclass Picture extends React.Component {\r\n\r\n  componentDidMount(){\r\n    document.querySelectorAll('.pictureBlock canvas').forEach(c=>{\r\n      c.onmouseover=function(){\r\n        window.highlight && window.highlight(this.attributes.wordid.nodeValue,\"W\");\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n        //var url_image = this.props.imageSrc;\r\n\r\n        var images = [];\r\n        var that = this;\r\n        var canvas = [];\r\n\r\n\r\n        this.props.canvas && this.props.canvas.forEach((canva)=>{\r\n          if(!canvas[canva.props.image]) canvas[canva.props.image]=[];\r\n          canvas[canva.props.image].push(canva);\r\n        });\r\n\r\n        //ici il s'agit des zones image de la sentence\r\n        this.props.area && this.props.area.forEach((a)=>{\r\n            \r\n            var coords = a.coords.split(',');\r\n            var image_scope = coords[3]-coords[1];\r\n            var image_width = coords[2]-coords[0];\r\n            //var image_bottom = 0;\r\n            //var image_bottom = parseInt(coords[1]); \r\n            var usemap =\"#map_\" + this.props.sentenceId;\r\n\r\n           var delta_x = coords[0];\r\n           var delta_y = coords[1];\r\n           \r\n           var cssBGPosition = '-' + delta_x + 'px -' + delta_y + 'px';    \r\n           //var cssBG ='url('+url_image+') -' + delta_x + 'px -' + delta_y + 'px';\r\n           \r\n            //const wordsAreas = [];\r\n            const imgStyle = {\r\n              'background-position': cssBGPosition,\r\n              'width': image_width + 'px',\r\n              'height': image_scope + 'px',\r\n              'padding': '0px',\r\n              'border': '0px',\r\n              'object-fit': 'none',\r\n              'object-position':cssBGPosition,\r\n              'max-width' : 'inherit !important',\r\n              //'position': 'absolute'\r\n            };\r\n\r\n            const imageBlock = () => {\r\n              return (\r\n                <div style={{position:'relative',textAlign:'initial'}}>\r\n                  <img \r\n                    alt={a.image} \r\n                    src={\"data:image/png;base64,\"+localStorage[a.image]} \r\n                    style={imgStyle} \r\n                    width={image_width} \r\n                    height={image_scope} \r\n                    usemap={usemap} \r\n                  />\r\n                  {canvas[a.image]}\r\n                </div>\r\n              )\r\n\r\n            }\r\n              ;\r\n\r\n            images.push(imageBlock());\r\n\r\n        });\r\n\r\n        \r\n            /*\r\n                    var coords = this.props.area.coords.split(',');\r\n\r\n                    var image_scope = coords[3]-coords[1];\r\n                    var image_width = coords[2]-coords[0];\r\n                    //var image_bottom = 0;\r\n                    //var image_bottom = parseInt(coords[1]); \r\n                    var usemap =\"#map_\" + this.props.sentenceId;\r\n\r\n                   var delta_x = coords[0];\r\n                   var delta_y = coords[1];\r\n                   \r\n                   var cssBGPosition = '-' + delta_x + 'px -' + delta_y + 'px';    \r\n                   //var cssBG ='url('+url_image+') -' + delta_x + 'px -' + delta_y + 'px';\r\n                   \r\n                    //const wordsAreas = [];\r\n                    const imgStyle = {\r\n                      'background-position': cssBGPosition,\r\n                      'width': image_width + 'px',\r\n                      'height': image_scope + 'px',\r\n                      'padding': '0px',\r\n                      'border': '0px',\r\n                      'object-fit': 'none',\r\n                      'object-position':cssBGPosition,\r\n                      'max-width' : 'inherit !important'\r\n                    };\r\n            */\r\n\r\n    return (\r\n          <div class=\"pictureBlock\" sentenceId={this.props.sentenceId}>\r\n              \r\n               {images}\r\n\r\n          </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Picture;","import React from 'react';\r\n\r\nclass Note extends React.Component {\r\n\r\n  render() {\r\n\r\n    return (\r\n          <div class={`note ${this.props.lang}`} hidden={this.props.hidden} >\r\n          <span class='circle'>\r\n            {this.props.id}\r\n          </span>\r\n          {this.props.note}\r\n          </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Note;","import React from 'react';\r\nimport {Typography} from '@material-ui/core';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport { PlayArrow, Pause } from '@material-ui/icons';\r\nimport Note from './Note';\r\n\r\n\r\nclass Morpheme extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t      anchorEl: null,\r\n          open: false\r\n\t    };\r\n      this.idNote = this.props.idNote - 1 ?? 1;\r\n\t}\r\n\r\n  playSentence(){\r\n    document.getElementById('player').currentTime = this.props.w.AUDIO.start;\r\n    document.getElementById('player').play();\r\n  }\r\n\r\n  pauseSentence(){\r\n    document.getElementById('player').pause();\r\n  }\r\n\r\n  handleClick = (event) => {\r\n    //console.log(event.currentTarget);\r\n    this.setState({\r\n      anchorEl: event.currentTarget,\r\n      open: true\r\n    });\r\n\r\n    if(event.currentTarget.id.length>0){\r\n      document.querySelectorAll('canvas').forEach((c)=>c.style.border=\"none\");\r\n      document.querySelector('[wordid=\"'+event.currentTarget.id+'\"]').style.border='solid';\r\n    }\r\n      };\r\n\r\n  handleClose = () => {\r\n    this.setState({\r\n      anchorEl: null,\r\n      open: false\r\n    });\r\n    document.querySelectorAll('canvas').forEach((c)=>c.style.border=\"none\");\r\n  };\r\n\r\n  getNotes(node,notesJSON){\r\n    if(node.NOTE !== undefined && node.NOTE !== null){\r\n      if(node.NOTE.length === undefined){\r\n          notesJSON.push({\"id\":this.idNote,\"note\": node.NOTE.message + node.NOTE.text,\"hidden\" : !this.props.displayOptions.notes.includes(node.NOTE['xml:lang']),lang:node.NOTE[\"xml:lang\"]});\r\n          this.idNote++;\r\n      }else{\r\n        node.NOTE.forEach((f) => {\r\n            notesJSON.push({\"id\":this.idNote,\"note\": f.message + f.text,\"hidden\" :!this.props.displayOptions.notes.includes(f['xml:lang']), lang:f[\"xml:lang\"]});\r\n            this.idNote++;\r\n          });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n  \t//let word = \"\";\r\n    const transcriptions = [];\r\n  \tconst translations = [];\r\n    const notes = [];\r\n    const notesJSON = [];\r\n\r\n\r\n\r\n    //cas o une seule balise FORM est trouv=>converti en objet et pas en tableau\r\n    //<div style={{display:'table-cell'}}>\r\n    var isGlossIncluded = false;\r\n    var thisClassName = '';\r\n\r\n    if(this.props.w.TRANSL !== undefined && this.props.w.TRANSL !== null){\r\n\t    if(this.props.w.TRANSL.length === undefined){\r\n        isGlossIncluded = this.props.displayOptions.morphemeTranslations.includes(this.props.w.TRANSL[\"xml:lang\"]);\r\n        thisClassName = (this.props.isWordList === true)?'wordlistWord':'morpheme';\r\n\r\n\t      translations.push(\r\n\t              <Typography variant=\"body2\" component={this.props.isWordList === true ? 'div':'p'} style={!isGlossIncluded?{display:'none'}:{visibility:'inherit'}} className={`translation ${thisClassName} morpheme-${this.props.w.TRANSL['xml:lang']}`}>\r\n\t                {this.props.w.TRANSL.text}\r\n\t              </Typography>\r\n\t            );\r\n\t    }else{\r\n\t      this.props.w.TRANSL.forEach((t) => {\r\n            isGlossIncluded = this.props.displayOptions.morphemeTranslations.includes(t[\"xml:lang\"]);\r\n            thisClassName = (this.props.isWordList === true)?'wordlistWord':'morpheme';\r\n\r\n\t          translations.push(\r\n\t              <Typography variant=\"body2\" component={this.props.isWordList === true ? 'div':'p'} style={!isGlossIncluded?{display:'none'}:{visibility:'inherit'}}  className={`translation ${thisClassName} morpheme-${t['xml:lang']}`}>\r\n\t                {t.text}\r\n\t              </Typography>\r\n\t            );\r\n\t        });\r\n\t    }\r\n    }\r\n\r\n  // Get note(s) of the sentence\r\n  /*\r\n  if(this.props.w.NOTE != undefined && this.props.w.NOTE !== null){\r\n    if(this.props.w.NOTE.length == undefined){\r\n      notes.push(\r\n              <Typography variant=\"body2\" component=\"p\" className={`note ${this.props.w.NOTE['xml:lang']}`}>\r\n                {this.props.w.NOTE.message} {this.props.w.NOTE.text}\r\n              </Typography>\r\n            );\r\n    }else{\r\n      this.props.w.NOTE.forEach((f) => {\r\n          notes.push(\r\n              <Typography variant=\"body2\" component=\"p\" className={`note ${f['xml:lang']}`}>\r\n                {f.message} {f.text}\r\n              </Typography>\r\n            );\r\n        });\r\n    }\r\n  }\r\n*/\r\n\r\n  // Get note(s) of the morpheme\r\n  this.getNotes(this.props.w,notesJSON);\r\n\r\n  notesJSON.forEach((n)=>{\r\n    notes.push(<Note id={n.id} note={n.note} hidden={n.hidden} lang={n.lang}></Note>);\r\n   });\r\n    \r\n  //\r\n  if(this.props.w.FORM !== undefined && this.props.w.FORM !== null){\r\n      if(this.props.w.FORM.length === undefined){\r\n        isGlossIncluded = this.props.displayOptions.morphemeTranscriptions.includes(this.props.w.FORM.kindOf);\r\n        thisClassName = (this.props.isWordList === true)?'wordlistWord':'morpheme';\r\n\r\n        transcriptions.push(\r\n                  <Typography variant=\"body2\" component=\"p\" style={!isGlossIncluded?{display:'none'}:{visibility:'inherit'}} className={`transcription ${thisClassName} morpheme-${this.props.w.FORM.kindOf}`}>\r\n                    {this.props.w.FORM.text}{notesJSON.map(n=><sup class={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n                  </Typography>\r\n                );\r\n                //word = this.props.w.FORM.text;\r\n        }else{\r\n          this.props.w.FORM.forEach((f) => {\r\n            isGlossIncluded = this.props.displayOptions.morphemeTranscriptions.includes(f.kindOf);\r\n            thisClassName = (this.props.isWordList === true)?'wordlistWord':'morpheme';\r\n\r\n              transcriptions.push(\r\n                  <Typography variant=\"body2\" component=\"p\" className={`transcription ${thisClassName} morpheme-${f.kindOf}`}>\r\n                    {f.text}{notesJSON.map(n=><sup class={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n                  </Typography>\r\n                );\r\n            });\r\n            //word = this.props.w.FORM[0].text;\r\n        }\r\n  }\r\n\r\n    return (\r\n      <div id={this.props.w.id} className={`MORPHEME ${this.props.w.hasOwnProperty('class')?this.props.w.class:''}`} style={this.props.isWordList===true ? {} : {display:\"inline-block\"} } ref={el => (this.instance = el)} >\r\n      { \r\n            this.props.isWordList===true\r\n            ?\r\n            <div style={{display:'table'}} >\r\n              <div style={{display:'table-cell'}}>\r\n                W{this.props.wID} \r\n              </div>\r\n\r\n              <div style={{display:'table-cell'}} id={this.props.w.id} hidden={!this.props.displayOptions.words} >\r\n                <IconButton color=\"primary\" aria-label=\"play\" onClick={this.playSentence.bind(this)}>\r\n                  <PlayArrow />\r\n                </IconButton>\r\n                <IconButton color=\"primary\" aria-label=\"play\" onClick={this.pauseSentence.bind(this)}>\r\n                  <Pause />\r\n                </IconButton>\r\n              </div>\r\n\r\n              <div style={{display:'table-cell',width:'12em'}} class=\"morpheme\" id={this.props.w.id} hidden={!this.props.displayOptions.words} >\r\n                {transcriptions}\r\n              </div>\r\n\r\n              {translations}\r\n\r\n              <div style={{display:'table-cell'}}>\r\n                {notes}\r\n              </div>       \r\n            </div>\r\n            :\r\n            <div>\r\n              <p>\r\n                {transcriptions}\r\n              </p>\r\n\r\n              <p>\r\n                {translations}\r\n              </p>\r\n\r\n            </div>\r\n        }\r\n      \r\n\r\n\t\t\t     \r\n          \r\n\r\n        </div>\r\n\r\n    );\r\n  }\r\n}\r\n\r\nexport default Morpheme;","import React from 'react';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport { PlayArrow, Pause } from '@material-ui/icons';\r\n\r\nclass PlayButton extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      displayPlay : document.getElementById('player').paused,\r\n      duration : (this.props.end - this.props.start) * 1000\r\n    }\r\n\r\n  }\r\n\r\n  showPlayPause = event => {\r\n      this.setState({\r\n        displayPlay : document.getElementById('player').paused\r\n      });\r\n  }\r\n\r\n  componentDidMount(){\r\n    document.getElementById('player').addEventListener('pause', this.showPlayPause);\r\n    document.getElementById('player').addEventListener('playing', this.showPlayPause);\r\n  }\r\n\r\n  playPause(){\r\n    var player = document.getElementById('player');\r\n    //si on change de phrase\r\n    /*if(this.props.id !== window.currentSentence || this.props.isWordList === true){\r\n      player.currentTime = this.props.start;\r\n    }*/\r\n\r\n    if(player.paused){\r\n      player.currentTime = this.props.start;\r\n      player.play();\r\n      if(!document.getElementsByName('continuousPlay')[0].checked) setTimeout(function() { player.pause() }, this.state.duration);\r\n    }else{\r\n      player.pause();\r\n    }\r\n\r\n    this.setState({\r\n      displayPlay : player.paused\r\n    });\r\n    \r\n  }\r\n\r\n  render() {\r\n    return(\r\n    <IconButton color=\"primary\" aria-label=\"play\" onClick={this.playPause.bind(this)} >\r\n      <PlayArrow style={{display:(this.state.displayPlay)?'block':'none'}} />\r\n      <Pause style={{display:(this.state.displayPlay)?'none':'block'}} />\r\n    </IconButton>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PlayButton;","import React from 'react';\r\nimport {Typography, Popper} from '@material-ui/core';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Note from './Note';\r\nimport Morpheme from './Morpheme';\r\nimport PlayButton from './PlayButton';\r\nimport Chip from '@material-ui/core/Chip';\r\n\r\nclass Word extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t      anchorEl: null,\r\n          open: false\r\n\t    };\r\n      this.idNote = (isNaN(this.props.idNote))?1:this.props.idNote - 1;\r\n\t}\r\n\r\n  highlight(){\r\n    window.highlight && window.highlight(this.props.w.id,'W');\r\n  }\r\n\r\n  handleClick = (event) => {\r\n    this.setState({\r\n      anchorEl: event.currentTarget,\r\n      open: true\r\n    });\r\n\r\n    if(event.currentTarget.id.length>0){\r\n      document.querySelectorAll('canvas').forEach((c)=>c.style.border=\"none\");\r\n      document.querySelector('[wordid=\"'+event.currentTarget.id+'\"]').style.border='solid';\r\n    }\r\n      };\r\n\r\n  handleClose = () => {\r\n    this.setState({\r\n      anchorEl: null,\r\n      open: false\r\n    });\r\n    document.querySelectorAll('canvas').forEach((c)=>c.style.border=\"none\");\r\n  };\r\n\r\n  getNotes(node,notesJSON){\r\n    if(node.NOTE !== undefined && node.NOTE !== null){\r\n      if(node.NOTE.length === undefined){\r\n          notesJSON.push({\"id\":this.idNote,\"note\": node.NOTE.message + node.NOTE.text,\"hidden\" : !this.props.displayOptions.notes.includes(node.NOTE['xml:lang']),lang:node.NOTE[\"xml:lang\"]});\r\n          this.idNote++;\r\n      }else{\r\n        node.NOTE.forEach((f) => {\r\n            notesJSON.push({\"id\":this.idNote,\"note\": f.message + f.text,\"hidden\" :!this.props.displayOptions.notes.includes(f['xml:lang']), lang:f[\"xml:lang\"]});\r\n            this.idNote++;\r\n          });\r\n      }\r\n    }\r\n  }\r\n/*\r\n  componentDidMount() {\r\n      if(this.props.w.AUDIO != undefined){\r\n        window.timeList.push({\r\n          start:parseFloat(this.props.w.AUDIO.start).toFixed(3),\r\n          end:parseFloat(this.props.w.AUDIO.end).toFixed(3),\r\n          mID:null,\r\n          wID:this.props.w.id,\r\n          sID:this.props.sID\r\n        });\r\n      }\r\n  }\r\n*/\r\n  render() {\r\n    this.idNote = (isNaN(this.props.idNote))?1:this.props.idNote - 1;\r\n\r\n  \t//let word = \"\";\r\n    const transcriptions = [];\r\n  \tconst translations = [];\r\n    const notes = [];\r\n    const notesJSON = [];\r\n\r\n    //DOI PopUp\r\n    const showDoi = (event) => {\r\n      //console.log(event.currentTarget.id);\r\n        this.setState({ anchorEl: this.state.anchorEl ? null : event.currentTarget});\r\n      };\r\n    const open = Boolean(this.state.anchorEl);\r\n      const popperId = open ? 'simple-popper' : undefined;\r\n    /////////\r\n\r\n    //cas o une seule balise FORM est trouv=>converti en objet et pas en tableau\r\n    var isGlossIncluded = false;\r\n    var thisClassName = \"\";\r\n\r\n    const tableBordered = {\r\n      /*\r\n      border: \"1px solid black\",\r\n      borderCollapse: \"collapse\"\r\n      */\r\n    };\r\n\r\n    const visible = {\r\n      visibility: \"inherit\"\r\n    };\r\n\r\n    const invisible = {\r\n      display: \"none\"\r\n    };\r\n\r\n    const tableBorderedVisible = {\r\n      ...tableBordered,\r\n      ...visible\r\n    };\r\n\r\n    const tableBorderedInvisible = {\r\n      ...tableBordered,\r\n      ...invisible\r\n    }\r\n\r\n\r\n/////////////////////////////\r\n    //GESTION DES TRADUCTIONS\r\n/////////////////////////////\r\n    if(this.props.w.TRANSL !== undefined && this.props.w.TRANSL !== null){\r\n\t    if(this.props.w.TRANSL.length === undefined){\r\n        isGlossIncluded = this.props.displayOptions.wordTranslations.includes(this.props.w.TRANSL[\"xml:lang\"]);\r\n        thisClassName = (this.props.isWordList === true)?'wordlistWord':'word';\r\n\r\n        //gestion de l'affichage tableau des WordList : une colonne par langue disponible\r\n        if(this.props.isWordList === true){\r\n          this.props.availableOptions.word.translations.forEach((lang) => {\r\n\r\n            if(lang === this.props.w.TRANSL['xml:lang']){\r\n              translations.push(\r\n                <Typography variant=\"body2\" component='td' style={!isGlossIncluded?tableBorderedInvisible:tableBorderedVisible} className={`translation ${thisClassName} word-${this.props.w.TRANSL['xml:lang']}`}>\r\n                  {this.props.w.TRANSL.text}\r\n                </Typography>\r\n              );\r\n            }else{\r\n              translations.push(\r\n                <Typography variant=\"body2\" component='td' style={!isGlossIncluded?tableBorderedInvisible:tableBorderedVisible} className={`translation ${thisClassName} word-${this.props.w.TRANSL['xml:lang']}`}>\r\n                  \r\n                </Typography>\r\n              );\r\n            }\r\n          });\r\n        }else{\r\n          translations.push(\r\n            <Chip \r\n            style={!isGlossIncluded?invisible:visible}\r\n            className={`translation ${thisClassName} word-${this.props.w.TRANSL['xml:lang']}`}\r\n            label={this.props.w.TRANSL.text}\r\n            />\r\n          );\r\n        }\r\n\r\n\t    }else{\r\n\r\n        //gestion de l'affichage tableau des WordList : une colonne par langue disponible\r\n        if(this.props.isWordList === true){\r\n          this.props.availableOptions.word.translations.forEach((lang) => {\r\n\r\n            var found = false;\r\n            isGlossIncluded = this.props.displayOptions.wordTranslations.includes(lang);\r\n            thisClassName = 'wordlistWord';\r\n\r\n              this.props.w.TRANSL.forEach((t) => {\r\n                \r\n                if(lang === t['xml:lang']){\r\n                  found = true;\r\n\r\n                  translations.push(\r\n                      <Typography variant=\"body2\" component='td' style={!isGlossIncluded?tableBorderedInvisible:tableBorderedVisible}  className={`translation ${thisClassName} word-${t['xml:lang']}`}>\r\n                        {t.text}\r\n                      </Typography>\r\n                    );\r\n                }\r\n              });\r\n\r\n            if(found===false){\r\n\r\n              translations.push(\r\n                      <Typography variant=\"body2\" component='td' style={!isGlossIncluded?tableBorderedInvisible:tableBorderedVisible}   className={`translation ${thisClassName} word-${lang}`}>\r\n                        \r\n                      </Typography>\r\n                    );\r\n            }\r\n            \r\n          });\r\n        }else{\r\n          this.props.w.TRANSL.forEach((t) => {\r\n            isGlossIncluded = this.props.displayOptions.wordTranslations.includes(t[\"xml:lang\"]);\r\n            thisClassName = 'word';\r\n\r\n            translations.push(\r\n                <Chip \r\n                style={!isGlossIncluded?invisible:visible}\r\n                className={`translation ${thisClassName} word-${t['xml:lang']}`}\r\n                label={t.text}\r\n                />\r\n              );\r\n          });\r\n        }\r\n\t      \r\n\t    }\r\n    }\r\n\r\n  // Get note(s) of the sentence\r\n  /*\r\n  if(this.props.w.NOTE !== undefined && this.props.w.NOTE !== null){\r\n    if(this.props.w.NOTE.length === undefined){\r\n      notes.push(\r\n              <Typography variant=\"body2\" component=\"p\" className={`note ${this.props.w.NOTE['xml:lang']}`}>\r\n                {this.props.w.NOTE.message} {this.props.w.NOTE.text}\r\n              </Typography>\r\n            );\r\n    }else{\r\n      this.props.w.NOTE.forEach((f) => {\r\n          notes.push(\r\n              <Typography variant=\"body2\" component=\"p\" className={`note ${f['xml:lang']}`}>\r\n                {f.message} {f.text}\r\n              </Typography>\r\n            );\r\n        });\r\n    }\r\n  }\r\n*/\r\n\r\n  // Get note(s) of the word\r\n  this.getNotes(this.props.w,notesJSON);\r\n\r\n  notesJSON.forEach((n)=>{\r\n    notes.push(<Note id={n.id} note={n.note} hidden={n.hidden} lang={n.lang}></Note>);\r\n   });\r\n    \r\n/////////////////////////////\r\n//GESTION DES TRANSCRIPTIONS\r\n/////////////////////////////\r\n\r\n  if(this.props.w.FORM !== undefined && this.props.w.FORM !== null){\r\n      // si une seule transcription disponible\r\n      if(this.props.w.FORM.length === undefined){\r\n        isGlossIncluded = this.props.displayOptions.wordTranscriptions.includes(this.props.w.FORM.kindOf);\r\n        thisClassName = (this.props.isWordList === true)?'wordlistWord':'word';\r\n        \r\n        var styleCombined;\r\n        \r\n        if(isGlossIncluded){\r\n          if(this.props.isWordList === true){\r\n            styleCombined = tableBorderedVisible;\r\n          }else{\r\n            styleCombined = visible;\r\n          }\r\n        }else{\r\n          if(this.props.isWordList === true){\r\n            styleCombined = tableBorderedInvisible;\r\n          }else{\r\n            styleCombined = invisible;\r\n          }\r\n        }\r\n\r\n        var notesSup = notesJSON.map((n)=>\r\n        <sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>\r\n        );\r\n\r\n        (this.props.isWordList === true)?\r\n          transcriptions.push( \r\n            <Typography variant=\"body2\" component=\"td\" style={styleCombined} className={`transcription ${thisClassName} word-${this.props.w.FORM.kindOf}`}>\r\n              {this.props.w.FORM.text}{notesJSON.map(n=><sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n            </Typography>\r\n          ):\r\n          transcriptions.push( \r\n            <div><Chip \r\n              style={styleCombined}\r\n              className={`transcription ${thisClassName} word-${this.props.w.FORM.kindOf}`}\r\n              label={this.props.w.FORM.text}\r\n              />\r\n              {notesSup}\r\n            </div>\r\n          );\r\n\r\n\r\n                //word = this.props.w.FORM.text;\r\n\r\n      // si plusieurs transcriptions disponibles\r\n      }else{\r\n\r\n          this.props.w.FORM.forEach((f) => {\r\n            isGlossIncluded = this.props.displayOptions.wordTranscriptions.includes(f.kindOf);\r\n            thisClassName = (this.props.isWordList === true)?'wordlistWord':'word';\r\n\r\n            var styleCombined;\r\n        \r\n            if(isGlossIncluded){\r\n              if(this.props.isWordList === true){\r\n                styleCombined = tableBorderedVisible;\r\n              }else{\r\n                styleCombined = visible;\r\n              }\r\n            }else{\r\n              if(this.props.isWordList === true){\r\n                styleCombined = tableBorderedInvisible;\r\n              }else{\r\n                styleCombined = invisible;\r\n              }\r\n            }\r\n\r\n        var notesSup = notesJSON.map((n)=>\r\n        <sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>\r\n        );\r\n\r\n        (this.props.isWordList === true)?\r\n          transcriptions.push( \r\n            <Typography variant=\"body2\" component=\"td\" style={styleCombined} className={`transcription ${thisClassName} word-${f.kindOf}`}>\r\n              {f.text}{notesJSON.map(n=><sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n            </Typography>\r\n          ):\r\n          transcriptions.push( \r\n            <div><Chip \r\n              style={styleCombined}\r\n              className={`transcription ${thisClassName} word-${f.kindOf}`}\r\n              label={f.text}\r\n              color=\"secondary\"\r\n              />\r\n              {notesSup}\r\n            </div>\r\n          );\r\n            });\r\n            //word = this.props.w.FORM[0].text;\r\n      }\r\n  }\r\n\r\n  var morphemes = [];\r\n\r\n  if(this.props.w.M !== undefined && this.props.w.M !== null){\r\n          \r\n            if(this.props.w.M.length>0){\r\n              \r\n              this.props.w.M.forEach((m) =>{\r\n                morphemes.push(\r\n                      <Morpheme w={m} displayOptions={this.props.displayOptions} idNote={this.idNote} />\r\n                  );\r\n              });\r\n              \r\n\r\n            }else{\r\n            morphemes.push(\r\n                      <Morpheme w={this.props.w.M} displayOptions={this.props.displayOptions} idNote={this.idNote} />\r\n                  );\r\n            }\r\n    }\r\n\r\n    return (\r\n        \r\n        \r\n            this.props.isWordList===true\r\n            ?\r\n            <tr id={this.props.w.id} className=\"WORD\" style={tableBordered} ref={el => (this.instance = el)} >\r\n      \r\n              <td style={tableBordered}>\r\n                {this.props.w.id}\r\n                <IconButton aria-describedby={popperId} onClick={showDoi} id={\"btn_doi_W\"+this.props.sID}><img className=\"doi\" src=\"/dist/images/DOI_logo.svg\" alt=\"doi\" /></IconButton>\r\n                <Popper id={\"doi_W\"+this.props.sID} open={open} anchorEl={this.state.anchorEl} test={document.getElementById(\"btn_doi_W\"+this.props.sID)}>\r\n                  <div>{this.props.doi}</div>\r\n                </Popper> \r\n                { \r\n                this.props.w.hasOwnProperty('AUDIO')\r\n                ?\r\n                <PlayButton continuousPlay={this.props.displayOptions.continuousPlay} start={this.props.w.AUDIO?this.props.w.AUDIO.start:0} end={this.props.w.AUDIO?this.props.w.AUDIO.end:0} isWordList={true} />\r\n                :\r\n                <div></div>\r\n                }\r\n              </td>\r\n\r\n               <React.Fragment>\r\n              {transcriptions}\r\n              {morphemes}\r\n              {translations}\r\n               </React.Fragment>\r\n\r\n              <td className=\"notes\">\r\n                {notes}\r\n              </td> \r\n\r\n            </tr>\r\n            :\r\n            <div id={this.props.w.id} onMouseOver={this.highlight.bind(this)} className={`WORD ${this.props.w.hasOwnProperty('class')?this.props.w.class:''}`} style={this.props.isWordList===true ? {} : {display:\"inline-block\"} } ref={el => (this.instance = el)} >\r\n              <div>\r\n                <div className=\"transcBlock\">\r\n                  {transcriptions}\r\n                </div>\r\n                <div className=\"morphemesBlock\">\r\n                  {morphemes}\r\n                </div>\r\n                <div className=\"translBlock\">\r\n                  {translations}\r\n                </div>\r\n\r\n              </div>\r\n            </div>  \r\n\r\n    );\r\n  }\r\n}\r\n\r\nexport default Word;","import React from 'react';\r\nimport Picture from './Picture';\r\nimport Word from './Word';\r\nimport Morpheme from './Morpheme';\r\nimport Note from './Note';\r\nimport { Card, Avatar, CardContent, Popper } from '@material-ui/core';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport PlayButton from './PlayButton';\r\nimport blue from \"@material-ui/core/colors/blue\";\r\n\r\n//BUG POPOVER\r\n//https://codepen.io/chocochip/pen/zYxMgRG\r\nclass Sentence extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t        displayOptions : this.props.displayOptions,\r\n\t        notes : null, //#17\r\n\t        anchorEl : null\r\n\t    };\r\n\t    this.idNote = 1;\r\n\t}\r\n\r\n\r\n\tgetNotes(node,notesJSON){\r\n\t\tif(node.NOTE !== undefined && node.NOTE !== null){\r\n\t\t\tif(node.NOTE.length === undefined){\r\n\t\t\t    notesJSON.push({\"id\":this.idNote,\"note\": node.NOTE.message + node.NOTE.text,\"hidden\" : !this.props.displayOptions.notes.includes(node.NOTE['xml:lang']),lang:node.NOTE[\"xml:lang\"]});\r\n\t\t\t    this.idNote++;\r\n\t\t\t}else{\r\n\t\t\t\tnode.NOTE.forEach((f) => {\r\n\t\t\t      notesJSON.push({\"id\":this.idNote,\"note\": f.message + f.text,\"hidden\" :!this.props.displayOptions.notes.includes(f['xml:lang']), lang:f[\"xml:lang\"]});\r\n\t\t\t      this.idNote++;\r\n\t\t\t    });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n  render() {\r\n\r\n\r\n  \tthis.idNote = 1;\r\n  \tconst transcriptions = [];\r\n\tconst translations = [];\r\n\tconst notesJSON = [];\r\n\tconst words = [];\r\n\tconst canvas = [];\r\n\r\n\t//DOI PopUp\r\n\r\n\tconst showDoi = (event) => {\r\n\t\t//console.log(event.currentTarget.id);\r\n\t    this.setState({ anchorEl: this.state.anchorEl ? null : event.currentTarget});\r\n\t  };\r\n\tconst open = Boolean(this.state.anchorEl);\r\n    const popperId = open ? 'simple-popper' : undefined;\r\n    /////////\r\n\r\n\t// Get translation(s) of the sentence\r\n\tif(this.props.s.TRANSL !== null && this.props.s.TRANSL !== undefined){\r\n\t\tif(this.props.s.TRANSL.length === undefined){\r\n\t\t\ttranslations.push(\r\n\t\t          <Typography hidden={!this.props.displayOptions.sentenceTranslations.includes(this.props.s.TRANSL[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`translation sentence-${this.props.s.TRANSL['xml:lang']}`}>\r\n\t\t\t          <b>{this.props.s.TRANSL.text}</b>\r\n\t\t\t        </Typography>\r\n\t\t        );\r\n\t\t}else{\r\n\t\t\tthis.props.s.TRANSL.forEach((t) => {\r\n\t\t      translations.push(\r\n\t\t        \t<Typography hidden={!this.props.displayOptions.sentenceTranslations.includes(t[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`translation sentence-${t[\"xml:lang\"]}`}>\r\n\t\t\t        \t<b>{t.text}</b>\r\n\t\t\t       \t</Typography>\r\n\t\t        );\r\n\t\t    });\r\n\t\t}\r\n\t}\r\n\t\r\n\t//#17\r\n\t// Get note(s) of the sentence\r\n\tthis.getNotes(this.props.s,notesJSON);\r\n\r\n//\r\n\t// Get transcription(s) of the sentence\r\n\tif(this.props.s.FORM !== undefined && this.props.s.FORM !== null){\r\n\t\tif(this.props.s.FORM.length === undefined){\r\n\t\t\ttranscriptions.push(\r\n\t\t          <Typography hidden={!this.props.displayOptions.sentenceTranscriptions.includes(this.props.s.FORM.kindOf)} variant=\"body2\" component=\"p\" className={`transcription sentence-${this.props.s.FORM.kindOf}`}>\r\n\t\t\t          <b>{this.props.s.FORM.text}</b>{notesJSON.map(n=><sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n\t\t\t        </Typography>\r\n\t\t        );\r\n\r\n\t\t}else{\r\n\t\t\tthis.props.s.FORM.forEach((f) => {\r\n\t\t      transcriptions.push(\r\n\t\t          <Typography hidden={!this.props.displayOptions.sentenceTranscriptions.includes(f.kindOf)} variant=\"body2\" component=\"p\" className={`transcription sentence-${f.kindOf}`}>\r\n\t\t\t          <b>{f.text}</b>{notesJSON.map(n=><sup style={{display:(!this.props.displayOptions.notes.includes(n.lang))?\"none\":\"inline-block\"}} className={\"circle note \"+n.lang}>{n.id}</sup>)}\r\n\t\t\t        </Typography>\r\n\t\t        );\r\n\t\t    });\r\n\t\t}\r\n\t}\r\n  \t\r\n    if(this.props.s.AREA !== undefined && this.props.s.AREA !== null){\r\n\r\n/*\r\n    \tvar coords = this.props.s.AREA[0].coords.split(',');\r\n\t    var delta_x = coords[0];//offset for x, image positioning\r\n\t    var delta_y = coords[1];//offset for y, image positioning\r\n\r\n\t    \r\n*/\r\n\t\t\tvar delta_x = [];\r\n\t    var delta_y = [];\r\n\r\n\t    this.props.s.AREA.forEach((a) => {\r\n\t    \tvar coords = a.coords.split(',');\r\n\t    \tdelta_x[a.image] = coords[0];//offset for x, image positioning\r\n\t    \tdelta_y[a.image] = coords[1];//offset for y, image positioning\r\n\t    });\r\n\r\n\t}\r\n\t\r\n\t// Get word(s) of the sentence\r\n\tif(this.props.s.W !== undefined && this.props.s.W !== null){\r\n\r\n\t\t//W can be an array or an object depending on the number of children in the XML\r\n\t\t//Object if only one Word, Array if more than 1 word\r\n\r\n\t\tif(Array.isArray(this.props.s.W)){\r\n\t\t\t//get words of the sentence\r\n\t\t    this.props.s.W.forEach((w) => {\r\n\r\n\t\t    \tif(w.M !== undefined && w.M !== null){\r\n\r\n\t\t\t\t\tvar morphemes = [];\r\n\t\t\t\t\tvar divWord;\r\n\r\n\r\n\t\t    \t\tif(w.M.length>0){\r\n\t\t    \t\t\t\r\n\t\t    \t\t\tw.M.forEach((m) =>{\r\n\t\t    \t\t\t\t// Get note(s) of the morpheme\r\n\t\t\t\t\t\t\tthis.getNotes(m,notesJSON);\r\n\r\n\t\t\t    \t\t\tmorphemes.push(\r\n\t\t\t\t          \t\t<Morpheme wID={w.id} w={m} displayOptions={this.props.displayOptions} idNote={this.idNote} />\r\n\t\t\t\t        \t);\r\n\r\n\r\n\t\t\t    \t\t});\r\n\t\t\t    \t\t//divWord = <div id={w.id} className=\"WORD hasMorphemes\" style={{display: \"inline-block\"}}>{morphemes}</div>;\r\n\t\t\t\t\t\tdivWord = <Word sID={this.props.s.id} w={w} displayOptions={this.props.displayOptions} idNote={this.idNote} />;\r\n\t\t\t    \t\twords.push(divWord);\r\n\r\n\t\t    \t\t}else{\r\n\t\t    \t\t\t// Get note(s) of the morpheme\r\n\t\t\t\t\t\tthis.getNotes(w.M,notesJSON);\r\n\t\t\t\t\t\tmorphemes.push(\r\n\t\t\t\t          \t\t<Morpheme wID={w.id} w={w.M} displayOptions={this.props.displayOptions} idNote={this.idNote} />\r\n\t\t\t\t        \t);\r\n\t\t\t\t\t\t//divWord = <div id={w.id} className=\"WORD hasMorphemes\" style={{display: \"inline-block\"}}>{morphemes}</div>;\r\n\t\t\t\t\t\tdivWord = <Word sID={this.props.s.id} w={w} displayOptions={this.props.displayOptions} idNote={this.idNote} />;\r\n\t\t\t    \t\twords.push(divWord);\r\n\t\t    \t\t\t\r\n\t\t    \t\t}\r\n\r\n\t\t    \t\t\tif(w.AREA !== undefined && w.AREA !== null){\r\n\t\t\t        \tvar coords = w.AREA.coords.split(',');\r\n\t\t\t\t        coords[0] -= delta_x[w.AREA.image];\r\n\t\t\t\t        coords[1] -= delta_y[w.AREA.image];\r\n\t\t\t\t\t\t\t\tcoords[2] -= delta_x[w.AREA.image];\r\n\t\t\t\t        coords[3] -= delta_y[w.AREA.image];\r\n\r\n\t\t\t\t        //var newCoords = coords.join(',');\r\n\t\t\t\t        var canvasStyle = {\r\n\t\t\t\t        \t'position': 'absolute',\r\n\t\t\t\t        \t'top': coords[1],\r\n\t\t\t\t        \t'left': coords[0],\r\n\t\t\t\t        }\r\n\r\n\t\t\t\t        // Get transcription(s) of the word\r\n\t\t\t\t        var word=\"\";\r\n\t\t\t\t\t\t  \tif(w.FORM.length === undefined){\r\n\t\t\t\t\t\t  \t\tword = w.FORM.text\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t      word = (w.FORM[0]!==undefined) ? w.FORM[0].text:\"\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t        canvas.push(\r\n\t\t\t\t        \t<canvas \r\n\t\t\t\t        \t\timage={w.AREA.image}\r\n\t\t\t\t        \t\ttitle={word} \r\n\t\t\t\t        \t\tstyle={canvasStyle} \r\n\t\t\t\t        \t\twordid={w.id} \r\n\t\t\t\t        \t\twidth={coords[2]-coords[0]} height={coords[3]-coords[1]} \r\n\t\t\t\t        \t\tonClick={()=>document.getElementById(w.id).click()} >\r\n\t\t\t\t        \t\t</canvas>\r\n\t\t\t\t        );\r\n\t\t\t\t        \r\n\t\t\t        }\r\n\t\t    \t}else{\r\n\r\n\t\t    \t\t// Get note(s) of the word\r\n\t\t\t\t\tthis.getNotes(w,notesJSON);\r\n\r\n\t\t    \t\twords.push(\r\n\t\t\t          \t<Word sID={this.props.s.id} w={w} displayOptions={this.props.displayOptions} idNote={this.idNote} />\r\n\t\t\t        );\r\n\r\n\t\t\t        if(w.AREA !== undefined && w.AREA !== null){\r\n\t\t\t        \tvar coords = w.AREA.coords.split(',');\r\n\t\t\t\t        coords[0] -= delta_x[w.AREA.image];\r\n\t\t\t\t        coords[1] -= delta_y[w.AREA.image];\r\n\t\t\t\t\t\t\t\tcoords[2] -= delta_x[w.AREA.image];\r\n\t\t\t\t        coords[3] -= delta_y[w.AREA.image];\r\n\r\n\t\t\t\t        //var newCoords = coords.join(',');\r\n\t\t\t\t        var canvasStyle = {\r\n\t\t\t\t        \t'position': 'absolute',\r\n\t\t\t\t        \t'top': coords[1],\r\n\t\t\t\t        \t'left': coords[0],\r\n\t\t\t\t        }\r\n\r\n\t\t\t\t        // Get transcription(s) of the word\r\n\t\t\t\t        var word=\"\";\r\n\t\t\t\t\t\t  \tif(w.FORM.length === undefined){\r\n\t\t\t\t\t\t  \t\tword = w.FORM.text\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t      word = (w.FORM[0]!==undefined) ? w.FORM[0].text:\"\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tcanvas.push(\r\n\t\t\t\t        \t<canvas \r\n\t\t\t\t        \t\timage={w.AREA.image}\r\n\t\t\t\t        \t\ttitle={word} \r\n\t\t\t\t        \t\tstyle={canvasStyle} \r\n\t\t\t\t        \t\twordid={w.id} \r\n\t\t\t\t        \t\twidth={coords[2]-coords[0]} height={coords[3]-coords[1]} \r\n\t\t\t\t        \t\tonClick={()=>document.getElementById(w.id).click()} >\r\n\t\t\t\t        \t\t</canvas>\r\n\t\t\t\t        );\r\n\r\n\t\t\t        }\r\n\t\t    \t}\t\r\n\t\t     \t\r\n\t\t    });\r\n\r\n\t\t}\t\r\n\t\t\r\n\r\n\t}\r\n\t \r\n\t var notes = [];\r\n\t //#17 NOTES\r\n\t notesJSON.forEach((n)=>{\r\n\t \tnotes.push(<Note id={n.id} note={n.note} hidden={n.hidden} lang={n.lang}></Note>);\r\n\t });\r\n\r\n    \r\n    var avatarStyle={\r\n    \t'backgroundColor': blue[800],\r\n    \t'display': 'inline-flex'\r\n    }\r\n\r\n    return (\r\n      <div id={this.props.s.id} className=\"SENTENCE\" ref={el => (this.instance = el)}>\r\n\t\t<Card> \r\n\t      <CardContent>  \t\r\n\t      \t\t{(this.props.s.AREA !== undefined) ? \r\n\t      \t\t(\r\n\t      \t\t<Picture \r\n\t      \t\t\tsentenceId={this.props.s.id} \r\n\t      \t\t\timageSrc={this.props.imageSrc} \r\n\t      \t\t\tcanvas={canvas} \r\n\t      \t\t\tarea={this.props.s.AREA} />\r\n\t      \t\t):(<div></div>)\r\n\t      \t\t}\r\n\t       \t\r\n\t        <div style={{textAlign:\"initial\"}} className=\"annotationsBlock\">\r\n\r\n\t        \t<Avatar aria-label=\"sentenceId\" style={avatarStyle}>\r\n\t\t            {this.props.s.id} \r\n\t\t          </Avatar>\r\n\t\t\t\t<IconButton aria-describedby={popperId} onClick={showDoi} id={\"btn_doi_\"+this.props.s.id}><img className=\"doi\" src=\"/dist/images/DOI_logo.svg\" alt=\"doi\" /></IconButton>\r\n\t        \t<Popper id={\"doi_\"+this.props.s.id} open={open} anchorEl={this.state.anchorEl} test={document.getElementById(\"btn_doi_\"+this.props.s.id)}>\r\n\t\t\t      <div>{this.props.doi}</div>\r\n\t\t\t    </Popper>\r\n\t\t\t    { \r\n\t\t    \t \t(this.props.s.hasOwnProperty('AUDIO') && window.wavesurfer)\r\n\t\t    \t \t?\r\n\t\t\t\t\t<PlayButton continuousPlay={this.state.displayOptions.continuousPlay} start={this.props.s.AUDIO?this.props.s.AUDIO.start:0} end={this.props.s.AUDIO?this.props.s.AUDIO.end:0} id={this.props.s.id} />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<div></div>\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"transcBlock\" style={{display: \"inline-block\"}}>\r\n\t        \t\t{transcriptions}\r\n\t        \t</div>\r\n\r\n\t        \t<div className=\"wordsBlock\">\r\n\t\t\t\t\t{words}\r\n\t\t\t\t</div>\r\n\r\n\t        \t<div className=\"translBlock\">\r\n\t        \t\t{translations}\r\n\t        \t</div>\r\n\r\n\t        \t<div className=\"notesBlock\">\r\n\t        \t\t{notes}\r\n\t        \t</div>\r\n\t        \t\r\n\t        </div> \r\n\t      </CardContent>\r\n\t    </Card>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Sentence;","import React from 'react';\r\nimport Sentence from './Sentence';\r\nimport Word from './Word';\r\nimport Morpheme from './Morpheme';\r\nimport { Container } from '@material-ui/core';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nclass Annotations extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var displayOptions = {\r\n        textTranscriptions: (this.props.displayOptions.textTranscriptions.length > 0) ? this.props.displayOptions.textTranscriptions:[],\r\n        textTranslations: (this.props.displayOptions.textTranslations.length > 0) ? this.props.displayOptions.textTranslations:[],\r\n        sentenceTranscriptions: (this.props.displayOptions.sentenceTranscriptions.length > 0) ? this.props.displayOptions.sentenceTranscriptions:[this.props.availableOptions.sentence.transcriptions[0]],\r\n        sentenceTranslations: (this.props.displayOptions.sentenceTranslations.length > 0) ? this.props.displayOptions.sentenceTranslations:[this.props.availableOptions.sentence.translations[0]],\r\n        wordTranscriptions: (this.props.displayOptions.wordTranscriptions.length > 0) ? this.props.displayOptions.wordTranscriptions:[],\r\n        wordTranslations: (this.props.displayOptions.wordTranslations.length > 0) ? this.props.displayOptions.wordTranslations:[],\r\n        morphemeTranscriptions: (this.props.displayOptions.morphemeTranscriptions.length > 0) ? this.props.displayOptions.morphemeTranscriptions:[],\r\n        morphemeTranslations: (this.props.displayOptions.morphemeTranslations.length > 0) ? this.props.displayOptions.morphemeTranslations:[],\r\n        displayNotes: this.props.displayOptions.notes,\r\n        lang:this.props.displayOptions.lang,\r\n        mode:this.props.displayOptions.mode,\r\n        continuousPlay:this.props.displayOptions.continuousPlay,\r\n    };\r\n\r\n\r\n    this.state = {\r\n      isLoaded: false,\r\n      annotationData: [],\r\n      displayOptions: displayOptions,\r\n      availableOptions: this.props.availableOptions,\r\n      isWordList: false\r\n    };\r\n\r\n\r\n  }\r\n\r\n  shouldComponentUpdate() {\r\n    //console.log('Annotations - shouldComponentUpdate lifecycle');\r\n    return false;\r\n  }\r\n\r\n  componentDidMount() {\r\n    \r\n        window.timeList = this.props.timeList;\r\n  }\r\n\r\n  render() {\r\n\r\n    var annotationItems = [];\r\n    var wholeTranscriptions = [];\r\n    var wholeTranslations = [];\r\n    var notes = [];\r\n    var isWordList = false;\r\n\r\n    var imageSrc = \"\";\r\n    var doi = this.props.doi;\r\n    var sID = 0;\r\n\r\n    var player = document.querySelector('#player');\r\n\r\n\tvar trackTest;\r\n    var trackTranscription;\r\n    var trackTranslation;\r\n\r\n    if(player !== null){\r\n\t\ttrackTest = player.textTracks.getTrackById('test');\r\n    \ttrackTranscription = player.textTracks.getTrackById('trackTranscription');\r\n    \ttrackTranslation = player.textTracks.getTrackById('trackTranslation');\r\n\r\n    \ttrackTest.mode=\"showing\";\r\n    \ttrackTranscription.mode=\"showing\";\r\n    \ttrackTranslation.mode=\"showing\";\r\n    }\r\n    \r\n   //if(player.textTracks.length === 1){     \r\n      //var trackTranscription = player.addTextTrack(\"subtitles\",\"transcription\");\r\n      //var trackTranslation = player.addTextTrack(\"subtitles\",\"translation\");\r\n      \r\n   // }\r\n\r\n    if(this.props.annotations.TEXT !== undefined && this.props.annotations.TEXT !== null)\r\n      var sentences = this.props.annotations.TEXT.S;\r\n\r\n    if(this.props.annotations.WORDLIST !== undefined && this.props.annotations.WORDLIST !== null)\r\n      var wordlist = this.props.annotations.WORDLIST.W;\r\n\r\n    //this.state.annotationData.forEach((a) => {\r\n    if(sentences !== null && sentences !== undefined){\r\n      sentences.forEach((a) => {\r\n\r\n        if(a.AREA !== undefined && a.AREA[0] !== undefined && a.AREA[0].image !== undefined){\r\n          this.props.images.forEach((i) =>{\r\n            //var idImage = i.id.split('.version');\r\n\r\n            //if(idImage[0] === a.AREA.image)\r\n             // {\r\n                //imageSrc=i.url;\r\n                imageSrc = \"data:image/png;base64,\"+localStorage[a.AREA.image];\r\n             // }\r\n          });\r\n        }\r\n        \r\n        sID++;\r\n        //#3\r\n        //var doiSentenceUrl = doiUrl + doi + \"&sentence=S\" + sID;\r\n        var doiSentenceUrl = doi + \"#\" + a.id;\r\n        //TEST VTT\r\n\t   if(player !== null){\r\n\t        if(trackTranscription.cues.length < sentences.length){\r\n\t          \r\n\t          var transcSubtitle = \"\";\r\n\t          var translSubtitle = \"\";\r\n\r\n\t          if(typeof(a.FORM) === \"object\"){\r\n\t            if(a.FORM !== null)\r\n\t            transcSubtitle = a.FORM.text;\r\n\t          }else{\r\n\t            if(a.FORM[0].text !== null)\r\n\t            transcSubtitle = a.FORM[0].text;\r\n\t          }\r\n\r\n\t          if(a.TRANSL !== null){\r\n\t            if(typeof(a.TRANSL) === \"object\"){\r\n\t              if(a.TRANSL !== null)\r\n\t              translSubtitle = a.TRANSL.text;\r\n\t            }else{\r\n\t              if(a.TRANSL[0].text !== null)\r\n\t              translSubtitle = a.TRANSL[0].text;\r\n\t            }\r\n\t          }\r\n\r\n\t          var cueStart = (a.AUDIO !== undefined)?a.AUDIO.start:0;\r\n\t          var cueEnd = (a.AUDIO !== undefined)?a.AUDIO.end:0;\r\n\r\n\t          const cueTransc = new VTTCue(cueStart, cueEnd, transcSubtitle);\r\n\t          const cueTransl = new VTTCue(cueStart, cueEnd, translSubtitle);\r\n\r\n\t          cueTransc.size = 99;\r\n\t          cueTransl.size = 99;\r\n\t          cueTransc.line = 12;\r\n\t          cueTransl.line = 14;\r\n\r\n\t          \r\n\t          \ttrackTest.addCue(cueTransc);\r\n\t          \ttrackTest.addCue(cueTransl);\r\n\t          \ttrackTranscription.addCue(cueTransc);\r\n\t          \ttrackTranslation.addCue(cueTransl);\r\n\t          \r\n\t          \r\n\t        }\r\n\t    }\r\n        \r\n        annotationItems.push(\r\n            <Sentence \r\n              doi={doiSentenceUrl} \r\n              sID={sID} \r\n              s={a} \r\n              imageSrc={imageSrc} \r\n              displayOptions={this.state.displayOptions} \r\n            />\r\n          );\r\n\r\n      });\r\n    }\r\n\r\n    if(wordlist !== null && wordlist !== undefined && Array.isArray(wordlist)){\r\n    //Si c'est une liste de mots\r\n      isWordList = true;\r\n      this.setState({isWordList:true});\r\n\r\n          //W can be an array or an object depending on the number of children in the XML\r\n          //Object if only one Word, Array if more than 1 word\r\n\r\n          //if(Array.isArray(wordlist)){\r\n            //get words of the sentence\r\n              wordlist.forEach((w) => {\r\n\r\n                if(w.M !== undefined && w.M !== null){\r\n\r\n                  if(w.M.length>0){\r\n                    w.M.forEach((m) =>{\r\n                      annotationItems.push(\r\n                            <Morpheme w={m} wID={++sID} displayOptions={this.state.displayOptions} isWordList={true} />\r\n                        );\r\n                    });\r\n                  }else{\r\n                    annotationItems.push(\r\n                            <Morpheme w={w.M} wID={++sID} displayOptions={this.state.displayOptions} isWordList={true} />\r\n                        );\r\n                  }\r\n\r\n\r\n                }else{\r\n                  ++sID;\r\n                  var doiWordUrl = doi + \"#W\" + sID;\r\n                  annotationItems.push(\r\n                    <Word w={w} wID={sID} displayOptions={this.state.displayOptions} availableOptions={this.props.availableOptions} isWordList={true} doi={doiWordUrl} />\r\n                  );\r\n                } \r\n                \r\n              });\r\n\r\n          //} \r\n          \r\n\r\n    }\r\n    \r\n\r\n    // Get whole transcription(s) of the doc\r\n    if(this.props.annotations.TEXT.FORM !== undefined && this.props.annotations.TEXT.FORM !== null){\r\n      if(this.props.annotations.TEXT.FORM.length === undefined){\r\n        wholeTranscriptions.push(\r\n                <Typography hidden={(!this.state.displayOptions.textTranscriptions) || (!this.state.displayOptions.textTranscriptions.includes(this.props.annotations.TEXT.FORM.kindOf))} variant=\"body2\" component=\"p\" className={\"text-\"+this.props.annotations.TEXT.FORM.kindOf + \" transcription\"}>\r\n                  {this.props.annotations.TEXT.FORM.text}\r\n                </Typography>\r\n              );\r\n      }else{\r\n        this.props.annotations.TEXT.FORM.forEach((f) => {\r\n            wholeTranscriptions.push(\r\n                <Typography key={\"textForm\"+f.kindOf} hidden={(!this.state.displayOptions.textTranscriptions) || (!this.state.displayOptions.textTranscriptions.includes(f.kindOf))} variant=\"body2\" component=\"p\" className={\"text-\" + f.kindOf + \" transcription\"}>\r\n                  {f.text}\r\n                </Typography>\r\n              );\r\n          });\r\n      }\r\n    }\r\n//// \r\n    // Get whole translation(s) of the doc\r\n    if(this.props.annotations.TEXT.TRANSL !== null && this.props.annotations.TEXT.TRANSL !== undefined){\r\n      if(this.props.annotations.TEXT.TRANSL.length === undefined){\r\n\r\n        wholeTranslations.push(\r\n                <Typography hidden={!this.state.displayOptions.textTranslations.includes(this.props.annotations.TEXT.TRANSL[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`translation text-${this.props.annotations.TEXT.TRANSL['xml:lang']}`}>\r\n                  {this.props.annotations.TEXT.TRANSL.text}\r\n                </Typography>\r\n              );\r\n      }else{\r\n        this.props.annotations.TEXT.TRANSL.forEach((t) => {\r\n            wholeTranslations.push(\r\n                <Typography hidden={!this.state.displayOptions.textTranslations.includes(t[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`translation text-${t['xml:lang']}`}>\r\n                  {t.text}\r\n                </Typography>\r\n              );\r\n          });\r\n      }\r\n    }\r\n\r\n    // Get note(s) of the doc\r\n    if(this.props.annotations.TEXT.NOTE !== undefined && this.props.annotations.TEXT.NOTE !== null){\r\n      if(this.props.annotations.TEXT.NOTE.length === undefined){\r\n        notes.push(\r\n                <Typography hidden={!this.state.displayOptions.notes.includes(this.props.annotations.TEXT.NOTE[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`note ${this.props.annotations.TEXT.NOTE['xml:lang']}`}>\r\n                  {this.props.annotations.TEXT.NOTE.message}\r\n                </Typography>\r\n              );\r\n      }else{\r\n        this.props.annotations.TEXT.NOTE.forEach((t) => {\r\n            notes.push(\r\n                <Typography hidden={!this.state.displayOptions.notes.includes(t[\"xml:lang\"])} variant=\"body2\" component=\"p\" className={`note ${t['xml:lang']}`}>\r\n                  {t.message}\r\n                </Typography>\r\n              );\r\n          });\r\n      }\r\n    }\r\n\r\n//\r\n\r\n    return (\r\n      <div ref={el => (this.instance = el)}>\r\n        <div className=\"TEXT\">\r\n          <Container fixed id=\"documentTranscriptionsBlock\">\r\n                 {wholeTranscriptions}\r\n          </Container>\r\n          <Container fixed id=\"documentTranslationsBlock\">\r\n                 {wholeTranslations}\r\n          </Container>\r\n          <Container fixed id=\"documentNotesBlock\">\r\n                 {notes}\r\n          </Container>\r\n        </div>\r\n        <Container fixed id=\"documentAnnotationsBlock\">\r\n          {\r\n            isWordList\r\n              ?\r\n              <table>\r\n                {annotationItems}\r\n              </table>\r\n              :\r\n              annotationItems\r\n          }\r\n              \r\n        </Container>\r\n        {\r\n          this.props.extensionFile==='pdf' \r\n            ?\r\n            <Container>\r\n              <object data={this.props.urlFile.replace('http:','https:')} type=\"application/pdf\" width=\"100%\" height=\"500px\">\r\n                <embed src={this.props.urlFile.replace('http:','https:')} type='application/pdf'/>\r\n              </object>\r\n\r\n            </Container>\r\n            :\r\n            <div></div>\r\n          }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Annotations;","import React, { Component } from \"react\";\r\nimport Container from '@material-ui/core/Container';\r\n\r\n//import Metadata from './Components/Metadata';\r\nimport DisplayOptions from './player/DisplayOptions';\r\nimport Player from './player/Player';\r\nimport Annotations from './player/Annotations';\r\n\r\n//import './App.css';\r\n\r\n\r\nexport default class DocumentPreview extends Component {\r\n  \r\n  /*\r\n  ** Convert the annotations to fit with the Pangloss Player\r\n  */\r\n  convertToPlayerFormat(annotationsEditor){\r\n\r\n    var annotationsPlayer = {};\r\n    var timeList = [];\r\n    var isWordList = (annotationsEditor.children_annotations && annotationsEditor.children_annotations[0].type === \"W\");\r\n\r\n    annotationsPlayer.WORDLIST = {};\r\n\r\n    annotationsPlayer.TEXT = {};\r\n    annotationsPlayer.TEXT.FORM = annotationsEditor.forms;\r\n    annotationsPlayer.TEXT.TRANSL = [];\r\n\r\n    annotationsEditor.translations.forEach((t)=>{\r\n      annotationsPlayer.TEXT.TRANSL.push({\r\n        'xml:lang':t.lang,\r\n        text:t.text\r\n      });\r\n    });\r\n\r\n    annotationsPlayer.WORDLIST.W = [];\r\n    annotationsPlayer.TEXT.S = [];\r\n\r\n    !isWordList && annotationsEditor.children_annotations.forEach((s)=>{\r\n      var sentence = {};\r\n      sentence.AUDIO = {};\r\n      sentence.FORM = s.forms;\r\n      sentence.TRANSL = [];\r\n\r\n      s.translations.forEach((t)=>{\r\n        sentence.TRANSL.push({\r\n          'xml:lang':t.lang,\r\n          text:t.text\r\n        });\r\n      });\r\n\r\n      sentence.id = s.type+s.rank;\r\n      //14/07/2022 Adapt pour multi selection image\r\n      /*\r\n      if(s.areaCoords!==null){\r\n        sentence.AREA = {};\r\n        sentence.AREA.image = \"image\"+s.image_id;\r\n        sentence.AREA.shape = \"rect\";\r\n        sentence.AREA.coords = s.areaCoords;\r\n      }\r\n*/  \r\n      if(s.imageCoords!==null){\r\n        sentence.AREA = [];\r\n        s.imageCoords.forEach((i)=>{\r\n          sentence.AREA.push({\r\n            image:\"image\"+i.image_id,\r\n            shape:\"rect\",\r\n            coords:i.areaCoords\r\n          });\r\n        });\r\n      }\r\n\r\n      \r\n      sentence.AUDIO.start = s.audioStart;\r\n      sentence.AUDIO.end = s.audioEnd;\r\n\r\n      timeList.push({\r\n        start:s.audioStart,\r\n        end:s.audioEnd,\r\n        sentence:sentence.id,\r\n        word:null,\r\n        morpheme:null,\r\n        type:'S'\r\n      });\r\n\r\n      if(s.children_annotations.length > 0){\r\n              sentence.W = [];\r\n\r\n              s.children_annotations.forEach((w)=>{\r\n                      var word = {};\r\n                      word.AUDIO = {};\r\n                      word.FORM = w.forms;\r\n                      word.TRANSL = [];\r\n\r\n                      w.translations.forEach((t)=>{\r\n                        word.TRANSL.push({\r\n                          'xml:lang':t.lang,\r\n                          text:t.text\r\n                        });\r\n                      });\r\n\r\n                      word.id = sentence.id+w.type+w.rank;\r\n                      /*\r\n                      if(w.areaCoords!==null){\r\n                        word.AREA = {};\r\n                        word.AREA.image = \"image\"+w.image_id;\r\n                        word.AREA.shape = \"rect\";\r\n                        word.AREA.coords = w.areaCoords;\r\n                      }*/\r\n\r\n                      if(w.imageCoords!==null){\r\n                        //15/07/2022 : multi image : par convention on n'a qu'une bote pour un mot\r\n                        word.AREA = {};\r\n                        word.AREA.image = \"image\"+w.imageCoords[0].image_id;\r\n                        word.AREA.shape = \"rect\";\r\n                        word.AREA.coords = w.imageCoords[0].areaCoords;\r\n                      }\r\n                      \r\n\r\n                      word.AUDIO.start = w.audioStart;\r\n                      word.AUDIO.end = w.audioEnd;\r\n\r\n                      timeList.push({\r\n                        start:w.audioStart,\r\n                        end:w.audioEnd,\r\n                        sentence:sentence.id,\r\n                        word:word.id,\r\n                        morpheme:null,\r\n                        type:'W'\r\n                      });\r\n\r\n                      if(w.children_annotations.length > 0){\r\n                          word.M = [];\r\n\r\n                          w.children_annotations.forEach((m)=>{\r\n                                  var morph = {};\r\n                                  morph.AUDIO = {};\r\n                                  morph.FORM = m.forms;\r\n                                  morph.TRANSL = [];\r\n\r\n                                  m.translations.forEach((t)=>{\r\n                                    morph.TRANSL.push({\r\n                                      'xml:lang':t.lang,\r\n                                      text:t.text\r\n                                    });\r\n                                  });\r\n\r\n                                  morph.id = word.id+m.type+m.rank;\r\n                                  if(m.areaCoords!==null){\r\n                                    morph.AREA = {};\r\n                                    morph.AREA.image = \"image\" + m.image_id;\r\n                                    morph.AREA.shape = \"rect\";\r\n                                    morph.AREA.coords = m.areaCoords;\r\n                                  }\r\n\r\n                                  morph.AUDIO.start = m.audioStart;\r\n                                  morph.AUDIO.end = m.audioEnd;\r\n\r\n                                  timeList.push({\r\n                                    start:m.audioStart,\r\n                                    end:m.audioEnd,\r\n                                    sentence:sentence.id,\r\n                                    word:word.id,\r\n                                    morpheme:morph,\r\n                                    type:'M'\r\n                                  });\r\n\r\n                                  word.M.push(morph);\r\n                          });\r\n                      }\r\n                      \r\n                      sentence.W.push(word);\r\n              });\r\n      }\r\n\r\n      annotationsPlayer.TEXT.S.push(sentence);\r\n\r\n    });\r\n\r\n    isWordList && annotationsEditor.children_annotations.forEach((w)=>{\r\n\r\n        var word = {};\r\n        word.AUDIO = {};\r\n        word.FORM = w.forms;\r\n        word.TRANSL = [];\r\n\r\n        w.translations.forEach((t)=>{\r\n          word.TRANSL.push({\r\n            'xml:lang':t.lang,\r\n            text:t.text\r\n          });\r\n        });\r\n\r\n        word.id = w.type+w.rank;\r\n\r\n        if(w.areaCoords!==null){\r\n          word.AREA = {};\r\n          word.AREA.image = \"image\"+w.image_id;\r\n          word.AREA.shape = \"rect\";\r\n          word.AREA.coords = w.areaCoords;\r\n        }\r\n        \r\n\r\n        word.AUDIO.start = w.audioStart;\r\n        word.AUDIO.end = w.audioEnd;\r\n\r\n        timeList.push({\r\n          start:w.audioStart,\r\n          end:w.audioEnd,\r\n          sentence:null,\r\n          word:word.id,\r\n          morpheme:null,\r\n          type:'W'\r\n        });\r\n\r\n        if(w.children_annotations.length > 0){\r\n            word.M = [];\r\n            w.children_annotations.forEach((m)=>{\r\n                var morph = {};\r\n                morph.AUDIO = {};\r\n                morph.FORM = m.forms;\r\n                morph.TRANSL = [];\r\n\r\n                m.translations.forEach((t)=>{\r\n                  morph.TRANSL.push({\r\n                    'xml:lang':t.lang,\r\n                    text:t.text\r\n                  });\r\n                });\r\n\r\n                morph.id = word.id+m.type+m.rank;\r\n                if(m.areaCoords!==null){\r\n                  morph.AREA = {};\r\n                  morph.AREA.image = \"image\" + m.image_id;\r\n                  morph.AREA.shape = \"rect\";\r\n                  morph.AREA.coords = m.areaCoords;\r\n                }\r\n\r\n                morph.AUDIO.start = m.audioStart;\r\n                morph.AUDIO.end = m.audioEnd;\r\n\r\n                timeList.push({\r\n                  start:m.audioStart,\r\n                  end:m.audioEnd,\r\n                  sentence:null,\r\n                  word:word.id,\r\n                  morpheme:morph,\r\n                  type:'M'\r\n                });\r\n\r\n                word.M.push(morph);\r\n            });\r\n        }\r\n        \r\n        annotationsPlayer.WORDLIST.W.push(word);\r\n\r\n    });\r\n\r\n    return {\r\n      annotations:annotationsPlayer,\r\n      timeList:timeList\r\n    };\r\n\r\n  }\r\n\r\n  constructor(props) {\r\n\r\n      super(props);\r\n      this.state = {\r\n        hasPrimaryId : false,\r\n        hasSecondaryId : false,\r\n        isLoaded : false,\r\n        isAnnotationsLoaded : false,\r\n        hasMediaError : false,\r\n        mediaError : {},\r\n      hasAnnotationsError : false,\r\n        annotationsError : {},\r\n          MEDIAFILE : {},\r\n      annotations : {},\r\n      doi : '',\r\n      images : [],\r\n      /*displayOptions: this.props.displayOptions,*/\r\n      langOptions : {\r\n        transcriptions:[],translations:[]\r\n      },\r\n      /*options : this.props.typeOf,*/\r\n      isWordList : false,\r\n      timeList : [],\r\n      urlFile : '',\r\n      extensionFile : '',\r\n      playerLoaded : false\r\n      };\r\n    }\r\n\r\n     playerIsLoaded() {\r\n      this.setState({\r\n        playerLoaded: true\r\n      })\r\n    }\r\n\r\n\r\n  componentDidMount(){\r\n\r\n      this.setState({\r\n        //langOptions: result.langues,\r\n        //options: result.typeOf,\r\n        //timeList: result.timeList,\r\n          isAnnotationsLoaded: true,\r\n          annotations : this.convertToPlayerFormat(this.props.annotations[0]).annotations,\r\n          //doi : result.doi,\r\n          isWordList : (this.props.annotations[0].children_annotations[0].type === \"W\"),\r\n          urlFile : '',\r\n          extensionFile : '',\r\n          MEDIAFILE : {\"type\":\"audio\",\"url\":'',\"content\":this.props.recording?this.props.recording['TO_BASE64(content)']:null},\r\n          //images : result.images\r\n          displayOptions: this.props.displayOptions,\r\n            isLoaded: true\r\n      });\r\n\r\n      //Adaptation 18/09/2021 pour use case Image Only\r\n      //Mise en lumire du mot sur l'image\r\n      window.highlight=function highlight(id,type){\r\n\r\n        if(type!==\"S\"){\r\n\r\n          document.querySelectorAll('canvas:not([wordid=\"\"]').forEach(e => { \r\n                    e.style.border='none'; \r\n                  });\r\n          document.querySelectorAll('[wordid=\"'+id+'\"]').forEach(e => { \r\n                    e.style.border='solid'; \r\n                  });\r\n\r\n          document.querySelectorAll('.WORD').forEach(e => { \r\n                    e.style.border='none'; \r\n                  });\r\n\r\n          document.querySelector('#'+id).style.border='solid';\r\n        }\r\n\r\n      };\r\n\r\n    }\r\n\r\n    render(){\r\n\r\n      var convertedAnnotations = this.convertToPlayerFormat(this.props.annotations[0]);\r\n      var annotationsPlayer = convertedAnnotations.annotations;\r\n      var timeList = convertedAnnotations.timeList;\r\n      var images = [];\r\n\r\n      this.props.images.forEach((i)=>{\r\n        images.push({\r\n          id:\"image\" + i.id,\r\n          name:i.name,\r\n          rank:i.rank,\r\n          /*content:i[\"TO_BASE64(content)\"]*/\r\n        });\r\n      });\r\n\r\n\r\n      return (\r\n        <div className=\"AppPlayer\" key=\"AppPlayer\"> \r\n            <Container>\r\n              {this.props.recording && <Player file={{\"type\":\"audio\",\"url\":'',\"content\":this.props.recording['TO_BASE64(content)']}} playerIsLoaded = {this.playerIsLoaded.bind(this)} />\r\n}\r\n              <DisplayOptions displayOptions={this.props.displayOptions} options={this.props.typeOf} isWordList={this.state.isWordList} />\r\n              {\r\n              this.props.recording && this.state.playerLoaded && \r\n              <Annotations \r\n                annotations={annotationsPlayer} \r\n                timeList={timeList} \r\n                urlFile={this.state.urlFile} \r\n                extensionFile={this.state.extensionFile} \r\n                doi={this.state.doi} \r\n                availableOptions={this.props.typeOf} \r\n                displayOptions={this.props.displayOptions} \r\n                images={images} \r\n                video={this.state.MEDIAFILE.type===\"video\"} \r\n              />\r\n              }\r\n\r\n              {\r\n              !this.props.recording && \r\n              <Annotations \r\n                annotations={annotationsPlayer} \r\n                timeList={timeList} \r\n                urlFile={this.state.urlFile} \r\n                extensionFile={this.state.extensionFile} \r\n                doi={this.state.doi} \r\n                availableOptions={this.props.typeOf} \r\n                displayOptions={this.props.displayOptions} \r\n                images={images} \r\n                video={this.state.MEDIAFILE.type===\"video\"} />\r\n              }\r\n              </Container>\r\n          </div>\r\n\r\n      );\r\n    }\r\n  \r\n}\r\n","import React, { Component } from \"react\";\r\nimport Container from '@material-ui/core/Container';\r\n\r\nexport default class DocumentExport extends Component {\r\n  \r\n  constructor(props) {\r\n      super(props);\r\n    }\r\n\r\n    render(){\r\n      return (\r\n        <div> \r\n          <Container>\r\n            Export options : xml, LateX\r\n          </Container>\r\n        </div>\r\n      );\r\n    }\r\n  \r\n}\r\n","import React, { Component  } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { BrowserRouter, withRouter } from \"react-router-dom\";\nimport \"./App.css\";\n\nimport AuthService from \"./services/auth.service\";\n\nimport Login from \"./components/login.component\";\nimport Register from \"./components/register.component\";\nimport Home from \"./components/home.component\";\nimport Profile from \"./components/profile.component\";\nimport Documents from \"./components/documents.component\";\nimport Document from \"./components/document.component\";\n\nimport Container from '@material-ui/core/Container';\nimport Button from '@material-ui/core/Button';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport MenuIcon from '@material-ui/icons/Menu';\n\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport CloseIcon from '@material-ui/icons/Close';\nimport LogIcon from '@material-ui/icons/ExitToApp';\nimport RegisterIcon from '@material-ui/icons/AssignmentInd';\nimport ProfileIcon from '@material-ui/icons/AccountCircle';\nimport DocumentsIcon from '@material-ui/icons/FolderOpen';\n\nimport {\n  createMuiTheme,\n  MuiThemeProvider\n} from \"@material-ui/core/styles\";\n\n\nconst theme = createMuiTheme({\n  palette: {\n    type: 'light',\n    primary: {\n      main: '#1d2654',\n    },\n    secondary: {\n      main: '#00a096',\n    },\n    background: {\n      default: '#ede7f6',\n    },\n  },\n  typography: {\n    fontFamily: [\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Chivo\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(','),\n\n  }\n});\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.logOut = this.logOut.bind(this);\n\n    this.state = {\n      currentUser: undefined,\n      openMenu: false,\n      anchorRef: React.createRef()\n    };\n  }\n\n  componentDidMount() {\n    const user = AuthService.getCurrentUser();\n\n    if (user) {\n      this.setState({\n        currentUser: user,\n        //showModeratorBoard: user.roles.includes(\"ROLE_MODERATOR\"),\n        //showAdminBoard: user.roles.includes(\"ROLE_ADMIN\"),\n      });\n    }\n  }\n\n  logOut() {\n    AuthService.logout();\n    this.props.history.push('/login');\n  }\n\n  handleToggle = () => {\n    this.setState({\n        openMenu: true\n      });\n  };\n\n  handleCloseMenu = (event) => {\n    this.setState({\n        openMenu: false\n      });\n  };\n\n  handleListKeyDown(event) {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      this.setState({\n        openMenu: false\n      });\n    }\n  }\n\n  redirect=()=> {\n    window.location.href = this.state.notificationLink;\n  }\n\n  render() {\n    const { openMenu, anchorRef } = this.state;\n\n    return (\n      <MuiThemeProvider theme={theme}>\n      <div>\n        <Button\n          ref={anchorRef}\n          aria-controls={openMenu ? 'menu-list-grow' : undefined}\n          aria-haspopup=\"true\"\n          onClick={this.handleToggle}\n        >\n          <MenuIcon />\n        </Button>\n        <Popper open={openMenu}  role={undefined} anchorEl={anchorRef.current} transition disablePortal>\n          {({ TransitionProps, placement }) => (\n            <Grow\n              {...TransitionProps}\n              style={{ transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom' }}\n            >\n              <Paper>\n                <ClickAwayListener onClickAway={this.handleCloseMenu}>\n                  <MenuList autoFocusItem={openMenu} id=\"menu-list-grow\" onKeyDown={this.handleListKeyDown}>\n                    { \n                      typeof this.state.currentUser === 'undefined' ?\n                      <div>\n                        <MenuItem>\n                          <Button\n                            component={Link}\n                            to='/login'\n                            startIcon={<LogIcon />}\n                            disableElevation\n                          >\n                            Login\n                          </Button>\n                        </MenuItem>\n                        <MenuItem>\n                          <Button\n                            component={Link}\n                            to='/register'\n                            startIcon={<RegisterIcon />}\n                            disableElevation\n                          >\n                            Sign Up\n                          </Button>\n                        </MenuItem>\n                      </div>\n                    :\n                    <div>\n                      <MenuItem >\n                        <Button\n                            component={Link}\n                            to='/profile'\n                            startIcon={<ProfileIcon />}\n                            disableElevation\n                            onClick={this.handleCloseMenu}\n                          >\n                          My Profile\n                        </Button>\n                      </MenuItem>\n                      <MenuItem >\n                        <Button\n                            component={Link}\n                            to='/documents'\n                            startIcon={<DocumentsIcon />}\n                            disableElevation\n                            onClick={this.handleCloseMenu}\n                          >\n                          My documents\n                        </Button>\n                      </MenuItem>\n                      <MenuItem>\n                        <Button\n                            component={Link}\n                            startIcon={<LogIcon />}\n                            disableElevation\n                            onClick={this.logOut}\n                          >\n                          Logout\n                        </Button>\n                      </MenuItem>\n                    </div>\n                  }\n                  </MenuList>\n                </ClickAwayListener>\n              </Paper>\n            </Grow>\n          )}\n        </Popper>\n\n        <Container className=\"container mt-3\">\n            <Switch>\n              <Route exact path={[\"/\", \"/home\"]} component={Home} />\n              <Route path=\"/login\" component={Login} />\n              <Route path=\"/register\" component={Register} />\n              <Route path=\"/profile\" component={Profile} />\n              <Route path=\"/documents/:docId\" component={Document} />\n              <Route path=\"/documents\" component={Documents} />\n            </Switch>\n\n          \n        </Container>\n\n      </div>\n\n      </MuiThemeProvider>\n    );\n  }\n}\n\nexport default withRouter(App);\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// translation.js\r\n//https://github.com/amsul/react-translated#static-text\r\nvar translations = {\r\n  'Continuous play': {\r\n    en: 'Continuous play',\r\n    fr: 'Lecture en continu',\r\n  },'other': {\r\n    en: 'other',\r\n    fr: 'autre',\r\n  },'Text transcription': {\r\n    en: 'Text transcription',\r\n    fr: 'Transcription du texte',\r\n  },\r\n  'Display options': {\r\n    en: 'Display options',\r\n    fr: 'Options d\\'affichage',\r\n  },\r\n  'Text translation': {\r\n    en: 'Text translation',\r\n    fr: 'Traduction du texte',\r\n  },\r\n  'Sentence transcription': {\r\n    en: 'Sentence transcription',\r\n    fr: 'Transcription des phrases',\r\n  },\r\n  'Sentence translation': {\r\n    en: 'Sentence translation',\r\n    fr: 'Traduction des phrases',\r\n  },\r\n  'Word transcription': {\r\n    en: 'Word transcription',\r\n    fr: 'Transcription des mots',\r\n  },\r\n  'Word translation': {\r\n    en: 'Word translation',\r\n    fr: 'Traduction des mots',\r\n  },\r\n  'Morpheme transcription': {\r\n    en: 'Morpheme transcription',\r\n    fr: 'Transcription des morphmes',\r\n  },\r\n  'Morpheme translation': {\r\n    en: 'Morpheme translation',\r\n    fr: 'Traduction des morphmes',\r\n  },\r\n  'Words': {\r\n    en: 'Words',\r\n    fr: 'Mot  mot',\r\n  },\r\n  \r\n\r\n  // ...\r\n}\r\n\r\nexport default translations;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { BrowserRouter } from \"react-router-dom\";\nimport { Provider } from 'react-translated';\nimport translation from './translation';\n\nReactDOM.render(\n  <BrowserRouter basename=\"/editor\">\n    <Provider language=\"en\" translation={translation}>\n      <App />\n    </Provider>\n  </BrowserRouter>,\n  document.getElementById(\"root\")\n);\n\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}