(this.webpackJsonpeastlingeditor=this.webpackJsonpeastlingeditor||[]).push([[0],{310:function(e,t,n){},311:function(e,t,n){},501:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(22),i=n.n(o),r=(n(310),n(36)),l=n(7),c=n(8),d=n(38),p=n(12),h=n(11),u=n(27),m=n(33),g=(n(311),n(18)),j=n.n(g),b={API_URL:"localhost"===window.location.hostname?"http://localhost:8000/api/":"https://eastling.huma-num.fr/api/"},f=b.API_URL+"auth/",O=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"login",value:function(e,t){return j.a.post(f+"login",{username:e,password:t}).then((function(e){return e.data.token&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))}},{key:"logout",value:function(){localStorage.removeItem("user")}},{key:"register",value:function(e,t,n){return j.a.post(f+"signup",{username:e,email:t,password:n})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),e}()),x=n(148),v=n.n(x),y=n(510),w=n(580),S=n(104),C=n(557),T=n(203),E=n(511),k=n(288),A=n(555),D=n(558),N=n(575),I=n(257),R=n.n(I),L=n(167),F=n(5),_=n(556),P=n(1);function M(){return Object(P.jsxs)(L.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(P.jsx)(A.a,{color:"inherit",href:"https://eastling.huma-num.fr",children:"Matthew DEO / LACITO (C.N.R.S)"})," ",(new Date).getFullYear(),"."]})}var W=function(e){if(!e)return Object(P.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},U=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleLogin=a.handleLogin.bind(Object(d.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.state={username:"",password:"",loading:!1,message:""},a}return Object(c.a)(n,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0}),this.form.validateAll(),O.login(this.state.username,this.state.password).then((function(){t.props.history.push("/documents"),window.location.reload()}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({loading:!1,message:n})}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(P.jsxs)(_.a,{component:"main",maxWidth:"xs",children:[Object(P.jsx)(C.a,{}),Object(P.jsxs)("div",{className:t.paper,children:[Object(P.jsx)(w.a,{className:t.avatar,children:Object(P.jsx)(R.a,{})}),Object(P.jsx)(L.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(P.jsxs)(v.a,{className:t.form,onSubmit:this.handleLogin,ref:function(t){e.form=t},children:[Object(P.jsx)(T.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:this.state.username,onChange:this.onChangeUsername,validations:[W]}),Object(P.jsx)(T.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",className:"form-control",value:this.state.password,onChange:this.onChangePassword,validations:[W]}),this.state.loading&&Object(P.jsx)(_.a,{children:Object(P.jsx)(y.a,{})}),!this.state.loading&&Object(P.jsxs)("div",{children:[Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{value:"remember",color:"primary"}),label:"Remember me"}),Object(P.jsx)(S.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,children:"Sign In"}),Object(P.jsxs)(D.a,{container:!0,children:[Object(P.jsx)(D.a,{item:!0,xs:!0,children:Object(P.jsx)(A.a,{href:"#",variant:"body2",children:"Forgot password?"})}),Object(P.jsx)(D.a,{item:!0,children:Object(P.jsx)(A.a,{href:"#",variant:"body2",children:"Don't have an account? Sign Up"})})]})]})]})]}),Object(P.jsx)(N.a,{mt:8,children:Object(P.jsx)(M,{})})]})}}]),n}(a.Component),B=Object(F.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}))(U),z=n(166),X=n.n(z),q=n(258),V=n.n(q),H=n(259),K=function(e){if(!e)return Object(P.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This field is required!"})},G=function(e){if(!Object(H.isEmail)(e))return Object(P.jsx)("div",{className:"alert alert-danger",role:"alert",children:"This is not a valid email."})},J=function(e){if(e.length<3||e.length>20)return Object(P.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The username must be between 3 and 20 characters."})},Y=function(e){if(e.length<6||e.length>40)return Object(P.jsx)("div",{className:"alert alert-danger",role:"alert",children:"The password must be between 6 and 40 characters."})},$=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleRegister=a.handleRegister.bind(Object(d.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.state={username:"",email:"",password:"",successful:!1,message:""},a}return Object(c.a)(n,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleRegister",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",successful:!1}),this.form.validateAll(),0===this.checkBtn.context._errors.length&&O.register(this.state.username,this.state.email,this.state.password).then((function(e){t.setState({message:e.data.message,successful:!0})}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({successful:!1,message:n})}))}},{key:"render",value:function(){var e=this;return Object(P.jsx)("div",{className:"col-md-12",children:Object(P.jsxs)("div",{className:"card card-container",children:[Object(P.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(P.jsxs)(v.a,{onSubmit:this.handleRegister,ref:function(t){e.form=t},children:[!this.state.successful&&Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"username",children:"Username"}),Object(P.jsx)(X.a,{type:"text",className:"form-control",name:"username",value:this.state.username,onChange:this.onChangeUsername,validations:[K,J]})]}),Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"email",children:"Email"}),Object(P.jsx)(X.a,{type:"text",className:"form-control",name:"email",value:this.state.email,onChange:this.onChangeEmail,validations:[K,G]})]}),Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"password",children:"Password"}),Object(P.jsx)(X.a,{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.onChangePassword,validations:[K,Y]})]}),Object(P.jsx)("div",{className:"form-group",children:Object(P.jsx)("button",{className:"btn btn-primary btn-block",children:"Sign Up"})})]}),this.state.message&&Object(P.jsx)("div",{className:"form-group",children:Object(P.jsx)("div",{className:this.state.successful?"alert alert-success":"alert alert-danger",role:"alert",children:this.state.message})}),Object(P.jsx)(V.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})]})]})})}}]),n}(a.Component);function Q(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}}var Z=b.API_URL,ee=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"getUserDocuments",value:function(){return new Promise((function(e,t){j.a.get(Z+"documents",{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}}]),e}()),te=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={currentUser:O.getCurrentUser()},null===O.getCurrentUser()?a.props.history.push("/login"):a.props.history.push("/documents"),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(P.jsx)("div",{className:"container",children:Object(P.jsx)("header",{className:"jumbotron",children:Object(P.jsx)("h3",{children:this.state.content})})})}}]),n}(a.Component),ne=Object(m.f)(te),ae=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={currentUser:O.getCurrentUser(),currentUserDocuments:[]},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){null===O.getCurrentUser()&&this.props.history.push("/login")}},{key:"render",value:function(){return null!==this.state.currentUser?Object(P.jsxs)(_.a,{children:[Object(P.jsx)("header",{className:"jumbotron",children:Object(P.jsx)("h3",{children:"Profile"})}),Object(P.jsxs)("p",{children:[Object(P.jsx)("strong",{children:"Username:"})," ",this.state.currentUser.username]}),Object(P.jsxs)("p",{children:[Object(P.jsx)("strong",{children:"Email:"})," ",this.state.currentUser.email]}),Object(P.jsxs)("p",{children:[Object(P.jsx)("strong",{children:"Organization:"})," ",this.state.currentUser.organization]})]}):Object(P.jsx)("div",{})}}]),n}(a.Component),se=Object(m.f)(ae),oe=b.API_URL,ie=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"import",value:function(e,t){var n=new FormData;return n.append("file",e),n.append("docId",t),Q["Content-Type"]="multipart/form-data",new Promise((function(e,t){j.a.post(oe+"import",n,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"get",value:function(e){return j.a.get(oe+"documents/"+e,{headers:Q()}).then((function(e){return e.data}))}},{key:"create",value:function(e,t){var n=new FormData;return n.append("lang",e),n.append("type",t),Q["Content-Type"]="application/x-www-form-urlencoded",new Promise((function(e,t){j.a.post(oe+"documents",n,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"update",value:function(e,t){return Q["Content-Type"]="application/json",new Promise((function(n,a){j.a.put(oe+"documents/"+e,t,{headers:Q()}).then((function(e){n(e)})).catch((function(e){a(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(oe+"documents/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),re=b.API_URL,le=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"getDocumentAnnotations",value:function(e){return new Promise((function(t,n){j.a.get(re+"documents/"+e+"/annotations",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"getAnnotationChildren",value:function(e){return new Promise((function(t,n){j.a.get(re+"annotations/"+e+"/children",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"get",value:function(e){return j.a.get(re+"annotations/"+e,{headers:Q()}).then((function(e){return e.data}))}},{key:"update",value:function(e,t){return Q["Content-Type"]="application/json",new Promise((function(n,a){j.a.put(re+"annotations/"+e,t,{headers:Q()}).then((function(e){n(e)})).catch((function(e){a(e)}))}))}},{key:"create",value:function(e){return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.post(re+"annotations",e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(re+"annotations/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),ce=n(159),de=n(103),pe=n(78),he=n.n(pe),ue=n(44),me=n.n(ue),ge=n(92),je=n.n(ge),be=n(261),fe=n.n(be),Oe=n(158),xe=n.n(Oe),ve=n(559),ye=n(563),we=n(561),Se=n(562),Ce=n(560),Te=n(80),Ee=n(124),ke=n(168),Ae=n(113),De=n(581),Ne=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleCloseCreateDialog=function(e){a.setState({openCreateDialog:!1})},a.handleOpenCreateDialog=function(e){a.setState({openCreateDialog:!0})},a.handleCloseDeleteDialog=function(e){a.setState({openDeleteDialog:!1})},a.handleOpenDeleteDialog=function(e){a.setState({openDeleteDialog:!0})},a.handleLangChange=function(e){a.setState({langCorpus:e.target.value})},a.handleTypeChange=function(e){a.setState({typeOfDocument:e.target.value})},a.handleCreateDocument=function(e){e.preventDefault(),a.setState({loading:!0}),ie.create(a.state.langCorpus,a.state.typeOfDocument).then((function(e){var t={document_id:e.data.id,type:"T",rank:1};le.create(t).then((function(t){a.props.history.push("/documents/"+e.data.id+"?tab=0")}),(function(e){var t=e.responseAnnotation&&e.responseAnnotation.data&&e.responseAnnotation.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))}),(function(e){var t=e.responseDoc&&e.responseDoc.data&&e.responseDoc.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))},a.handleDeleteDocument=function(e){a.setState({loading:!0}),ie.delete(a.state.documentToDelete).then((function(e){window.location.reload()}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))},a.state={currentUser:O.getCurrentUser(),currentUserDocuments:[],openCreateDialog:!1,openDeleteDialog:!1,typeOfDocument:"TEXT",langCorpus:"",loading:!1,documentToDelete:null},null===O.getCurrentUser()&&a.props.history.push("/login"),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),null!==this.state.currentUser&&ee.getUserDocuments().then((function(t){e.setState({currentUserDocuments:t.data,loading:!1})}),(function(t){401===t.response.status&&e.props.history.push("/login"),e.setState({currentUserDocuments:t.response&&t.response.data||t.message||t.toString(),loading:!1})}))}},{key:"render",value:function(){var e=this;if(null!==this.state.currentUser){var t=[{field:"id",headerName:"ID",width:90},{field:"titles",headerName:"Title(s)",width:300,renderCell:function(e){return Object(P.jsx)(_.a,{variant:"contained",color:"primary",size:"small",component:"div",children:e.value.map((function(e){return Object(P.jsx)(De.a,{avatar:Object(P.jsx)(w.a,{children:e.lang.toUpperCase()}),label:e.title,color:"secondary"},e.id)}))})}},{field:"lang",headerName:"Language",width:120,editable:!0,renderCell:function(e){return Object(P.jsx)(_.a,{variant:"contained",color:"primary",size:"small",component:"div",children:Object(P.jsx)(De.a,{label:e.value,color:"secondary"},e.id)})}},{field:"type",headerName:"Type",width:120,editable:!0},{field:"actions",headerName:"Actions",width:200,editable:!1,renderCell:function(t){return Object(P.jsxs)("div",{id:"actionsDocument_"+t.id,children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Edit document",onClick:function(){return e.props.history.push("/documents/"+t.id+"?tab=0")},children:Object(P.jsx)(je.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Download document",children:Object(P.jsx)(xe.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Send document for deposit",children:Object(P.jsx)(fe.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Delete document",onClick:function(){e.setState({openDeleteDialog:!0,documentToDelete:t.id})},children:Object(P.jsx)(he.a,{})})]})}}],n=[];return"string"!==typeof this.state.currentUserDocuments&&this.state.currentUserDocuments.length>0&&this.state.currentUserDocuments.forEach((function(e){n.push({key:e.id,id:e.id,titles:e.titles,lang:e.lang,type:e.type,actions:e.id})})),Object(P.jsxs)(_.a,{children:[Object(P.jsx)("header",{className:"jumbotron",children:Object(P.jsx)("h3",{children:"My documents"})}),Object(P.jsx)("div",{children:Object(P.jsxs)("div",{style:{height:600,width:"80%"},children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Add document",onClick:this.handleOpenCreateDialog,children:Object(P.jsx)(me.a,{})}),Object(P.jsxs)(ve.a,{open:this.state.openCreateDialog,onClose:this.handleCloseCreateDialog,"aria-labelledby":"form-createdialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-createdialog-title",children:"Create a new document"}),Object(P.jsxs)(we.a,{children:[Object(P.jsxs)(Se.a,{children:["Please refer to the ",Object(P.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://iso639-3.sil.org/code_tables/639/data/all",children:"ISO 639-3 code tables"}),"."]}),Object(P.jsxs)("form",{noValidate:!0,children:[Object(P.jsx)("div",{children:Object(P.jsx)(T.a,{autoFocus:!0,margin:"dense",id:"name",label:"Language ISO 639-3 Code",type:"text",fullWidth:!0,onChange:this.handleLangChange})}),Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{id:"select-type-label",children:"Type of document"}),Object(P.jsxs)(Ee.a,{labelId:"select-type-label",id:"type",value:this.state.typeOfDocument,onChange:this.handleTypeChange,children:[Object(P.jsx)(Te.a,{value:"TEXT",children:"Text"}),Object(P.jsx)(Te.a,{value:"WORDLIST",children:"Wordlist"})]})]})]})]}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseCreateDialog,color:"primary",children:"Cancel"}),Object(P.jsx)(S.a,{onClick:this.handleCreateDocument,color:"primary",children:"Create document"})]})]}),Object(P.jsxs)(ve.a,{open:this.state.openDeleteDialog,onClose:this.handleCloseDeleteDialog,"aria-labelledby":"form-createdialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-deletedialog-title",children:"Delete a document"}),Object(P.jsx)(we.a,{children:Object(P.jsxs)(Se.a,{children:["Delete document ",this.state.documentToDelete," ?"]})}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseDeleteDialog,color:"primary",children:"Cancel"}),!this.state.loading&&Object(P.jsx)(S.a,{onClick:this.handleDeleteDocument,color:"primary",children:"Delete document"}),this.state.loading&&Object(P.jsx)(y.a,{})]})]}),this.state.loading?Object(P.jsx)(y.a,{size:"1.5rem"}):Object(P.jsx)(ce.a,{rows:n,columns:t,pageSize:10,checkboxSelection:!0,disableSelectionOnClick:!0})]})})]})}return Object(P.jsx)("div",{})}}]),n}(a.Component),Ie=Object(m.f)(Ne),Re=n(165),Le=n(568),Fe=n(576),_e=n(567),Pe=n(40),Me=n(79),We=n.n(Me),Ue=b.API_URL,Be=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"create",value:function(e){return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.post(Ue+"contributors",e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(Ue+"contributors/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"getDocumentContributors",value:function(e){return new Promise((function(t,n){j.a.get(Ue+"documents/"+e+"/contributors",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),ze=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleDelete=function(){a.setState({loading:!0}),Be.delete(a.props.contributor.id).then((function(e){a.setState({loading:!1}),a.props.getContributors()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(P.jsx)(De.a,{avatar:Object(P.jsx)(w.a,{children:this.props.contributor.type.charAt(0).toUpperCase()}),label:this.props.contributor.firstName+" "+this.props.contributor.lastName,onDelete:this.handleDelete,color:"secondary"})}}]),n}(a.Component),Xe=Object(m.f)(ze),qe=n(53),Ve=n.n(qe),He=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onContributorFirstNameChange=function(e){a.setState({firstname:e.target.value})},a.onContributorLastNameChange=function(e){a.setState({lastname:e.target.value})},a.onContributorTypeChange=function(e){a.setState({typeOfContributor:e.target.value})},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1});var e={firstName:a.state.firstname,lastName:a.state.lastname,type:a.state.typeOfContributor,document_id:a.props.documentId};Be.create(e).then((function(e){a.setState({loading:!1,firstname:"",lastname:""}),a.props.getContributors()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1,firstname:"",lastname:"",typeOfContributor:"annotator"},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hidden?"none":"";return Object(P.jsxs)(_.a,{style:{display:e},children:[this.state.loading&&Object(P.jsx)(y.a,{}),Object(P.jsx)(T.a,{label:"First Name",placeholder:"First Name",size:"small",value:this.state.firstname,onChange:this.onContributorFirstNameChange}),Object(P.jsx)(T.a,{label:"Last Name",placeholder:"Last Name",size:"small",value:this.state.lastname,onChange:this.onContributorLastNameChange}),Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{id:"select-type-label",children:"Type of contributor"}),Object(P.jsxs)(Ee.a,{labelId:"select-type-label",id:"type",value:this.state.typeOfContributor,onChange:this.onContributorTypeChange,children:[Object(P.jsx)(Te.a,{value:"speaker",children:"Speaker"}),Object(P.jsx)(Te.a,{value:"researcher",children:"Researcher"}),Object(P.jsx)(Te.a,{value:"annotator",children:"Annotator"})]})]}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,hidden:!(this.state.firstname.length>=1&&this.state.lastname.length>=1),children:Object(P.jsx)(Ve.a,{})})]})}}]),n}(a.Component),Ke=Object(m.f)(He),Ge=b.API_URL,Je=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"create",value:function(e){return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.post(Ge+"titles",e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(Ge+"titles/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"getDocumentTitles",value:function(e){return new Promise((function(t,n){j.a.get(Ge+"documents/"+e+"/titles",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),Ye=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleDelete=function(){a.setState({loading:!0}),Je.delete(a.props.title.id).then((function(e){a.setState({loading:!1}),a.props.getTitles()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(P.jsx)(De.a,{avatar:Object(P.jsx)(w.a,{children:this.props.title.lang.toUpperCase()}),label:this.props.title.title,onDelete:this.handleDelete,color:"secondary"})}}]),n}(a.Component),$e=Object(m.f)(Ye),Qe=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleDelete=function(){var e=a.props.list;e.splice(e.indexOf(a.props.lang),1),a.setState({loading:!0});var t={};"lang"===a.props.type?t.available_lang=e:t.available_kindOf=e,ie.update(a.props.documentId,t).then((function(t){a.setState({loading:!1,lang:""}),a.props.updateLanguages(a.props.type,e)}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(P.jsx)(De.a,{label:this.props.lang,onDelete:this.handleDelete,color:"secondary"})}}]),n}(a.Component),Ze=Object(m.f)(Qe),et=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),console.log(e.available_lang),(a=t.call(this,e)).onChange=function(e){a.setState(Object(Pe.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1});var e={lang:a.state.lang,title:a.state.title,document_id:a.props.documentId};Je.create(e).then((function(e){a.setState({loading:!1,lang:"",title:""}),a.props.getTitles()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1,lang:null!==e.available_lang&&e.available_lang.length>0?e.available_lang[0]:"",title:""},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hidden?"none":"";return Object(P.jsxs)(_.a,{style:{display:e},children:[this.state.loading&&Object(P.jsx)(y.a,{}),Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{htmlFor:"lang",children:"Language"}),Object(P.jsx)(Ee.a,{native:!0,value:this.state.lang,inputProps:{id:"lang"},onChange:this.onChange,children:this.props.available_lang&&this.props.available_lang.map((function(e){return Object(P.jsx)("option",{value:e,children:e})}))})]}),Object(P.jsx)(T.a,{id:"title",label:"Title",placeholder:"Title",size:"small",value:this.state.title,onChange:this.onChange}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,hidden:!(this.state.lang.length>=1&&this.state.title.length>=1),children:Object(P.jsx)(Ve.a,{})})]})}}]),n}(a.Component),tt=Object(m.f)(et),nt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onChange=function(e){a.setState({lang:e.target.value})},a.handleSubmit=function(){var e=null===a.props.list?[]:a.props.list;e.indexOf(a.state.lang)>0&&e.splice(e.indexOf(a.state.lang),1),e.push(a.state.lang),a.setState({loading:!0});var t={};"lang"===a.props.type?t.available_lang=e:t.available_kindOf=e,ie.update(a.props.documentId,t).then((function(t){a.setState({loading:!1,lang:""}),a.props.updateLanguages(a.props.type,e)}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1,lang:""},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hidden?"none":"";return Object(P.jsxs)(_.a,{style:{display:e},children:[this.state.loading&&Object(P.jsx)(y.a,{}),Object(P.jsx)(T.a,{id:"lang",label:"ISO 639\u20111 Code",placeholder:"ISO 639\u20111 Code",size:"medium",value:this.state.lang,onChange:this.onChange,inputProps:"lang"===this.props.type?{maxLength:2}:{}}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,hidden:!this.state.lang.length>=1,children:Object(P.jsx)(Ve.a,{})})]})}}]),n}(a.Component),at=Object(m.f)(nt),st=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).getContributors=function(){a.setState({loading:!0}),Be.getDocumentContributors(a.props.document.id).then((function(e){a.setState({loading:!1,contributors:e.data,openNewContributor:!1})}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.getTitles=function(){a.setState({loading:!0}),Je.getDocumentTitles(a.props.document.id).then((function(e){a.setState({loading:!1,titles:e.data,openNewTitle:!1})}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.updateLanguages=function(e,t){"lang"===e?a.setState({available_lang:t}):a.setState({available_kindOf:t})},a.handleDeleteTitle=function(e){a.setState({loading:!0}),Je.delete(e.target.id).then((function(e){a.setState({loading:!1}),a.getTitles()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.onBlur=function(e){a.setState({loading:!0}),ie.update(a.props.document.id,Object(Pe.a)({},e.target.id,e.target.value)).then((function(e){a.setState({loading:!1})}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.onChange=function(e){a.setState(Object(Pe.a)({},e.target.id,e.target.value))},a.openNewContributorForm=function(){a.setState({openNewContributor:!a.state.openNewContributor})},a.openNewTitleForm=function(){a.setState({openNewTitle:!a.state.openNewTitle})},a.openNewAvailableLanguageForm=function(){a.setState({openNewAvailableLanguage:!a.state.openNewAvailableLanguage})},a.openNewAvailableKindOfForm=function(){a.setState({openNewAvailableKindOf:!a.state.openNewAvailableKindOf})},a.state={loading:!1,currentUser:O.getCurrentUser(),titles:e.document.titles,contributors:e.document.contributors,affiliation:e.document.affiliation,recording_date:e.document.recording_date,recording_place:e.document.recording_place,lang:e.document.lang,available_lang:e.document.available_lang,available_kindOf:e.document.available_kindOf,document:e.document},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=[],n=[],a=[],s=[];return this.state.titles&&this.state.titles.forEach((function(n){t.push(Object(P.jsx)($e,{getTitles:e.getTitles,title:n},n.id))})),this.state.contributors&&this.state.contributors.forEach((function(t){n.push(Object(P.jsx)(Xe,{getContributors:e.getContributors,contributor:t},t.id))})),this.state.available_lang&&this.state.available_lang.forEach((function(t){a.push(Object(P.jsx)(Ze,{type:"lang",updateLanguages:e.updateLanguages,lang:t,list:e.state.available_lang,documentId:e.props.document.id},t))})),this.state.available_kindOf&&this.state.available_kindOf.forEach((function(t){s.push(Object(P.jsx)(Ze,{type:"kindOf",updateLanguages:e.updateLanguages,lang:t,list:e.state.available_kindOf,documentId:e.props.document.id},t))})),Object(P.jsxs)("div",{children:[this.state.loading&&Object(P.jsx)(y.a,{}),Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{children:Object(P.jsx)(T.a,{id:"lang",label:"Corpus",placeholder:"Title, ISO 639-2 language code",helperText:"use format 'Title, ISO 639-2 language code'",value:this.state.lang,onChange:this.onChange,onBlur:this.onBlur})}),Object(P.jsxs)("div",{children:[Object(P.jsx)(L.a,{component:"h3",children:"Recording"}),Object(P.jsx)(T.a,{id:"recording_date",label:"Date",type:"date",InputLabelProps:{shrink:!0},value:this.state.recording_date&&this.state.recording_date.split(" ")[0],onChange:this.onChange,onBlur:this.onBlur}),Object(P.jsx)(T.a,{id:"recording_place",label:"Place",placeholder:"Place of recording",type:"text",value:this.state.recording_place,onChange:this.onChange,onBlur:this.onBlur})]}),Object(P.jsxs)("div",{id:"available_kindOf",children:[Object(P.jsx)(L.a,{component:"h3",children:"Available kind of transcription"}),s,Object(P.jsx)(De.a,{icon:this.state.openNewAvailableKindOf?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"kindOf",clickable:!0,size:"small",color:"primary",onClick:this.openNewAvailableKindOfForm}),Object(P.jsx)(at,{type:"kindOf",list:this.state.available_kindOf,getLanguages:this.getKindOf,documentId:this.state.document.id,hidden:!this.state.openNewAvailableKindOf,updateLanguages:this.updateLanguages})]}),Object(P.jsxs)("div",{id:"available_lang",children:[Object(P.jsx)(L.a,{component:"h3",children:"Available translation languages"}),a,Object(P.jsx)(De.a,{icon:this.state.openNewAvailableLanguage?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"language",clickable:!0,size:"small",color:"primary",onClick:this.openNewAvailableLanguageForm}),Object(P.jsx)(at,{type:"lang",list:this.state.available_lang,getLanguages:this.getLanguages,documentId:this.state.document.id,hidden:!this.state.openNewAvailableLanguage,updateLanguages:this.updateLanguages})]}),Object(P.jsxs)("div",{id:"titles",children:[Object(P.jsx)(L.a,{component:"h3",children:"Titles"}),t,Object(P.jsx)(De.a,{icon:this.state.openNewTitle?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"title",clickable:!0,size:"small",color:"primary",onClick:this.openNewTitleForm}),Object(P.jsx)(tt,{getTitles:this.getTitles,documentId:this.state.document.id,hidden:!this.state.openNewTitle,available_lang:this.state.available_lang})]}),Object(P.jsxs)("div",{id:"contributors",children:[Object(P.jsx)(L.a,{component:"h3",children:"Contributors"}),n,Object(P.jsx)(De.a,{icon:this.state.openNewContributor?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"contributor",clickable:!0,size:"small",color:"primary",onClick:this.openNewContributorForm}),Object(P.jsx)(Ke,{getContributors:this.getContributors,documentId:this.state.document.id,hidden:!this.state.openNewContributor})]}),Object(P.jsx)("div",{children:Object(P.jsx)(T.a,{id:"depositorAffiliation",label:"Depositor's affiliation",placeholder:"Depositor's affiliation",type:"text",onChange:this.onChange})})]})]})}}]),n}(a.Component),ot=Object(m.f)(st),it=b.API_URL,rt=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"create",value:function(e,t,n,a){var s=new FormData;return s.append("resourceFile",e),s.append("type",t),s.append("filename",n),s.append("name",n),s.append("document_id",a),Q["Content-Type"]="multipart/form-data",new Promise((function(e,t){j.a.post(it+"recordings",s,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(it+"recordings/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),lt=b.API_URL,ct=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"create",value:function(e,t,n,a,s){var o=new FormData;return o.append("resourceFile",e),o.append("rank",t),o.append("filename",n),o.append("name",a),o.append("document_id",s),Q["Content-Type"]="multipart/form-data",new Promise((function(e,t){j.a.post(lt+"images",o,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(lt+"images/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),dt=n(118),pt=n.n(dt),ht=n(504),ut=n(509),mt=n(579),gt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleOpenAddDialog=function(){a.setState({openAddDialog:!0})},a.handleCloseAddDialog=function(){a.setState({openAddDialog:!1})},a.handleCloseDeleteDialog=function(e){a.setState({openDeleteDialog:!1})},a.handleOpenDeleteDialog=function(e){a.setState({openDeleteDialog:!0,selectedResourceId:e}),alert(e)},a.onNameChange=function(e){a.setState({nameInDocument:e.target.value})},a.handleUpload=function(){a.setState({loading:!0});var e="AUDIO";"video/mp4"===document.getElementById("resourceFile").files[0].type&&(e="VIDEO"),"audio/mpeg"!==document.getElementById("resourceFile").files[0].type&&"audio/wav"!==document.getElementById("resourceFile").files[0].type||(e="AUDIO"),"image/jpeg"!==document.getElementById("resourceFile").files[0].type&&"image/png"!==document.getElementById("resourceFile").files[0].type||(e="IMAGE"),("AUDIO"===e||"VIDEO"===e)&&!a.state.hasRecording&&rt.create(document.getElementById("resourceFile").files[0],e,a.state.nameInDocument||document.getElementById("resourceFile").files[0].name,a.props.documentId).then((function(e){a.setState({recording:e.data,loading:!1,openAddDialog:!1}),window.location.reload()}),(function(e){401===e.response.status&&a.props.history.push("/login"),console.log(e.response);var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,errorMessage:t,openAddDialog:!1})})),"IMAGE"===e&&ct.create(document.getElementById("resourceFile").files[0],a.state.maxImageRank+1,document.getElementById("resourceFile").files[0].name,a.state.nameInDocument||document.getElementById("resourceFile").files[0].name,a.props.documentId).then((function(e){var t=a.state.images;t.push(e.data),a.setState({images:t,loading:!1,openAddDialog:!1}),window.location.reload()}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,errorMessage:t,openAddDialog:!1})})),("AUDIO"===e||"VIDEO"===e)&&a.state.hasRecording&&alert("You can attach only one recording to the document")},a.handleCloseSnackBar=function(e){a.setState({errorMessage:null})},a.handleDeleteResource=function(){a.setState({loading:!0});var e=a.state.selectedResourceType;("AUDIO"===e||"VIDEO"===e)&&rt.delete(a.state.selectedResourceId).then((function(e){window.location.reload()}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,errorMessage:t})})),"IMAGE"===e&&ct.delete(a.state.selectedResourceId).then((function(e){window.location.reload()}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,errorMessage:t})})),a.setState({openDeleteDialog:!1})},a.refreshResources=function(){var e=[];if(a.state.images){var t=0;a.state.images.forEach((function(n){t=t<n.rank?n.rank:t,e.push({id:"IMAGE"+n.id,filename:n.filename,name:n.name,type:"IMAGE",rank:n.rank,preview:{type:"IMAGE",content:n["TO_BASE64(content)"]},actions:n.id}),a.setState({maxImageRank:t,resources:e})}))}a.state.recording&&(e.push({id:a.state.recording.type+a.state.recording.id,filename:a.state.recording.filename,name:a.state.recording.name,type:a.state.recording.type,rank:1,preview:{type:a.state.recording.type,content:a.state.recording["TO_BASE64(content)"]},actions:a.state.recording.id}),a.setState({hasRecording:!0,resources:e}))},a.state={currentUser:O.getCurrentUser(),resources:[],openAddDialog:!1,maxImageRank:0,nameInDocument:null,openDeleteDialog:!1,selectedResourceId:null,images:a.props.images,recording:a.props.recording},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.refreshResources()}},{key:"render",value:function(){var e=this,t=[{field:"id",headerName:"ID",width:50},{field:"filename",headerName:"Original file name",width:200,editable:!0},{field:"name",headerName:"Name in document",width:200,editable:!0},{field:"type",headerName:"Type",width:110,editable:!0},{field:"rank",headerName:"Rank",width:110,editable:!0},{field:"preview",headerName:"Preview",width:150,editable:!0,renderCell:function(e){return"IMAGE"===e.value.type?Object(P.jsx)("img",{alt:e.value.filename,src:"data:image/png;base64,"+e.value.content,width:"100px",height:"100px"}):Object(P.jsx)("audio",{controls:"controls",src:"data:audio/mpeg;base64,"+e.value.content,type:"audio/mp3"})}},{field:"actions",headerName:"Actions",width:200,editable:!1,renderCell:function(t){return Object(P.jsx)("div",{children:Object(P.jsx)(de.a,{color:"primary","aria-label":"Delete resource",onClick:function(){console.log(t.row.type),e.setState({openDeleteDialog:!0,selectedResourceId:t.value,selectedResourceType:t.row.type})},children:Object(P.jsx)(he.a,{})})})}}];return Object(P.jsxs)(_.a,{children:[Object(P.jsx)("header",{className:"jumbotron",children:Object(P.jsx)("h3",{children:"Resources"})}),Object(P.jsx)("div",{children:Object(P.jsxs)("div",{style:{height:300,width:"80%"},children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Add document",onClick:this.handleOpenAddDialog,children:Object(P.jsx)(me.a,{})}),Object(P.jsx)(ce.a,{rows:this.state.resources,columns:t,pageSize:10,checkboxSelection:!0,disableSelectionOnClick:!0})]})}),Object(P.jsxs)("div",{children:[Object(P.jsxs)(ve.a,{open:this.state.openAddDialog,onClose:this.handleCloseAddDialog,"aria-labelledby":"form-dialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-dialog-title",children:"Add a resource"}),Object(P.jsxs)(we.a,{children:[Object(P.jsx)(Se.a,{children:"1 audio or 1 video maximum, if multiple images, please define a rank for each one."}),Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ht.a,{id:"resourceFile",type:"file","aria-describedby":"standard-weight-helper-text",inputProps:{accept:"image/png, image/jpeg, audio/wav, audio/mpeg, video/mp4"}}),Object(P.jsx)(ut.a,{id:"standard-weight-helper-text",children:"Accepted formats : JPG, PNG, WAV, MP3, MP4"})]}),Object(P.jsx)(Ae.a,{children:Object(P.jsx)(T.a,{label:"Name in document",placeholder:"Name in document",fullWidth:!0,value:this.state.nameInDocument,onChange:this.onNameChange})})]}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseAddDialog,color:"primary",children:"Cancel"}),this.state.loading?Object(P.jsx)(y.a,{}):Object(P.jsx)(S.a,{onClick:this.handleUpload,color:"primary",children:"Upload"})]})]}),Object(P.jsxs)(ve.a,{open:this.state.openDeleteDialog,onClose:this.handleCloseDeleteDialog,"aria-labelledby":"form-deletedialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-deletedialog-title",children:"Delete resource"}),Object(P.jsx)(we.a,{children:Object(P.jsxs)(Se.a,{children:["Delete resource ",this.state.selectedResourceId," ?"]})}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseDeleteDialog,color:"primary",children:"Cancel"}),!this.state.loading&&Object(P.jsx)(S.a,{onClick:this.handleDeleteResource,color:"primary",children:"Delete resource"}),this.state.loading&&Object(P.jsx)(y.a,{})]})]}),Object(P.jsx)(mt.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.errorMessage,autoHideDuration:null,message:this.state.errorMessage,action:Object(P.jsx)(s.a.Fragment,{children:Object(P.jsx)(de.a,{size:"small","aria-label":"close",color:"inherit",onClick:this.handleCloseSnackBar,children:Object(P.jsx)(pt.a,{fontSize:"small"})})})})]})]})}}]),n}(a.Component),jt=Object(m.f)(gt),bt=n(263),ft=n.n(bt),Ot=n(264),xt=n.n(Ot),vt=n(265),yt=n.n(vt),wt=n(266),St=n.n(wt),Ct=n(267),Tt=n.n(Ct),Et=n(583),kt=n(514),At=n(161),Dt=n.n(At),Nt=n(162),It=n.n(Nt),Rt=n(275),Lt=n.n(Rt),Ft=n(274),_t=n.n(Ft),Pt=n(582),Mt=n(268),Wt=n.n(Mt),Ut=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).changeCoordinate=function(e,t,n){a.setState({coordinates:n});var s=[];n.forEach((function(e){s.push({imageId:a.props.image.id,x:parseFloat(e.x.toFixed(2)),y:parseFloat(e.y.toFixed(2)),width:parseFloat(e.width.toFixed(2)),height:parseFloat(e.height.toFixed(2))})})),window.coordinates=n,window.imageSelectionData=s,window.currentAnnotationEdition&&(window.currentAnnotationEdition.data=s)},a.deleteCoordinate=function(e,t,n){a.setState({coordinates:n}),window.coordinates=n},a.divCanvas=s.a.createRef();var o=[],i="absolute",r="0px",c="12px",d="12px",p="50%",h="white",u="0.6rem",m="bold",g="center";a.props.canvas&&a.props.canvas.forEach((function(t){var n={position:i,top:r,width:c,height:d,borderRadius:p,color:h,fontSize:u,fontWeight:m,textAlign:g},a={position:i,top:r,width:c,height:d,borderRadius:p,color:h,fontSize:u,fontWeight:m,textAlign:g};n.right="10px",a.right="0px",n.backgroundColor=t.hasForm>0?"green":"red",a.backgroundColor=t.hasTranslation>0?"green":"red";var s=t.areaCoords.split(","),l={display:e.showImageCanvas?"block":"none",position:"absolute",top:s[1]/s[4]+"px",left:s[0]/s[4]+"px",border:"solid",borderColor:(t.type,"blue"),borderStyle:"S"===t.type?"solid":"dotted",cursor:"pointer"},j=Object(P.jsxs)("div",{style:l,children:[Object(P.jsx)("canvas",{className:"imageCanvas",title:t.type+t.rank,style:{position:"relative"},width:(s[2]-s[0])/s[4],height:(s[3]-s[1])/s[4],onClick:function(){e.showAnnotation(t.id)}}),Object(P.jsx)("span",{style:n,children:"F"}),Object(P.jsx)("span",{style:a,children:"T"})]});o.push(j)})),a.state={coordinates:a.props.coordinates,canvas:o,imageSelectorWidth:1e3};var j=new Image;j.src="data:image/png;base64,"+a.props.image["TO_BASE64(content)"];var b=j.naturalWidth/a.state.imageSelectorWidth;return window.imageRatio=b,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){console.log(this.divCanvas),this.divCanvas.previousSibling.append(this.divCanvas)}},{key:"render",value:function(){var e=this;return Object(P.jsxs)("div",{id:"ImageSelector_"+this.props.image.id,className:"ImageSelector",children:[Object(P.jsx)(Wt.a,{src:"data:image/png;base64,"+this.props.image["TO_BASE64(content)"],width:this.state.imageSelectorWidth,coordinates:this.state.coordinates,onChange:this.changeCoordinate,onDelete:this.deleteCoordinate}),Object(P.jsx)("div",{ref:function(t){return e.divCanvas=t},children:this.state.canvas})]})}}]),n}(s.a.Component),Bt=n(577),zt=n(569),Xt=n(506),qt=n(93),Vt=n.n(qt),Ht=n(273),Kt=n.n(Ht),Gt=n(269),Jt=n.n(Gt),Yt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleEdit=function(){a.setState({inputEnabled:!a.state.inputEnabled}),window.currentAnnotationEdition={id:a.props.annotationId,label:a.props.annotationLabel},window.wavesurfer.regions.list[a.props.annotationId]&&window.wavesurfer.regions.list[a.props.annotationId].remove(),window.wavesurfer.addRegion({id:a.props.annotationId,start:a.state.start,end:a.state.end,drag:!0,resize:!0,color:"rgba(0,0,0,0.2)"})},a.handleMouseSelection=function(){a.props.handleEditionState(!0,"audio",{annotationLabel:a.props.annotationLabel,annotationId:a.props.annotationId,start:a.state.start,end:a.state.end})},a.handleCancel=function(){a.setState({inputEnabled:!a.state.inputEnabled,start:a.state.originalStart,end:a.state.originalEnd}),window.currentAnnotationEdition=null},a.handlePlay=function(){a.setState({playing:!a.state.playing}),window.wavesurfer.isPlaying()?window.wavesurfer.pause():window.wavesurfer.play(a.state.start,a.state.end),window.wavesurfer.on("pause",(function(){a.setState({playing:!1})}))},a.onStartChange=function(e){a.setState({start:e.target.value})},a.onEndChange=function(e){a.setState({end:e.target.value})},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1,originalStart:a.state.start,originalEnd:a.state.end}),le.update(a.props.annotationId,{audioStart:a.state.start,audioEnd:a.state.end}).then((function(e){a.setState({loading:!1}),window.currentAnnotationEdition=null}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={playing:!1,inputEnabled:!1,originalStart:e.audioStart,originalEnd:e.audioEnd,start:e.audioStart,end:e.audioEnd},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return window.wavesurfer.regions.list[this.props.annotationId]&&window.wavesurfer.regions.list[this.props.annotationId].remove(),window.wavesurfer.addRegion({id:this.props.annotationId,start:this.state.start,end:this.state.end,drag:!1,resize:!1,color:"rgba(0,0,0,0.2)"}),window.wavesurfer.markers.markers.filter((function(t){return t.label===e.props.annotationLabel})).forEach((function(e,t){window.wavesurfer.markers.remove(t)})),this.props.annotationLabel&&window.wavesurfer.addMarker({time:this.state.start,label:this.props.annotationLabel,color:"S"===this.props.annotationLabel.substring(0,1)?"red":"blue",position:"S"===this.props.annotationLabel.substring(0,1)?"bottom":"top"}),Object(P.jsxs)(_.a,{children:[this.state.loading&&Object(P.jsx)(y.a,{size:"1.5rem"}),Object(P.jsx)(De.a,{label:"audio",size:"small"}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Play",onClick:this.handlePlay,children:this.state.playing?Object(P.jsx)(It.a,{}):Object(P.jsx)(Dt.a,{})}),Object(P.jsx)(T.a,{id:"start"+this.props.id,label:"Start",disabled:!this.state.inputEnabled,value:this.state.start,onChange:this.onStartChange,size:"small",style:{width:"5rem"}}),Object(P.jsx)(T.a,{id:"end"+this.props.id,label:"End",disabled:!this.state.inputEnabled,value:this.state.end,onChange:this.onEndChange,size:"small",style:{width:"5rem"}}),this.state.inputEnabled?Object(P.jsxs)("span",{children:[Object(P.jsx)(de.a,{title:"Select on waveform",color:"primary","aria-label":"Save",onClick:this.handleMouseSelection,children:Object(P.jsx)(Jt.a,{})}),Object(P.jsx)(de.a,{title:"Save",color:"primary","aria-label":"Save",onClick:this.handleSubmit,children:Object(P.jsx)(Ve.a,{})}),Object(P.jsx)(de.a,{title:"Cancel",color:"primary","aria-label":"Cancel",onClick:this.handleCancel,children:Object(P.jsx)(Vt.a,{})})]}):Object(P.jsx)(de.a,{title:"Edit",color:"primary","aria-label":"Edit",onClick:this.handleEdit,children:Object(P.jsx)(je.a,{})}),Object(P.jsx)(de.a,{title:"Delete",color:"primary","aria-label":"Delete",children:Object(P.jsx)(he.a,{})})]})}}]),n}(a.Component),$t=Object(m.f)(Yt),Qt=n(270),Zt=n.n(Qt),en=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleEdit=function(){a.setState({inputEnabled:!a.state.inputEnabled}),window.currentAnnotationEdition={},window.currentAnnotationEdition.annotationId=a.props.annotationId,window.currentAnnotationEdition.annotationLabel=a.props.annotationLabel,window.currentAnnotationEdition.imageAddition=!1,window.currentAnnotationEdition.imageCoords=a.props.imageCoords,a.props.handleEditionState(!0,"image",{annotationLabel:a.props.annotationLabel,annotationId:a.props.annotationId,imageCoords:a.state.imageCoords})},a.handleEditImageAddition=function(){a.setState({inputEnabled:!a.state.inputEnabled}),window.currentAnnotationEdition={},window.currentAnnotationEdition.annotationId=a.props.annotationId,window.currentAnnotationEdition.annotationLabel=a.props.annotationLabel,window.currentAnnotationEdition.imageAddition=!0,window.currentAnnotationEdition.imageCoords=a.props.imageCoords,a.props.handleEditionState(!0,"image",{annotationLabel:a.props.annotationLabel,annotationId:a.props.annotationId,imageCoords:a.state.imageCoords})},a.handleCancel=function(){a.setState({inputEnabled:!a.state.inputEnabled,imageCoords:a.state.originalImageCoords}),window.currentAnnotationEditionId=null},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1})},a.state={inputEnabled:!1,imageCoords:a.props.imageCoords,originalImageCoords:a.props.imageCoords},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=[];return this.props.imageCoords&&this.props.imageCoords.forEach((function(t){var n,a,s=t.areaCoords.split(",");n=s[0],a=s[1];var o=s[2]-n,i=s[3]-a;e.push(Object(P.jsx)("div",{style:{overflow:"hidden",width:o,height:i},children:Object(P.jsx)("img",{alt:"image"+t.image_id,style:{margin:"-"+a+"px 0px 0px -"+n+"px"},src:"data:image/png;base64,"+localStorage.getItem("image"+t.image_id)})}))})),Object(P.jsxs)(_.a,{children:[this.state.loading&&Object(P.jsx)(y.a,{size:"1.5rem"}),Object(P.jsx)(De.a,{label:"image",size:"small"}),this.state.inputEnabled?Object(P.jsxs)("span",{children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,children:Object(P.jsx)(Ve.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Cancel",onClick:this.handleCancel,children:Object(P.jsx)(Vt.a,{})})]}):Object(P.jsx)(de.a,{color:"primary","aria-label":"Edit",onClick:this.handleEdit,children:Object(P.jsx)(je.a,{})}),Object(P.jsx)("div",{children:e}),e.length>0?Object(P.jsx)(de.a,{color:"primary","aria-label":"Edit",onClick:this.handleEditImageAddition,children:Object(P.jsx)(Zt.a,{})}):Object(P.jsx)("span",{})]})}}]),n}(a.Component),tn=n(271),nn=n.n(tn),an=n(578),sn=n(566),on=n(565),rn=b.API_URL,ln=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"getAnnotationForms",value:function(e){return new Promise((function(t,n){j.a.get(rn+"annotations/"+e+"/forms",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"get",value:function(e){return new Promise((function(t,n){j.a.get(rn+"forms/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"create",value:function(e,t,n){var a={kindOf:e,text:t,annotation_id:n};return Q["Content-Type"]="application/json",new Promise((function(e,t){j.a.post(rn+"forms",a,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"update",value:function(e,t,n){var a={kindOf:t,text:n};return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.put(rn+"forms/"+e,a,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(rn+"forms/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),cn=b.API_URL,dn=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"getAnnotationTranslations",value:function(e){return new Promise((function(t,n){j.a.get(cn+"annotations/"+e+"/translations",{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"get",value:function(e){return new Promise((function(t,n){j.a.get(cn+"translations/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"create",value:function(e,t,n){var a={lang:e,text:t,annotation_id:n};return Q["Content-Type"]="application/json",new Promise((function(e,t){j.a.post(cn+"translations",a,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"update",value:function(e,t,n){var a=new FormData;a.append("lang",t),a.append("text",n);var s={lang:t,text:n};return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.put(cn+"translations/"+e,s,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(cn+"translations/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),pn=b.API_URL,hn=new(function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"create",value:function(e,t,n,a){var s={lang:e,text:t};return Q["Content-Type"]="application/json",new Promise((function(e,t){j.a.post(pn+n+"s/"+a+"/notes",s,{headers:Q()}).then((function(t){e(t)})).catch((function(e){t(e)}))}))}},{key:"update",value:function(e,t,n){var a=new FormData;a.append("lang",t),a.append("text",n);var s={lang:t,text:n};return Q["Content-Type"]="application/json",new Promise((function(t,n){j.a.put(pn+"notes/"+e,s,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"delete",value:function(e){return new Promise((function(t,n){j.a.delete(pn+"notes/"+e,{headers:Q()}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}()),un=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onLangChange=function(e){a.setState({lang:e.target.value})},a.onTextChange=function(e){a.setState({text:e.target.value})},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1}),"form"===a.props.type&&ln.create(a.state.lang,a.state.text,a.props.parentId).then((function(e){a.setState({loading:!1}),a.props.refresh("form")}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"translation"===a.props.type&&dn.create(a.state.lang,a.state.text,a.props.parentId).then((function(e){a.setState({loading:!1}),a.props.refresh("translation")}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"note"===a.props.type&&hn.create(a.state.lang,a.state.text,a.props.parentType,a.props.parentId).then((function(e){a.setState({loading:!1}),a.props.refreshNotesParent()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={text:"",lang:null!=a.props.available_lang&&a.props.available_lang.length>0?a.props.available_lang[0]:"",open:e.open,loading:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hidden?"none":"";return Object(P.jsxs)(_.a,{style:{display:e},children:[Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{htmlFor:"select-lang",children:"translation"===this.props.type?"Language":"Kind of form"}),Object(P.jsx)(Ee.a,{native:!0,value:this.state.lang,inputProps:{id:"select-lang"},onChange:this.onLangChange,children:null!=this.props.available_lang&&this.props.available_lang.map((function(e){return Object(P.jsx)("option",{value:e,children:e})}))})]}),Object(P.jsx)(T.a,{label:"translation"===this.props.type?"Translation text":"Form text",placeholder:"translation"===this.props.type?"Translation text":"Form text",multiline:!0,fullWidth:!0,rowsMax:4,value:this.state.text,onChange:this.onTextChange}),this.state.loading?Object(P.jsx)(y.a,{size:"1.5rem"}):Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,hidden:!(this.state.lang.length>=2&&this.state.text.length>=1),children:Object(P.jsx)(Ve.a,{})})]})}}]),n}(a.Component),mn=Object(m.f)(un),gn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(P.jsx)(jn,{type:"note",id:this.props.data.id,lang:this.props.data.lang,text:this.props.data.text,refresh:this.props.refresh,refreshNotesParent:this.props.refreshNotesParent,available_lang:this.props.available_lang,note_available_lang:this.props.note_available_lang,parent_type:this.props.parent_type})}}]),n}(a.Component),jn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleExpand=function(e){return function(t,n){a.setState({expanded:!!n&&e})}},a.handleEdit=function(){a.setState({inputEnabled:!a.state.inputEnabled})},a.onLangChange=function(e){a.setState({lang:e.target.value})},a.onTextChange=function(e){a.setState({text:e.target.value})},a.handleCancel=function(){a.setState({inputEnabled:!a.state.inputEnabled,lang:a.state.originalLang,text:a.state.originalText})},a.handleDelete=function(){a.setState({loading:!0,inputEnabled:!1}),"form"===a.props.type&&ln.delete(a.props.id).then((function(e){a.props.refresh("form")}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"translation"===a.props.type&&dn.delete(a.props.id).then((function(e){a.props.refresh("translation")}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"note"===a.props.type&&hn.delete(a.props.id).then((function(e){a.setState({inputEnabled:!1,loading:!1},a.props.refreshNotesParent())}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1}),"form"===a.props.type&&ln.update(a.props.id,a.state.lang,a.state.text).then((function(e){a.setState({inputEnabled:!1,originalLang:a.state.lang,originalText:a.state.text,expanded:!1,loading:!1}),a.props.refresh("form")}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"translation"===a.props.type&&dn.update(a.props.id,a.state.lang,a.state.text).then((function(e){a.setState({inputEnabled:!1,originalLang:a.state.lang,originalText:a.state.text,expanded:!1,loading:!1}),a.props.refresh("translation")}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"note"===a.props.type&&hn.update(a.props.id,a.state.lang,a.state.text).then((function(e){a.setState({inputEnabled:!1,loading:!1},a.props.refreshNotesParent())}),(function(e){a.setState({inputEnabled:!0,loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.openNewNoteForm=function(){a.setState({openNewNote:!a.state.openNewNote})},a.state={text:a.props.text,lang:a.props.lang,originalText:a.props.text,originalLang:a.props.lang,expanded:!1,inputEnabled:!1,loading:!1,openNewNote:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return Object(P.jsx)(_.a,{children:Object(P.jsxs)(an.a,{expanded:"panel1"===this.state.expanded,onChange:this.handleExpand("panel1"),children:[Object(P.jsxs)(on.a,{expandIcon:Object(P.jsx)(nn.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:[Object(P.jsx)(De.a,{label:this.props.type,size:"small"}),Object(P.jsx)(De.a,{label:this.props.lang,size:"small",color:"secondary"}),this.props.text.substring(0,50),this.props.text.length>50?"...":""]}),Object(P.jsxs)(sn.a,{children:[Object(P.jsxs)(D.a,{container:!0,children:[Object(P.jsx)(D.a,{item:!0,xs:2,children:Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{htmlFor:"select-lang",children:"form"===this.props.type?"Kind of form":"Language"}),Object(P.jsx)(Ee.a,{native:!0,value:this.state.lang,inputProps:{id:"select-lang"},onChange:this.onLangChange,children:this.props.available_lang.map((function(e){return Object(P.jsx)("option",{value:e,children:e})}))})]})}),Object(P.jsx)(D.a,{item:!0,xs:10,children:Object(P.jsx)(T.a,{id:this.props.type+this.props.id,label:"form"===this.props.type?"Form text":"Text",placeholder:"form"===this.props.type?"Form text":"Text",multiline:!0,disabled:!this.state.inputEnabled,fullWidth:!0,rowsMax:4,value:this.state.text,onChange:this.onTextChange})})]}),"note"!==this.props.type&&Object(P.jsx)(D.a,{container:!0,children:Object(P.jsxs)(D.a,{item:!0,xs:12,children:[Object(P.jsx)(De.a,{icon:this.state.openNewNote?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"note",clickable:!0,size:"small",color:"primary",onClick:this.openNewNoteForm}),Object(P.jsx)(mn,{type:"note",parentId:this.props.id,parentType:this.props.type,refresh:this.props.refresh,refreshNotesParent:this.props.refreshNotes,hidden:!this.state.openNewNote,available_lang:this.props.note_available_lang}),this.props.notes&&this.props.notes.length>0&&this.props.notes.map((function(t){return Object(P.jsx)(gn,{data:t,refresh:e.props.refresh,refreshNotesParent:e.props.refreshNotes,available_lang:e.props.note_available_lang,parent_type:e.props.type})}))]})}),this.state.loading?Object(P.jsx)(y.a,{size:"1.5rem"}):this.state.inputEnabled?Object(P.jsxs)("div",{children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,children:Object(P.jsx)(Ve.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Cancel",onClick:this.handleCancel,children:Object(P.jsx)(Vt.a,{})})]}):Object(P.jsxs)("div",{children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Edit",onClick:this.handleEdit,children:Object(P.jsx)(je.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"Delete",onClick:this.handleDelete,children:Object(P.jsx)(he.a,{})})]})]})]})})}}]),n}(s.a.Component),bn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).refreshNotes=function(){ln.get(a.props.data.id).then((function(e){a.setState({notes:e.data.notes})}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={notes:a.props.data.notes},a}return Object(c.a)(n,[{key:"render",value:function(){return console.log("render Form"),console.log(this.state.notes),Object(P.jsx)(jn,{type:"form",id:this.props.data.id,lang:this.props.data.kindOf,text:this.props.data.text,notes:this.state.notes,refresh:this.props.refresh,refreshNotes:this.refreshNotes,available_lang:this.props.available_lang,note_available_lang:this.props.note_available_lang})}}]),n}(jn),fn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).refreshNotes=function(){dn.get(a.props.data.id).then((function(e){a.setState({notes:e.data.notes},a.forceUpdate())}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={notes:a.props.data.notes},a}return Object(c.a)(n,[{key:"render",value:function(){return Object(P.jsx)(jn,{type:"translation",id:this.props.data.id,lang:this.props.data.lang,text:this.props.data.text,notes:this.state.notes,refresh:this.props.refresh,refreshNotes:this.refreshNotes,available_lang:this.props.available_lang,note_available_lang:this.props.note_available_lang})}}]),n}(jn),On=n(272),xn=n.n(On),vn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onTextChange=function(e){a.setState({nbWords:e.target.value})},a.handleSubmit=function(){a.setState({loading:!0,inputEnabled:!1});var e=a.props.formToSplit.split(" "),t=0,n=0,s=0,o=0;if(a.props.audioStart&&a.props.audioEnd&&a.props.audioEnd-a.props.audioStart>0&&(t=(a.props.audioEnd-a.props.audioStart)/a.state.nbWords),a.props.imageCoords.length>0){var i=!0;a.props.imageCoords.forEach((function(e){var t=e.areaCoords.split(",");s+=t[2]-t[0],o=Math.max(o,t[3]-t[1]),i&&(t[0],t[2],i=!1)})),n=s/a.state.nbWords}for(var r,l=!0,c=0,d=0;d<a.state.nbWords;d++){var p=(r=l?a.props.imageCoords[0]:a.props.imageCoords[1]).areaCoords.split(","),h=d*t+.1+parseFloat(a.props.audioStart),u=(d+1)*t-.1+parseFloat(a.props.audioStart),m=(d-c)*n+2+parseFloat(p[0]),g=(d-c+1)*n-2+parseFloat(p[0]);m>p[2]&&(c=d,l=!1);var j={document_id:a.props.documentId,type:"W",rank:d+1,parent_id:a.props.parentId,imageCoords:[{image_id:r.image_id,areaCoords:m+","+p[1]+","+g+","+p[3]+","+p[4]}],audioStart:parseFloat(h.toFixed(2)),audioEnd:parseFloat(u.toFixed(2))},b=0;le.create(j).then((function(t){a.setState({loading:!1}),a.props.formToSplit.length>0&&ln.create(a.props.kindOf,e[t.data.rank-1],t.data.id).then((function(e){b++}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))}console.log(d,b)},a.state={nbWords:a.props.nbWords,loading:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hidden?"none":"",t=this.props.formToSplit.split(" ").join(" / ");return Object(P.jsxs)(_.a,{style:{display:e},children:[Object(P.jsx)(T.a,{label:"Number of words",placeholder:"Number of words",value:this.state.nbWords,onChange:this.onTextChange}),this.state.loading?Object(P.jsx)(y.a,{size:"1.5rem"}):Object(P.jsx)(de.a,{color:"primary","aria-label":"Save",onClick:this.handleSubmit,hidden:!this.state.nbWords.length,children:Object(P.jsx)(xn.a,{})}),Object(P.jsx)("p",{children:Object(P.jsx)("small",{children:t})})]})}}]),n}(a.Component),yn=Object(m.f)(vn),wn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleExpand=function(e){return function(t,n){a.setState({expanded:!!n&&e})}},a.handleCloseDeleteDialog=function(e){a.setState({openDeleteDialog:!1})},a.handleOpenDeleteDialog=function(e){a.setState({openDeleteDialog:!0})},a.handleDeleteAnnotation=function(e){a.setState({loading:!0}),window.coordinates=void 0,le.delete(a.props.data.id).then((function(e){a.props.refreshAnnotations(),a.handleCloseDeleteDialog(),a.setState({loading:!1}),a.refresh("children")}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))},a.handleAddChild=function(){var e={T:"S",S:"W",W:"M"}[a.props.data.type],t={document_id:a.props.data.document_id,type:e,rank:a.state.nextChildRank,parent_id:a.props.data.id};le.create(t).then((function(e){a.setState({nextChildRank:a.state.nextChildRank+1}),a.refresh("children"),a.props.annotationHasChanged(),window.coordinates=void 0}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))},a.openNewFormForm=function(){a.setState({openNewForm:!a.state.openNewForm})},a.openNewTranslationForm=function(){a.setState({openNewTranslation:!a.state.openNewTranslation})},a.openSplitForm=function(){a.setState({openSplit:!a.state.openSplit})},a.refresh=function(e){console.log("refresh called "+e),window.coordinates=void 0,"form"===e&&a.setState({openNewForm:!1}),"translation"===e&&a.setState({openNewTranslation:!1}),"form"===e&&ln.getAnnotationForms(a.props.data.id).then((function(e){a.setState({forms:e.data}),a.props.annotationHasChanged()}),(function(e){401===e.response.status&&a.props.history.push("/login"),a.setState({loading:!1});var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"translation"===e&&dn.getAnnotationTranslations(a.props.data.id).then((function(e){a.setState({translations:e.data}),a.props.annotationHasChanged()}),(function(e){401===e.response.status&&a.props.history.push("/login"),a.setState({loading:!1});var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)})),"children"===e&&le.getAnnotationChildren(a.props.data.id).then((function(e){a.setState({children:e.data}),a.props.refreshAnnotations()}),(function(e){401===e.response.status&&a.props.history.push("/login"),a.setState({loading:!1});var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.state={loading:!1,expanded:!!("T"===a.props.data.type||window.currentAnnotationEdition&&a.props.data.id===window.currentAnnotationEdition.id)&&"panel1",forms:a.props.data.forms,translations:a.props.data.translations,children:a.props.data.children_annotations,audioStart:a.props.data.audioStart,audioEnd:a.props.data.audioEnd,openNewForm:!1,openNewTranslation:!1,openSplit:!1,nextChildRank:0,openDeleteDialog:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this.state.children&&this.state.children.length>0?Math.max.apply(Math,this.state.children.map((function(e){return e.rank}))):0;this.setState({nextChildRank:e+1})}},{key:"render",value:function(){var e=this;return Object(P.jsxs)("div",{children:[Object(P.jsxs)(D.a,{container:!0,children:[Object(P.jsxs)(D.a,{item:!0,xs:1,children:[Object(P.jsx)(_.a,{children:Object(P.jsx)(De.a,{label:this.props.data.type+this.props.data.rank,size:"small",color:"primary"})}),Object(P.jsx)(_.a,{children:Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{htmlFor:"select-parent-annotation",children:"Parent annotation"}),Object(P.jsx)(Ee.a,{native:!0,value:this.props.data.parent_id,inputProps:{id:"select-parent-annotation"},children:this.props.parentAnnotations.map((function(t){return Object(P.jsx)("option",{value:t.id,nextChildRank:t.nextChildRank,disabled:e.props.data.type!==t.childrenType,hidden:e.props.type!==t.childrenType,children:t.label},t.id)}))})]})})]}),Object(P.jsxs)(D.a,{item:!0,xs:10,children:[Object(P.jsx)(_.a,{item:!0,xs:6,children:"T"!==this.props.data.type&&null!==window.wavesurfer&&Object(P.jsx)($t,{annotationHasChanged:this.props.annotationHasChanged,handleEditionState:this.props.handleEditionState,audioStart:this.state.audioStart,audioEnd:this.state.audioEnd,annotationId:this.props.data.id,annotationLabel:this.props.data.type+this.props.data.rank})}),Object(P.jsx)(_.a,{item:!0,xs:6,children:"T"!==this.props.data.type&&Object(P.jsx)(en,{imageCoords:this.props.data.imageCoords,handleEditionState:this.props.handleEditionState,annotationId:this.props.data.id,annotationLabel:this.props.data.type+this.props.data.rank})}),Object(P.jsxs)(_.a,{item:!0,xs:6,children:[Object(P.jsxs)(_.a,{item:!0,xs:12,children:[Object(P.jsx)(De.a,{icon:this.state.openNewForm?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"form",clickable:!0,size:"small",color:"primary",onClick:this.openNewFormForm}),Object(P.jsx)(mn,{type:"form",parentId:this.props.data.id,refresh:this.refresh,hidden:!this.state.openNewForm,available_lang:this.props.available_kindOf}),this.state.forms&&this.state.forms.length>0&&this.state.forms.map((function(t){return Object(P.jsx)(bn,{data:t,refresh:e.refresh,available_lang:e.props.available_kindOf,note_available_lang:e.props.available_lang})}))]}),Object(P.jsxs)(_.a,{item:!0,xs:12,children:[Object(P.jsx)(L.a,{variant:"h5",gutterBottom:!0}),Object(P.jsx)(De.a,{icon:this.state.openNewTranslation?Object(P.jsx)(We.a,{}):Object(P.jsx)(me.a,{}),label:"translation",clickable:!0,size:"small",color:"primary",onClick:this.openNewTranslationForm}),Object(P.jsx)(mn,{type:"translation",parentId:this.props.data.id,refresh:this.refresh,hidden:!this.state.openNewTranslation,available_lang:this.props.available_lang}),this.state.translations&&this.state.translations.length>0&&this.state.translations.map((function(t){return Object(P.jsx)(fn,{data:t,refresh:e.refresh,available_lang:e.props.available_lang,note_available_lang:e.props.available_lang})}))]}),"S"===this.props.data.type&&0===this.props.data.children_annotations.length&&Object(P.jsxs)(_.a,{item:!0,xs:12,children:[Object(P.jsx)(L.a,{variant:"h5",gutterBottom:!0}),Object(P.jsx)(De.a,{clickable:!0,icon:Object(P.jsx)(Kt.a,{}),label:"words auto-split",size:"small",color:"primary",onClick:this.openSplitForm}),Object(P.jsx)(yn,{parentId:this.props.data.id,refresh:this.refresh,hidden:!this.state.openSplit,nbWords:this.state.forms.length>0?this.state.forms[0].text.split(" ").length:2,audioStart:this.state.audioStart,audioEnd:this.state.audioEnd,imageCoords:this.props.data.imageCoords,formToSplit:this.state.forms.length>0?this.state.forms[0].text:"",kindOf:this.state.forms.length>0?this.state.forms[0].kindOf:"",documentId:this.props.data.document_id})]}),"T"!==this.props.data.type&&Object(P.jsx)(de.a,{color:"primary","aria-label":"Delete",onClick:this.handleOpenDeleteDialog,title:"Delete annotation",children:Object(P.jsx)(he.a,{})})]})]}),Object(P.jsx)(D.a,{item:!0,xs:1,children:Object(P.jsx)(_.a,{children:Object(P.jsx)(de.a,{"aria-label":"close",onClick:this.props.onClose,children:Object(P.jsx)(Vt.a,{})})})})]}),Object(P.jsxs)(ve.a,{open:this.state.openDeleteDialog,onClose:this.handleCloseDeleteDialog,"aria-labelledby":"form-deletedialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-deletedialog-title",children:"Delete annotation"}),Object(P.jsx)(we.a,{children:Object(P.jsxs)(Se.a,{children:["Delete annotation ",this.props.data.type+this.props.data.rank," ?"]})}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseDeleteDialog,color:"primary",children:"Cancel"}),!this.state.loading&&Object(P.jsx)(S.a,{onClick:this.handleDeleteAnnotation,color:"primary",children:"Delete annotation"}),this.state.loading&&Object(P.jsx)(y.a,{})]})]})]})}}]),n}(s.a.Component),Sn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleCloseImportDialog=function(e){a.setState({openImportDialog:!1})},a.handleOpenImportDialog=function(e){document.getElementsByName("xmlInputFile")[0].files.length>0&&a.setState({openImportDialog:!0})},a.state={message:"",loading:!1,openImportDialog:!1,importedData:{TEXT:"nothing"},progress:0},a.handleImport=a.handleImport.bind(Object(d.a)(a)),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"handleImport",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0,progress:0});var n=this;var a=.3545637395867489*document.getElementsByName("xmlInputFile")[0].files[0].size/1e3;setInterval((function(e){n.setState({progress:n.state.progress+e>100?100:n.state.progress+e})}),1e3,100/a),ie.import(document.getElementsByName("xmlInputFile")[0].files[0],this.props.documentId).then((function(e){t.setState({importedData:e.data,openImportDialog:!1}),t.props.refreshAnnotations()}),(function(e){t.setState({importedData:e.response&&e.response.data||e.message||e.toString(),openImportDialog:!1}),401===e.response.status&&t.props.history.push("/login")}))}},{key:"render",value:function(){return Object(P.jsxs)(_.a,{children:[Object(P.jsx)(ht.a,{type:"file",accept:"text/xml",name:"xmlInputFile"}),Object(P.jsx)(S.a,{onClick:this.handleOpenImportDialog,color:"primary",children:"Import"}),this.state.importedData&&this.state.importedData.TEXT&&this.state.importedData.TEXT["xml:lang"],this.state.importedData&&this.state.importedData.WORDLIST&&this.state.importedData.WORDLIST["xml:lang"],Object(P.jsxs)(ve.a,{open:this.state.openImportDialog,onClose:this.handleCloseImportDialog,"aria-labelledby":"form-createdialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-importdialog-title",children:"Import annotations from XML file"}),Object(P.jsx)(we.a,{children:Object(P.jsx)(Se.a,{children:"Importing annotations from a XML file (DTD Pangloss) will delete all annotations for this document. Confirm ?"})}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:this.handleCloseImportDialog,color:"primary",children:"Cancel"}),!this.state.loading&&Object(P.jsx)(S.a,{onClick:this.handleImport,color:"primary",children:"Import"}),this.state.loading&&Object(P.jsxs)(N.a,{position:"relative",display:"inline-flex",children:[Object(P.jsx)(y.a,{variant:"determinate",value:this.state.progress}),Object(P.jsx)(N.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(P.jsxs)(L.a,{variant:"caption",component:"div",color:"textSecondary",children:[Math.round(this.state.progress),"%"]})})]})]})]})]})}}]),n}(a.Component),Cn=Object(m.f)(Sn),Tn=n(281);window.wavesurfer=null;var En,kn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleSliderChange=function(e,t){window.wavesurfer&&window.wavesurfer.zoom(10*t),a.setState({zoom:t,crop:window.crop,openEditionNotification:a.state.openEditionNotification})},a.handleShowImageCanvas=function(e){document.querySelectorAll("canvas.imageCanvas").forEach((function(t){return t.style.display=e.target.checked?"block":"none"})),a.setState({showImageCanvas:e.target.checked})},a.handleNewAnnotationTypeChange=function(e,t){var n=document.getElementById("select-parent-annotation");a.setState({newAnnotationType:e.target.value,parentAnnotationId:n.selectedOptions[0]&&n.value,nextChildRank:n.selectedOptions[0]&&n.selectedOptions[0].attributes.nextChildRank.value})},a.handleParentAnnotationChange=function(e){e.target.selectedOptions[0]&&a.setState({parentAnnotationId:e.target.value,nextChildRank:e.target.selectedOptions[0].attributes.nextChildRank.value})},a.handleCloseCreateDrawer=function(e){a.setState({annotationPanel:!1}),a.state.change>0&&a.refreshAnnotations()},a.handleCloseCreateDialog=function(e){a.setState({openCreateDialog:!1,newAnnotationType:null,parentAnnotationId:null}),window.coordinates=void 0},a.handleOpenCreateDialog=function(e){if(void 0!==window.coordinates&&0!==window.coordinates.length||a.state.hasAudioSelection){a.refreshParentAnnotationsList();var t=Object(d.a)(a);t.setState({parentAnnotationId:a.state.parentAnnotations[0].id,newAnnotationType:a.state.parentAnnotations[0].childrenType,nextChildRank:a.state.parentAnnotations[0].nextChildRank}),a.state.parentAnnotations.forEach((function(e){parseFloat(t.state.audioSelection.end)<=parseFloat(e.audioEnd)&&parseFloat(t.state.audioSelection.start)>=parseFloat(e.audioStart)&&t.setState({parentAnnotationId:e.id,newAnnotationType:e.childrenType,nextChildRank:e.nextChildRank})})),a.setState({openCreateDialog:!0})}else alert("shit")},a.handleEditionState=function(e,t,n){var s="audio"===t?"Editing "+n.annotationLabel+" Start: "+n.start+"/End: "+n.end:"Editing "+window.currentAnnotationEdition.annotationLabel+" Image",o=[];window.currentAnnotationEdition.imageCoords.forEach((function(e){var t=e.areaCoords.split(",");o.push({x:parseFloat(t[0])/parseFloat(t[4]),y:parseFloat(t[1])/parseFloat(t[4]),width:(parseFloat(t[2])-parseFloat(t[0]))/parseFloat(t[4]),height:(parseFloat(t[3])-parseFloat(t[1]))/parseFloat(t[4])})})),a.setState({annotationsPanel:!1,annotationPanel:!1,openEditionNotification:e,editionType:t,editionData:n,editionNotification:s,imageSelection:n,coordinates:o,showImageCanvas:"image"!==t&&a.state.showImageCanvas})},a.handleCreateAnnotation=function(){a.setState({loading:!0});var e=[];window.imageSelectionData&&window.imageSelectionData.forEach((function(t){var n=[];n.push(t.x*window.imageRatio),n.push(t.y*window.imageRatio),n.push((t.x+t.width)*window.imageRatio),n.push((t.y+t.height)*window.imageRatio),n.push(window.imageRatio),e.push({image_id:t.imageId,areaCoords:n.join(",")})}));var t={document_id:a.props.documentId,type:a.state.newAnnotationType,rank:a.state.nextChildRank,parent_id:a.state.parentAnnotationId,imageCoords:e,audioStart:parseFloat(a.state.audioSelection.start),audioEnd:parseFloat(a.state.audioSelection.end)};a.state.parentAnnotationId&&0!==a.state.parentAnnotationId&&le.create(t).then((function(e){a.refreshAnnotations(),a.setState({editionData:e.data,annotationPanel:!0})}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({loading:!1,message:t})}))},a.updateAnnotation=function(){a.setState({loading:!0}),"audio"===a.state.editionType&&le.update(a.state.editionData.annotationId,{audioStart:a.state.editionData.start,audioEnd:a.state.editionData.end}).then((function(e){a.setState({loading:!1}),window.wavesurfer.markers.markers.filter((function(e){return e.label===a.state.editionData.annotationLabel})).forEach((function(e,t){window.wavesurfer.markers.remove(t)})),a.refreshAnnotations(),a.handleCloseEdition()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}));var e=[];"image"===a.state.editionType&&(window.currentAnnotationEdition.imageAddition&&(e=window.currentAnnotationEdition.imageCoords),window.currentAnnotationEdition.data.forEach((function(t){var n=[];n.push(t.x*window.imageRatio),n.push(t.y*window.imageRatio),n.push((t.x+t.width)*window.imageRatio),n.push((t.y+t.height)*window.imageRatio),n.push(window.imageRatio),e.push({image_id:t.imageId,areaCoords:n.join(",")})}))),"image"===a.state.editionType&&le.update(a.state.editionData.annotationId,{imageCoords:e}).then((function(e){a.setState({loading:!1}),window.wavesurfer&&window.wavesurfer.markers.markers.filter((function(e){return e.label===a.state.editionData.annotationLabel})).forEach((function(e,t){window.wavesurfer.markers.remove(t)})),a.refreshAnnotations(),a.handleCloseEdition()}),(function(e){a.setState({loading:!1}),401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.handleCloseEdition=function(e){a.setState({openEditionNotification:!1,editionNotification:"",editionData:{}}),window.currentAnnotationEdition=null},a.refreshParentAnnotationsList=function(){var e=[],t=Object(d.a)(a);a.state.annotations.forEach((function(n){e.push({id:n.id,label:t.props.documentType,childrenType:"TEXT"===t.props.documentType?"S":"W",audioStart:n.audioStart,audioEnd:n.audioEnd});var a=0;n.children_annotations.forEach((function(n){e.push({id:n.id,label:("TEXT"===t.props.documentType?"S":"W")+n.rank,childrenType:"TEXT"===t.props.documentType?"W":"M",audioStart:n.audioStart,audioEnd:n.audioEnd});var s=0;n.children_annotations.forEach((function(t){e.push({id:t.id,label:"S"+n.rank+">W"+t.rank,childrenType:"M",audioStart:t.audioStart,audioEnd:t.audioEnd});e.filter((function(e){return e.id===t.id}))[0].nextChildRank=1,s=s<t.rank?t.rank:s})),e.filter((function(e){return e.id===n.id}))[0].nextChildRank=s+1,a=a<n.rank?n.rank:a})),e.filter((function(e){return e.id===n.id}))[0].nextChildRank=a+1})),a.setState({parentAnnotations:e})},a.loadCanvas=function(e,t){e.imageCoords&&e.imageCoords.forEach((function(n){t.push({image_id:n.image_id,id:e.id,type:e.type,rank:e.rank,areaCoords:n.areaCoords,hasForm:e.forms.length,hasTranslation:e.translations.length})})),e.children_annotations.forEach((function(e){a.loadCanvas(e,t)}))},a.convertAnnotationsToTree=function(e){return Object(P.jsx)(Tn.a,{canHide:"T"!==e.type,content:e.forms&&e.forms.length>0&&e.forms[0].text,type:"T"===e.type?"Annotations":e.type+e.rank,onClick:function(){return a.showAnnotation(e.id)},open:a.props.expanded,children:e.children_annotations&&e.children_annotations.map((function(e){return a.convertAnnotationsToTree(e)}))},e.id)},a.refreshAnnotations=function(){var e=[];le.getDocumentAnnotations(a.props.documentId).then((function(t){a.setState({annotations:t.data.annotations,change:0}),a.refreshParentAnnotationsList(),a.props.refreshDocumentAnnotations(t.data.annotations),a.loadRegions(t.data.annotations),a.loadCanvas(t.data.annotations[0],e),a.setState({imageCanvas:e}),window.coordinates=void 0}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.showAnnotation=function(e){le.get(e).then((function(e){a.setState({annotationPanel:!0,selectedAnnotation:e})}),(function(e){401===e.response.status&&a.props.history.push("/login");var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();alert(t)}))},a.handlePlay=function(){a.setState({playing:!a.state.playing}),window.wavesurfer.playPause()},a.toggleAnnotationsDrawer=function(e,t){return function(e){a.state.change>0&&a.refreshAnnotations(),a.setState({annotationsPanel:t})}},a.toggleImportDrawer=function(e,t){return function(e){a.setState({importPanel:t})}},a.selectionExists=function(e){a.setState({hasImageSelection:e})},a.annotationHasChanged=function(){a.setState({change:a.state.change+1})},a.render=function(){a.loadRegions(a.state.annotations);var e=a.props.documentType;function t(e){var t=e.children,n=e.value,a=e.index,s=e.id,o=Object(Re.a)(e,["children","value","index","id"]);return Object(P.jsx)("div",Object(r.a)(Object(r.a)({role:"tabpanel",hidden:n!==a,id:"image-tabpanel-".concat(s),"aria-labelledby":"image-tab-".concat(a)},o),{},{children:n===a&&Object(P.jsx)(N.a,{div:3,children:Object(P.jsx)(L.a,{component:"div",children:t})})}))}var n=[],o=[],i=Object(d.a)(a);return a.props.images.forEach((function(e,a){void 0!==localStorage["image"+e.id]?localStorage["image"+e.id]=e["TO_BASE64(content)"]:localStorage.setItem("image"+e.id,e["TO_BASE64(content)"]);var s=i.state.imageCanvas.filter((function(t){return t.image_id===e.id}));n.push(Object(P.jsx)(_e.a,Object(r.a)({label:e.name},function(e){return{id:"image-tab-".concat(e),"aria-controls":"image-tabpanel-".concat(e)}}(e.name)))),o.push(Object(P.jsx)(t,{value:i.state.tabValue,index:a,id:e.id,children:Object(P.jsx)(Ut,{image:e,annotations:i.state.annotations,canvas:s,coordinates:i.state.coordinates,showAnnotation:i.showAnnotation,showImageCanvas:i.state.showImageCanvas,selectionExists:i.selectionExists,children:0},e.id)},e.id))})),Object(P.jsxs)(s.a.Fragment,{children:[null===a.props.recording?Object(P.jsx)(L.a,{children:"No recording"}):Object(P.jsxs)("div",{children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"Play",onClick:a.handlePlay,children:a.state.playing?Object(P.jsx)(It.a,{}):Object(P.jsx)(Dt.a,{})}),Object(P.jsxs)(D.a,{container:!0,spacing:2,children:[Object(P.jsx)(D.a,{item:!0,children:Object(P.jsx)(_t.a,{})}),Object(P.jsx)(D.a,{item:!0,xs:!0,children:Object(P.jsx)(Pt.a,{value:a.state.zoom,onChange:a.handleSliderChange,"aria-labelledby":"zoom-slider"})}),Object(P.jsx)(D.a,{item:!0,children:Object(P.jsx)(Lt.a,{})})]}),Object(P.jsxs)("div",{hidden:null===a.props.recording,children:[Object(P.jsx)("div",{id:"wave-timeline"}),Object(P.jsx)("div",{id:"wave-minimap"}),Object(P.jsx)("div",{id:"wave-regions"}),Object(P.jsx)("div",{id:"waveform",children:Object(P.jsx)("audio",{id:"track",src:"data:audio/mpeg;base64,"+a.props.recording["TO_BASE64(content)"],type:"audio/mp3"})})]})]}),Object(P.jsxs)("span",{children:[Object(P.jsx)(De.a,{icon:Object(P.jsx)(xe.a,{}),label:"Import Annotations",clickable:!0,size:"small",color:"primary",onClick:a.toggleImportDrawer(a.state.importPanel,!0)}),Object(P.jsx)(Et.a,{anchor:"right",open:a.state.importPanel,onClose:a.toggleImportDrawer(a.state.importPanel,!1),children:Object(P.jsx)("div",{role:"presentation",children:Object(P.jsx)(Cn,{documentId:a.props.documentId,refreshAnnotations:a.refreshAnnotations})})})]}),Object(P.jsxs)("span",{children:[Object(P.jsx)(De.a,{icon:Object(P.jsx)(me.a,{}),label:"Create Annotation",clickable:!0,size:"small",color:"primary",onClick:a.handleOpenCreateDialog}),Object(P.jsx)(Et.a,{anchor:"bottom",open:a.state.annotationPanel,onClose:a.handleCloseCreateDrawer,children:Object(P.jsx)("div",{role:"presentation",children:Object(P.jsx)(wn,{data:a.state.selectedAnnotation,documentType:e,refreshAnnotations:a.refreshAnnotations,handleEditionState:a.handleEditionState,parentAnnotations:a.state.parentAnnotations,available_lang:a.props.available_lang,available_kindOf:a.props.available_kindOf,annotationHasChanged:a.annotationHasChanged,onClose:a.handleCloseCreateDrawer})})})]}),a.convertAnnotationsToTree(a.state.annotations[0]),a.props.images.length>0?Object(P.jsxs)("div",{children:[Object(P.jsx)(Le.a,{position:"static",children:Object(P.jsx)(Fe.a,{value:a.state.tabValue,onChange:function(e,t){a.setState({tabValue:t}),window.tabValue=t},"aria-label":"simple tabs example",children:n})}),Object(P.jsx)(E.a,{control:Object(P.jsx)(kt.a,{checked:a.state.showImageCanvas,onChange:a.handleShowImageCanvas,name:"showImageCanvas"}),label:"Show image selections"}),o]}):Object(P.jsx)(L.a,{children:"No image"}),Object(P.jsx)(mt.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a.state.openEditionNotification,autoHideDuration:null,message:a.state.editionNotification,action:Object(P.jsxs)(s.a.Fragment,{children:[a.state.loading?Object(P.jsx)(y.a,{}):Object(P.jsx)(S.a,{color:"secondary",size:"small",onClick:a.updateAnnotation,children:"Update"}),Object(P.jsx)(de.a,{size:"small","aria-label":"close",color:"inherit",onClick:a.handleCloseEdition,children:Object(P.jsx)(pt.a,{fontSize:"small"})})]})}),Object(P.jsxs)(ve.a,{open:a.state.openCreateDialog,onClose:a.handleCloseCreateDialog,"aria-labelledby":"form-createdialog-title",children:[Object(P.jsx)(Ce.a,{id:"form-createdialog-title",children:"Create annotation"}),Object(P.jsx)(we.a,{children:Object(P.jsxs)(Se.a,{children:[Object(P.jsxs)(Ae.a,{component:"fieldset",children:[Object(P.jsx)(Xt.a,{component:"legend",children:"Level"}),Object(P.jsxs)(zt.a,{row:!0,"aria-label":"position",name:"newAnnotationType",onChange:a.handleNewAnnotationTypeChange,value:a.state.newAnnotationType,children:["TEXT"===a.props.documentType&&Object(P.jsx)(E.a,{value:"S",control:Object(P.jsx)(Bt.a,{color:"primary"}),label:"Sentence",labelPlacement:"top"}),Object(P.jsx)(E.a,{value:"W",control:Object(P.jsx)(Bt.a,{color:"primary"}),label:"Word",labelPlacement:"top"}),Object(P.jsx)(E.a,{value:"M",control:Object(P.jsx)(Bt.a,{color:"primary"}),label:"Morpheme",labelPlacement:"top"})]})]}),Object(P.jsxs)(Ae.a,{children:[Object(P.jsx)(ke.a,{shrink:!0,htmlFor:"select-multiple-native",children:"Parent annotation"}),Object(P.jsx)(Ee.a,{native:!0,value:a.state.parentAnnotationId,onChange:a.handleParentAnnotationChange,inputProps:{id:"select-parent-annotation"},children:a.state.parentAnnotations.map((function(e){return Object(P.jsx)("option",{value:e.id,childrenType:e.childrenType,nextChildRank:e.nextChildRank,disabled:a.state.newAnnotationType!==e.childrenType,hidden:a.state.newAnnotationType!==e.childrenType,audioStart:e.audioStart,audioEnd:e.audioEnd,selected:a.state.newAnnotationType===e.childrenType&&e.audioStart<=a.state.audioSelection.start&&e.audioEnd>=a.state.audioSelection.end,children:e.label},e.id)}))})]})]})}),Object(P.jsxs)(ye.a,{children:[Object(P.jsx)(S.a,{onClick:a.handleCloseCreateDialog,color:"primary",children:"Cancel"}),!a.state.loading&&a.state.parentAnnotationId>0&&a.state.newAnnotationType&&Object(P.jsx)(S.a,{onClick:a.handleCreateAnnotation,color:"primary",children:"Create annotation"}),a.state.loading&&Object(P.jsx)(y.a,{})]})]}),Object(P.jsx)("div",{style:{minHeight:"90px"}})]})},a.state={playing:!1,zoom:10,tabValue:window.tabValue?window.tabValue:0,crop:null,annotationsPanel:!1,annotationPanel:!1,importPanel:!1,annotations:a.props.annotations,change:0,openEditionNotification:window.currentAnnotationEdition&&null!==window.currentAnnotationEdition,editionNotification:"",editionType:"audio",editionData:{},audioSelection:!1,imageSelection:!1,openCreateDialog:!1,newAnnotationType:null,parentAnnotations:[],parentAnnotationId:0,nextChildRank:0,selectedAnnotation:{},imageCanvas:[],showImageCanvas:!0,hasAudioSelection:!1},a.previewCanvasRef=s.a.createRef(),a}return Object(c.a)(n,[{key:"saveRegions",value:function(){localStorage.regions=JSON.stringify(Object.keys(window.wavesurfer.regions.list).map((function(e){var t=window.wavesurfer.regions.list[e];return{start:t.start,end:t.end,attributes:t.attributes,data:t.data}})))}},{key:"loadRegions",value:function(e){var t=this;window.wavesurfer&&e.forEach((function(e){var n=e.id+"_"+e.type+e.rank;window.wavesurfer.regions.list[e.id]&&window.wavesurfer.regions.list[e.id].remove(),"T"!==e.type&&(window.wavesurfer.addRegion({id:e.id,start:e.audioStart,end:e.audioEnd,drag:!1,resize:!1,color:"rgba(0,0,0,0.2)",showTooltip:!0,attributes:{title:"Region"}}),window.wavesurfer.markers.markers.filter((function(e){return e.label===n})).forEach((function(e,t){window.wavesurfer.markers.remove(t)})),window.wavesurfer.addMarker({time:e.audioStart,label:n,color:"S"===e.type?"red":"blue",position:"S"===e.type?"bottom":"top"})),e.children_annotations.length>0&&t.loadRegions(e.children_annotations)}))}},{key:"componentDidMount",value:function(){var e=this;if(this.refreshParentAnnotationsList(),null!==this.props.recording){var t=document.querySelector("#track"),n=this;window.wavesurfer=ft.a.create({cursorWidth:1,container:"#waveform",progressColor:"#2D5BFF",responsive:!0,waveColor:"#999999",cursorColor:"transparent",height:100,pixelRatio:1,scrollParent:!0,normalize:!0,minimap:!0,backend:"MediaElement",plugins:[St.a.create({container:"#wave-regions",preventContextMenu:!1}),yt.a.create({height:30,waveColor:"#ddd",progressColor:"#999",cursorColor:"#999"}),xt.a.create({container:"#wave-timeline"}),Tt.a.create({markers:[]})]}),window.wavesurfer.on("ready",(function(){window.wavesurfer.enableDragSelection({color:"rbga(0,150,90,0.5)"}),n.state.annotations&&n.state.annotations.forEach((function(e){e.start=e.audioStart,e.end=e.audioEnd,e.data={},e.attributes={label:"W"===e.type?e.type+e.rank:""}}))})),window.wavesurfer.on("pause",(function(){n.setState({playing:!1})})),window.wavesurfer.on("region-click",(function(e,t){n.setState({playing:!0}),t.stopPropagation(),t.shiftKey?e.playLoop():e.play()})),window.wavesurfer.on("region-updated",(function(e){var t=e.wavesurfer.regions.list,a=Object.keys(t).filter((function(e){return e.indexOf("wavesurfer")>=0}));a.length>1&&t[a[0]].remove(),e.element.style["z-index"]=10,window.currentAnnotationEdition&&n.handleEditionState(!0,"audio",{annotationLabel:window.currentAnnotationEdition.label,annotationId:window.currentAnnotationEdition.id,start:e.start.toFixed(2),end:e.end.toFixed(2)}),n.setState({audioSelection:{start:e.start.toFixed(2),end:e.end.toFixed(2)},hasAudioSelection:!0})})),window.wavesurfer.on("region-dblclick",(function(e,t){window.wavesurfer.pause(),t.stopPropagation()})),window.wavesurfer.on("marker-click",(function(e,t){n.showAnnotation(e.label.split("_")[0]),t.stopPropagation()})),window.wavesurfer.on("region-play",(function(e){e.once("out",(function(){window.wavesurfer.play(e.start),window.wavesurfer.pause()}))})),window.wavesurfer.load(t)}this.handleSliderChange(100,10);var a=[];this.loadCanvas(this.state.annotations[0],a),this.setState({imageCanvas:a}),window.addEventListener("wheel",(function(t){if("WAVE"===t.target.tagName||"REGION"===t.target.tagName){t.preventDefault(),t.stopPropagation();var n=e.state.zoom+Math.round(t.deltaY/50);return n>=0&&n<=100&&e.handleSliderChange(100,n),!1}}),{passive:!1})}}]),n}(s.a.Component),An=Object(m.f)(kn),Dn=n(516),Nn=n(570),In=n(61),Rn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={textTranscriptions:a.props.displayOptions.textTranscriptions.length>0?a.props.displayOptions.textTranscriptions:[],textTranslations:a.props.displayOptions.textTranslations.length>0?a.props.displayOptions.textTranslations:[],sentenceTranscriptions:a.props.displayOptions.sentenceTranscriptions.length>0?a.props.displayOptions.sentenceTranscriptions:[a.props.options.sentence.transcriptions[0]],sentenceTranslations:a.props.displayOptions.sentenceTranslations.length>0?a.props.displayOptions.sentenceTranslations:[a.props.options.sentence.translations[0]],wordTranscriptions:a.props.displayOptions.wordTranscriptions.length>0?a.props.displayOptions.wordTranscriptions:[],wordTranslations:a.props.displayOptions.wordTranslations.length>0?a.props.displayOptions.wordTranslations:[],morphemeTranscriptions:a.props.displayOptions.morphemeTranscriptions.length>0?a.props.displayOptions.morphemeTranscriptions:[],morphemeTranslations:a.props.displayOptions.morphemeTranslations.length>0?a.props.displayOptions.morphemeTranslations:[],displayNotes:a.props.displayOptions.notes,lang:a.props.displayOptions.lang,mode:a.props.displayOptions.mode,continuousPlay:a.props.displayOptions.continuousPlay},a}return Object(c.a)(n,[{key:"buildUrl",value:function(){}},{key:"handleTranscriptionOptions",value:function(e){if(console.log(e.target.name),console.log(this.props.options),e.target.name.length>0){var t=e.target.name.split("-"),n=[t[0]]+"Transcriptions",a=this.state[[t[0]]+"Transcriptions"];console.log(n);var s=e.target.name.split(t[0]+"-"),o=a.indexOf(s[1]);if(o>-1)a.splice(o,1),console.log(a),document.querySelectorAll(".transcription."+e.target.name).forEach((function(e){e.style.display="none"}));else{a.push(s[1]);var i=this.props.isWordList;document.querySelectorAll(".transcription."+e.target.name).forEach((function(e){e.style.display=i?"table-cell":"block"}))}this.setState(Object(Pe.a)({},t[0]+"Transcriptions",a),this.buildUrl()),console.log(this.props.options)}}},{key:"handleTranslationOptions",value:function(e){if(e.target.name.length>0){var t=e.target.name.split("-"),n=this.state[[t[0]]+"Translations"],a=e.target.name.split(t[0]+"-"),s=n.indexOf(a[1]);if(s>-1)n.splice(s,1),document.querySelectorAll(".translation."+e.target.name).forEach((function(e){e.style.display="none"}));else{n.push(a[1]);var o=this.props.isWordList;document.querySelectorAll(".translation."+e.target.name).forEach((function(e){e.style.display=o?"table-cell":"block"}))}this.setState(Object(Pe.a)({},t[0]+"Translations",n),this.buildUrl())}}},{key:"handleNotesOptions",value:function(e){if(e.target.name.length>0){var t=this.state.displayNotes,n=t.indexOf(e.target.name);n>-1?(t.splice(n,1),document.querySelectorAll(".note."+e.target.name).forEach((function(e){e.style.display="none"}))):(t.push(e.target.name),document.querySelectorAll(".note."+e.target.name).forEach((function(e){e.style.display="block"})),document.querySelectorAll("sup.note."+e.target.name).forEach((function(e){e.style.display="inline-block"}))),this.setState({displayNotes:t},this.buildUrl())}}},{key:"handleCheck",value:function(e){e.target.name.length>0&&this.setState(Object(Pe.a)({},e.target.name,e.target.checked),this.buildUrl())}},{key:"render",value:function(){var e=this;return this.buildUrl(),Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:Object(P.jsx)(In.b,{text:"Display options"})}),Object(P.jsx)(Dn.a,{row:!0,children:Object(P.jsx)("div",{className:"optionContinuousPlay",hidden:0===this.state.continuousPlay.length,children:Object(P.jsx)(E.a,{labelPlacement:"start",control:Object(P.jsx)(k.a,{checked:!0===this.state.continuousPlay,onChange:this.handleCheck.bind(this),name:"continuousPlay"}),label:Object(P.jsx)(In.b,{text:"Continuous play"})},"continuousPlay")})}),Object(P.jsx)(Nn.a,{}),Object(P.jsxs)(Dn.a,{row:!0,children:[Object(P.jsxs)("div",{className:"optionTransc",hidden:0===this.props.options.text.transcriptions.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Text transcription"})}),Object(P.jsx)(Dn.a,{children:this.props.options.text.transcriptions.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.textTranscriptions.includes(t),onChange:e.handleTranscriptionOptions.bind(e),name:"text-"+t}),label:t},"textTranscription"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransl",hidden:0===this.props.options.text.translations.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Text translation"})}),Object(P.jsx)(Dn.a,{children:this.props.options.text.translations.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.textTranslations.includes(t),onChange:e.handleTranslationOptions.bind(e),name:"text-"+t}),label:t},"textTranslation"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransc",hidden:0===this.props.options.sentence.transcriptions.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Sentence transcription"})}),Object(P.jsx)(Dn.a,{children:this.props.options.sentence.transcriptions.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.sentenceTranscriptions.includes(t),onChange:e.handleTranscriptionOptions.bind(e),name:"sentence-"+t}),label:t},"sentenceTranscription"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransl",hidden:0===this.props.options.sentence.translations.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Sentence translation"})}),Object(P.jsx)(Dn.a,{children:this.props.options.sentence.translations.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.sentenceTranslations.includes(t),onChange:e.handleTranslationOptions.bind(e),name:"sentence-"+t}),label:t},"textTranslation"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransc",hidden:0===this.props.options.word.transcriptions.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Word transcription"})}),Object(P.jsx)(Dn.a,{children:this.props.options.word.transcriptions.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.wordTranscriptions.includes(t),onChange:e.handleTranscriptionOptions.bind(e),name:"word-"+t}),label:t},"wordTranscription"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransl",hidden:0===this.props.options.word.translations.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Word translation"})}),Object(P.jsx)(Dn.a,{children:this.props.options.word.translations.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.wordTranslations.includes(t),onChange:e.handleTranslationOptions.bind(e),name:"word-"+t}),label:t},"wordTranslation"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransc",hidden:0===this.props.options.morpheme.transcriptions.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Morpheme transcription"})}),Object(P.jsx)(Dn.a,{children:this.props.options.morpheme.transcriptions.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.morphemeTranscriptions.includes(t),onChange:e.handleTranscriptionOptions.bind(e),name:"morpheme-"+t}),label:t},"morphemeTranscription"+t)}))})]}),Object(P.jsxs)("div",{className:"optionTransl",hidden:0===this.props.options.morpheme.translations.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:Object(P.jsx)(In.b,{text:"Morpheme translation"})}),Object(P.jsx)(Dn.a,{children:this.props.options.morpheme.translations.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.morphemeTranslations.includes(t),onChange:e.handleTranslationOptions.bind(e),name:"morpheme-"+t}),label:t},"morphemeTranslation"+t)}))})]}),Object(P.jsxs)("div",{className:"optionNotes",hidden:0===this.props.options.note.translations.length,children:[Object(P.jsx)(Xt.a,{component:"legend",children:"Notes"}),Object(P.jsx)(Dn.a,{children:this.props.options.note.translations.map((function(t){return Object(P.jsx)(E.a,{control:Object(P.jsx)(k.a,{checked:e.state.displayNotes.includes(t),onChange:e.handleNotesOptions.bind(e),name:t}),label:t},"note"+t)}))})]})]})]})}}]),n}(s.a.Component),Ln=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.type="text/javascript";e.innerHTML="var wordidList=[];var startTimeList=[];var endTimeList=[];var timeList=[];document.getElementById('player').ontimeupdate=function(){updatePosition(this.currentTime)};",this.instance.appendChild(e),window.highlight=function(e,t){"S"!==t&&(document.querySelectorAll('canvas:not([wordid=""]').forEach((function(e){e.style.border="none"})),document.querySelectorAll('[wordid="'+e+'"]').forEach((function(e){e.style.border="solid"})),document.querySelectorAll(".WORD").forEach((function(e){e.style.border="none"})),document.querySelector("#"+e).style.border="solid")},window.updatePosition=function(e){var t=window.timeList.find((function(t){return t.start<e&&t.end>e}));if(void 0!==t){var n=window.isWordList?t.word:t.sentence;if(window.currentSentence!==n&&(void 0!==window.currentSentence&&document.getElementById(window.currentSentence).classList.remove("currentSentence"),n)){document.getElementById(n).classList.add("currentSentence"),window.currentSentence=n;var a=new Event("sentence-changed");document.dispatchEvent(a),document.getElementById(n).scrollIntoView({block:"center"})}}var s,o=window.timeList.find((function(t){return t.start<e&&t.end>e&&"S"!==t.type}));void 0===o||window.isWordList||window.highlight(null!==(s=o.morpheme)&&void 0!==s?s:o.word,o.type)},this.props.playerIsLoaded()}},{key:"render",value:function(){var e,t=this,n={width:"80%"};return e="audio"===this.props.file.type?Object(P.jsxs)("audio",{ref:function(e){return t.audio=e},id:"player",controls:!0,preload:"auto",style:n,children:[Object(P.jsx)("source",{src:"data:audio/mpeg;base64,"+this.props.file.content,type:"audio/mpeg"}),Object(P.jsx)("track",{label:"Transcription & Translation",id:"test"}),Object(P.jsx)("track",{label:"Transcription",id:"trackTranscription"}),Object(P.jsx)("track",{label:"Translation",id:"trackTranslation"}),"Your browser does not support the",Object(P.jsx)("code",{children:"audio"})," element."]}):Object(P.jsxs)("video",{ref:function(e){return t.video=e},id:"player",controls:!0,preload:"auto",style:n,children:[Object(P.jsx)("source",{src:this.props.file.url,type:"video/mp4"}),Object(P.jsx)("track",{label:"Transcription & Translation",id:"test"}),Object(P.jsx)("track",{label:"Transcription",id:"trackTranscription"}),Object(P.jsx)("track",{label:"Translation",id:"trackTranslation"}),"Your browser does not support the",Object(P.jsx)("code",{children:"video"})," element."]}),Object(P.jsx)("div",{ref:function(e){return t.instance=e},children:e})}}]),n}(s.a.Component),Fn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){document.querySelectorAll(".pictureBlock canvas").forEach((function(e){e.onmouseover=function(){window.highlight&&window.highlight(this.attributes.wordid.nodeValue,"W")}}))}},{key:"render",value:function(){var e=this,t=[],n=[];return this.props.canvas&&this.props.canvas.forEach((function(e){n[e.props.image]||(n[e.props.image]=[]),n[e.props.image].push(e)})),this.props.area&&this.props.area.forEach((function(a){var s=a.coords.split(","),o=s[3]-s[1],i=s[2]-s[0],r="#map_"+e.props.sentenceId,l="-"+s[0]+"px -"+s[1]+"px",c={"background-position":l,width:i+"px",height:o+"px",padding:"0px",border:"0px","object-fit":"none","object-position":l,"max-width":"inherit !important"};t.push(Object(P.jsxs)("div",{style:{position:"relative",textAlign:"initial"},children:[Object(P.jsx)("img",{alt:a.image,src:"data:image/png;base64,"+localStorage[a.image],style:c,width:i,height:o,usemap:r}),n[a.image]]}))})),Object(P.jsx)("div",{class:"pictureBlock",sentenceId:this.props.sentenceId,children:t})}}]),n}(s.a.Component),_n=n(206),Pn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(P.jsxs)("div",{class:"note ".concat(this.props.lang),hidden:this.props.hidden,children:[Object(P.jsx)("span",{class:"circle",children:this.props.id}),this.props.note]})}}]),n}(s.a.Component),Mn=n(571),Wn=n(572),Un=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a,s;return Object(l.a)(this,n),(s=t.call(this,e)).handleClick=function(e){s.setState({anchorEl:e.currentTarget,open:!0}),e.currentTarget.id.length>0&&(document.querySelectorAll("canvas").forEach((function(e){return e.style.border="none"})),document.querySelector('[wordid="'+e.currentTarget.id+'"]').style.border="solid")},s.handleClose=function(){s.setState({anchorEl:null,open:!1}),document.querySelectorAll("canvas").forEach((function(e){return e.style.border="none"}))},s.state={anchorEl:null,open:!1},s.idNote=null!==(a=s.props.idNote-1)&&void 0!==a?a:1,s}return Object(c.a)(n,[{key:"playSentence",value:function(){document.getElementById("player").currentTime=this.props.w.AUDIO.start,document.getElementById("player").play()}},{key:"pauseSentence",value:function(){document.getElementById("player").pause()}},{key:"getNotes",value:function(e,t){var n=this;void 0!==e.NOTE&&null!==e.NOTE&&(void 0===e.NOTE.length?(t.push({id:this.idNote,note:e.NOTE.message+e.NOTE.text,hidden:!this.props.displayOptions.notes.includes(e.NOTE["xml:lang"]),lang:e.NOTE["xml:lang"]}),this.idNote++):e.NOTE.forEach((function(e){t.push({id:n.idNote,note:e.message+e.text,hidden:!n.props.displayOptions.notes.includes(e["xml:lang"]),lang:e["xml:lang"]}),n.idNote++})))}},{key:"render",value:function(){var e=this,t=[],n=[],a=[],s=[],o=!1,i="";return void 0!==this.props.w.TRANSL&&null!==this.props.w.TRANSL&&(void 0===this.props.w.TRANSL.length?(o=this.props.displayOptions.morphemeTranslations.includes(this.props.w.TRANSL["xml:lang"]),i=!0===this.props.isWordList?"wordlistWord":"morpheme",n.push(Object(P.jsx)(L.a,{variant:"body2",component:!0===this.props.isWordList?"div":"p",style:o?{visibility:"inherit"}:{display:"none"},className:"translation ".concat(i," morpheme-").concat(this.props.w.TRANSL["xml:lang"]),children:this.props.w.TRANSL.text}))):this.props.w.TRANSL.forEach((function(t){o=e.props.displayOptions.morphemeTranslations.includes(t["xml:lang"]),i=!0===e.props.isWordList?"wordlistWord":"morpheme",n.push(Object(P.jsx)(L.a,{variant:"body2",component:!0===e.props.isWordList?"div":"p",style:o?{visibility:"inherit"}:{display:"none"},className:"translation ".concat(i," morpheme-").concat(t["xml:lang"]),children:t.text}))}))),this.getNotes(this.props.w,s),s.forEach((function(e){a.push(Object(P.jsx)(Pn,{id:e.id,note:e.note,hidden:e.hidden,lang:e.lang}))})),void 0!==this.props.w.FORM&&null!==this.props.w.FORM&&(void 0===this.props.w.FORM.length?(o=this.props.displayOptions.morphemeTranscriptions.includes(this.props.w.FORM.kindOf),i=!0===this.props.isWordList?"wordlistWord":"morpheme",t.push(Object(P.jsxs)(L.a,{variant:"body2",component:"p",style:o?{visibility:"inherit"}:{display:"none"},className:"transcription ".concat(i," morpheme-").concat(this.props.w.FORM.kindOf),children:[this.props.w.FORM.text,s.map((function(e){return Object(P.jsx)("sup",{class:"circle note "+e.lang,children:e.id})}))]}))):this.props.w.FORM.forEach((function(n){o=e.props.displayOptions.morphemeTranscriptions.includes(n.kindOf),i=!0===e.props.isWordList?"wordlistWord":"morpheme",t.push(Object(P.jsxs)(L.a,{variant:"body2",component:"p",className:"transcription ".concat(i," morpheme-").concat(n.kindOf),children:[n.text,s.map((function(e){return Object(P.jsx)("sup",{class:"circle note "+e.lang,children:e.id})}))]}))}))),Object(P.jsx)("div",{id:this.props.w.id,className:"MORPHEME ".concat(this.props.w.hasOwnProperty("class")?this.props.w.class:""),style:!0===this.props.isWordList?{}:{display:"inline-block"},ref:function(t){return e.instance=t},children:!0===this.props.isWordList?Object(P.jsxs)("div",{style:{display:"table"},children:[Object(P.jsxs)("div",{style:{display:"table-cell"},children:["W",this.props.wID]}),Object(P.jsxs)("div",{style:{display:"table-cell"},id:this.props.w.id,hidden:!this.props.displayOptions.words,children:[Object(P.jsx)(de.a,{color:"primary","aria-label":"play",onClick:this.playSentence.bind(this),children:Object(P.jsx)(Mn.a,{})}),Object(P.jsx)(de.a,{color:"primary","aria-label":"play",onClick:this.pauseSentence.bind(this),children:Object(P.jsx)(Wn.a,{})})]}),Object(P.jsx)("div",{style:{display:"table-cell",width:"12em"},class:"morpheme",id:this.props.w.id,hidden:!this.props.displayOptions.words,children:t}),n,Object(P.jsx)("div",{style:{display:"table-cell"},children:a})]}):Object(P.jsxs)("div",{children:[Object(P.jsx)("p",{children:t}),Object(P.jsx)("p",{children:n})]})})}}]),n}(s.a.Component),Bn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).showPlayPause=function(e){a.setState({displayPlay:document.getElementById("player").paused})},a.state={displayPlay:document.getElementById("player").paused,duration:1e3*(a.props.end-a.props.start)},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){document.getElementById("player").addEventListener("pause",this.showPlayPause),document.getElementById("player").addEventListener("playing",this.showPlayPause)}},{key:"playPause",value:function(){var e=document.getElementById("player");e.paused?(e.currentTime=this.props.start,e.play(),document.getElementsByName("continuousPlay")[0].checked||setTimeout((function(){e.pause()}),this.state.duration)):e.pause(),this.setState({displayPlay:e.paused})}},{key:"render",value:function(){return Object(P.jsxs)(de.a,{color:"primary","aria-label":"play",onClick:this.playPause.bind(this),children:[Object(P.jsx)(Mn.a,{style:{display:this.state.displayPlay?"block":"none"}}),Object(P.jsx)(Wn.a,{style:{display:this.state.displayPlay?"none":"block"}})]})}}]),n}(s.a.Component),zn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleClick=function(e){a.setState({anchorEl:e.currentTarget,open:!0}),e.currentTarget.id.length>0&&(document.querySelectorAll("canvas").forEach((function(e){return e.style.border="none"})),document.querySelector('[wordid="'+e.currentTarget.id+'"]').style.border="solid")},a.handleClose=function(){a.setState({anchorEl:null,open:!1}),document.querySelectorAll("canvas").forEach((function(e){return e.style.border="none"}))},a.state={anchorEl:null,open:!1},a.idNote=isNaN(a.props.idNote)?1:a.props.idNote-1,a}return Object(c.a)(n,[{key:"highlight",value:function(){window.highlight&&window.highlight(this.props.w.id,"W")}},{key:"getNotes",value:function(e,t){var n=this;void 0!==e.NOTE&&null!==e.NOTE&&(void 0===e.NOTE.length?(t.push({id:this.idNote,note:e.NOTE.message+e.NOTE.text,hidden:!this.props.displayOptions.notes.includes(e.NOTE["xml:lang"]),lang:e.NOTE["xml:lang"]}),this.idNote++):e.NOTE.forEach((function(e){t.push({id:n.idNote,note:e.message+e.text,hidden:!n.props.displayOptions.notes.includes(e["xml:lang"]),lang:e["xml:lang"]}),n.idNote++})))}},{key:"render",value:function(){var e=this;this.idNote=isNaN(this.props.idNote)?1:this.props.idNote-1;var t=[],n=[],a=[],o=[],i=Boolean(this.state.anchorEl),l=i?"simple-popper":void 0,c=!1,d="",p={},h={visibility:"inherit"},u={display:"none"},m=Object(r.a)(Object(r.a)({},p),h),g=Object(r.a)(Object(r.a)({},p),u);if(void 0!==this.props.w.TRANSL&&null!==this.props.w.TRANSL&&(void 0===this.props.w.TRANSL.length?(c=this.props.displayOptions.wordTranslations.includes(this.props.w.TRANSL["xml:lang"]),d=!0===this.props.isWordList?"wordlistWord":"word",!0===this.props.isWordList?this.props.availableOptions.word.translations.forEach((function(t){t===e.props.w.TRANSL["xml:lang"]?n.push(Object(P.jsx)(L.a,{variant:"body2",component:"td",style:c?m:g,className:"translation ".concat(d," word-").concat(e.props.w.TRANSL["xml:lang"]),children:e.props.w.TRANSL.text})):n.push(Object(P.jsx)(L.a,{variant:"body2",component:"td",style:c?m:g,className:"translation ".concat(d," word-").concat(e.props.w.TRANSL["xml:lang"])}))})):n.push(Object(P.jsx)(De.a,{style:c?h:u,className:"translation ".concat(d," word-").concat(this.props.w.TRANSL["xml:lang"]),label:this.props.w.TRANSL.text}))):!0===this.props.isWordList?this.props.availableOptions.word.translations.forEach((function(t){var a=!1;c=e.props.displayOptions.wordTranslations.includes(t),d="wordlistWord",e.props.w.TRANSL.forEach((function(e){t===e["xml:lang"]&&(a=!0,n.push(Object(P.jsx)(L.a,{variant:"body2",component:"td",style:c?m:g,className:"translation ".concat(d," word-").concat(e["xml:lang"]),children:e.text})))})),!1===a&&n.push(Object(P.jsx)(L.a,{variant:"body2",component:"td",style:c?m:g,className:"translation ".concat(d," word-").concat(t)}))})):this.props.w.TRANSL.forEach((function(t){c=e.props.displayOptions.wordTranslations.includes(t["xml:lang"]),d="word",n.push(Object(P.jsx)(De.a,{style:c?h:u,className:"translation ".concat(d," word-").concat(t["xml:lang"]),label:t.text}))}))),this.getNotes(this.props.w,o),o.forEach((function(e){a.push(Object(P.jsx)(Pn,{id:e.id,note:e.note,hidden:e.hidden,lang:e.lang}))})),void 0!==this.props.w.FORM&&null!==this.props.w.FORM)if(void 0===this.props.w.FORM.length){var j;c=this.props.displayOptions.wordTranscriptions.includes(this.props.w.FORM.kindOf),d=!0===this.props.isWordList?"wordlistWord":"word",j=c?!0===this.props.isWordList?m:h:!0===this.props.isWordList?g:u;var b=o.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}));!0===this.props.isWordList?t.push(Object(P.jsxs)(L.a,{variant:"body2",component:"td",style:j,className:"transcription ".concat(d," word-").concat(this.props.w.FORM.kindOf),children:[this.props.w.FORM.text,o.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}))]})):t.push(Object(P.jsxs)("div",{children:[Object(P.jsx)(De.a,{style:j,className:"transcription ".concat(d," word-").concat(this.props.w.FORM.kindOf),label:this.props.w.FORM.text}),b]}))}else this.props.w.FORM.forEach((function(n){var a;c=e.props.displayOptions.wordTranscriptions.includes(n.kindOf),d=!0===e.props.isWordList?"wordlistWord":"word",a=c?!0===e.props.isWordList?m:h:!0===e.props.isWordList?g:u;var s=o.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}));!0===e.props.isWordList?t.push(Object(P.jsxs)(L.a,{variant:"body2",component:"td",style:a,className:"transcription ".concat(d," word-").concat(n.kindOf),children:[n.text,o.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}))]})):t.push(Object(P.jsxs)("div",{children:[Object(P.jsx)(De.a,{style:a,className:"transcription ".concat(d," word-").concat(n.kindOf),label:n.text,color:"secondary"}),s]}))}));var f=[];return void 0!==this.props.w.M&&null!==this.props.w.M&&(this.props.w.M.length>0?this.props.w.M.forEach((function(t){f.push(Object(P.jsx)(Un,{w:t,displayOptions:e.props.displayOptions,idNote:e.idNote}))})):f.push(Object(P.jsx)(Un,{w:this.props.w.M,displayOptions:this.props.displayOptions,idNote:this.idNote}))),!0===this.props.isWordList?Object(P.jsxs)("tr",{id:this.props.w.id,className:"WORD",style:p,ref:function(t){return e.instance=t},children:[Object(P.jsxs)("td",{style:p,children:[this.props.w.id,Object(P.jsx)(de.a,{"aria-describedby":l,onClick:function(t){e.setState({anchorEl:e.state.anchorEl?null:t.currentTarget})},id:"btn_doi_W"+this.props.sID,children:Object(P.jsx)("img",{className:"doi",src:"/dist/images/DOI_logo.svg",alt:"doi"})}),Object(P.jsx)(_n.a,{id:"doi_W"+this.props.sID,open:i,anchorEl:this.state.anchorEl,test:document.getElementById("btn_doi_W"+this.props.sID),children:Object(P.jsx)("div",{children:this.props.doi})}),this.props.w.hasOwnProperty("AUDIO")?Object(P.jsx)(Bn,{continuousPlay:this.props.displayOptions.continuousPlay,start:this.props.w.AUDIO?this.props.w.AUDIO.start:0,end:this.props.w.AUDIO?this.props.w.AUDIO.end:0,isWordList:!0}):Object(P.jsx)("div",{})]}),Object(P.jsxs)(s.a.Fragment,{children:[t,f,n]}),Object(P.jsx)("td",{className:"notes",children:a})]}):Object(P.jsx)("div",{id:this.props.w.id,onMouseOver:this.highlight.bind(this),className:"WORD ".concat(this.props.w.hasOwnProperty("class")?this.props.w.class:""),style:!0===this.props.isWordList?{}:{display:"inline-block"},ref:function(t){return e.instance=t},children:Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{className:"transcBlock",children:t}),Object(P.jsx)("div",{className:"morphemesBlock",children:f}),Object(P.jsx)("div",{className:"translBlock",children:n})]})})}}]),n}(s.a.Component),Xn=n(573),qn=n(574),Vn=n(276),Hn=n.n(Vn),Kn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={displayOptions:a.props.displayOptions,notes:null,anchorEl:null},a.idNote=1,a}return Object(c.a)(n,[{key:"getNotes",value:function(e,t){var n=this;void 0!==e.NOTE&&null!==e.NOTE&&(void 0===e.NOTE.length?(t.push({id:this.idNote,note:e.NOTE.message+e.NOTE.text,hidden:!this.props.displayOptions.notes.includes(e.NOTE["xml:lang"]),lang:e.NOTE["xml:lang"]}),this.idNote++):e.NOTE.forEach((function(e){t.push({id:n.idNote,note:e.message+e.text,hidden:!n.props.displayOptions.notes.includes(e["xml:lang"]),lang:e["xml:lang"]}),n.idNote++})))}},{key:"render",value:function(){var e=this;this.idNote=1;var t=[],n=[],a=[],s=[],o=[],i=Boolean(this.state.anchorEl),r=i?"simple-popper":void 0;if(null!==this.props.s.TRANSL&&void 0!==this.props.s.TRANSL&&(void 0===this.props.s.TRANSL.length?n.push(Object(P.jsx)(L.a,{hidden:!this.props.displayOptions.sentenceTranslations.includes(this.props.s.TRANSL["xml:lang"]),variant:"body2",component:"p",className:"translation sentence-".concat(this.props.s.TRANSL["xml:lang"]),children:Object(P.jsx)("b",{children:this.props.s.TRANSL.text})})):this.props.s.TRANSL.forEach((function(t){n.push(Object(P.jsx)(L.a,{hidden:!e.props.displayOptions.sentenceTranslations.includes(t["xml:lang"]),variant:"body2",component:"p",className:"translation sentence-".concat(t["xml:lang"]),children:Object(P.jsx)("b",{children:t.text})}))}))),this.getNotes(this.props.s,a),void 0!==this.props.s.FORM&&null!==this.props.s.FORM&&(void 0===this.props.s.FORM.length?t.push(Object(P.jsxs)(L.a,{hidden:!this.props.displayOptions.sentenceTranscriptions.includes(this.props.s.FORM.kindOf),variant:"body2",component:"p",className:"transcription sentence-".concat(this.props.s.FORM.kindOf),children:[Object(P.jsx)("b",{children:this.props.s.FORM.text}),a.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}))]})):this.props.s.FORM.forEach((function(n){t.push(Object(P.jsxs)(L.a,{hidden:!e.props.displayOptions.sentenceTranscriptions.includes(n.kindOf),variant:"body2",component:"p",className:"transcription sentence-".concat(n.kindOf),children:[Object(P.jsx)("b",{children:n.text}),a.map((function(t){return Object(P.jsx)("sup",{style:{display:e.props.displayOptions.notes.includes(t.lang)?"inline-block":"none"},className:"circle note "+t.lang,children:t.id})}))]}))}))),void 0!==this.props.s.AREA&&null!==this.props.s.AREA){var l=[],c=[];this.props.s.AREA.forEach((function(e){var t=e.coords.split(",");l[e.image]=t[0],c[e.image]=t[1]}))}void 0!==this.props.s.W&&null!==this.props.s.W&&Array.isArray(this.props.s.W)&&this.props.s.W.forEach((function(t){if(void 0!==t.M&&null!==t.M){var n,i=[];if(t.M.length>0?(t.M.forEach((function(n){e.getNotes(n,a),i.push(Object(P.jsx)(Un,{wID:t.id,w:n,displayOptions:e.props.displayOptions,idNote:e.idNote}))})),n=Object(P.jsx)(zn,{sID:e.props.s.id,w:t,displayOptions:e.props.displayOptions,idNote:e.idNote}),s.push(n)):(e.getNotes(t.M,a),i.push(Object(P.jsx)(Un,{wID:t.id,w:t.M,displayOptions:e.props.displayOptions,idNote:e.idNote})),n=Object(P.jsx)(zn,{sID:e.props.s.id,w:t,displayOptions:e.props.displayOptions,idNote:e.idNote}),s.push(n)),void 0!==t.AREA&&null!==t.AREA){(p=t.AREA.coords.split(","))[0]-=l[t.AREA.image],p[1]-=c[t.AREA.image],p[2]-=l[t.AREA.image],p[3]-=c[t.AREA.image];var r={position:"absolute",top:p[1],left:p[0]},d="";d=void 0===t.FORM.length?t.FORM.text:void 0!==t.FORM[0]?t.FORM[0].text:"",o.push(Object(P.jsx)("canvas",{image:t.AREA.image,title:d,style:r,wordid:t.id,width:p[2]-p[0],height:p[3]-p[1],onClick:function(){return document.getElementById(t.id).click()}}))}}else if(e.getNotes(t,a),s.push(Object(P.jsx)(zn,{sID:e.props.s.id,w:t,displayOptions:e.props.displayOptions,idNote:e.idNote})),void 0!==t.AREA&&null!==t.AREA){var p;(p=t.AREA.coords.split(","))[0]-=l[t.AREA.image],p[1]-=c[t.AREA.image],p[2]-=l[t.AREA.image],p[3]-=c[t.AREA.image];r={position:"absolute",top:p[1],left:p[0]},d="";d=void 0===t.FORM.length?t.FORM.text:void 0!==t.FORM[0]?t.FORM[0].text:"",o.push(Object(P.jsx)("canvas",{image:t.AREA.image,title:d,style:r,wordid:t.id,width:p[2]-p[0],height:p[3]-p[1],onClick:function(){return document.getElementById(t.id).click()}}))}}));var d=[];a.forEach((function(e){d.push(Object(P.jsx)(Pn,{id:e.id,note:e.note,hidden:e.hidden,lang:e.lang}))}));var p={backgroundColor:Hn.a[800],display:"inline-flex"};return Object(P.jsx)("div",{id:this.props.s.id,className:"SENTENCE",ref:function(t){return e.instance=t},children:Object(P.jsx)(Xn.a,{children:Object(P.jsxs)(qn.a,{children:[void 0!==this.props.s.AREA?Object(P.jsx)(Fn,{sentenceId:this.props.s.id,imageSrc:this.props.imageSrc,canvas:o,area:this.props.s.AREA}):Object(P.jsx)("div",{}),Object(P.jsxs)("div",{style:{textAlign:"initial"},className:"annotationsBlock",children:[Object(P.jsx)(w.a,{"aria-label":"sentenceId",style:p,children:this.props.s.id}),Object(P.jsx)(de.a,{"aria-describedby":r,onClick:function(t){e.setState({anchorEl:e.state.anchorEl?null:t.currentTarget})},id:"btn_doi_"+this.props.s.id,children:Object(P.jsx)("img",{className:"doi",src:"/dist/images/DOI_logo.svg",alt:"doi"})}),Object(P.jsx)(_n.a,{id:"doi_"+this.props.s.id,open:i,anchorEl:this.state.anchorEl,test:document.getElementById("btn_doi_"+this.props.s.id),children:Object(P.jsx)("div",{children:this.props.doi})}),this.props.s.hasOwnProperty("AUDIO")&&window.wavesurfer?Object(P.jsx)(Bn,{continuousPlay:this.state.displayOptions.continuousPlay,start:this.props.s.AUDIO?this.props.s.AUDIO.start:0,end:this.props.s.AUDIO?this.props.s.AUDIO.end:0,id:this.props.s.id}):Object(P.jsx)("div",{}),Object(P.jsx)("div",{className:"transcBlock",style:{display:"inline-block"},children:t}),Object(P.jsx)("div",{className:"wordsBlock",children:s}),Object(P.jsx)("div",{className:"translBlock",children:n}),Object(P.jsx)("div",{className:"notesBlock",children:d})]})]})})})}}]),n}(s.a.Component),Gn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(l.a)(this,n);var s={textTranscriptions:(a=t.call(this,e)).props.displayOptions.textTranscriptions.length>0?a.props.displayOptions.textTranscriptions:[],textTranslations:a.props.displayOptions.textTranslations.length>0?a.props.displayOptions.textTranslations:[],sentenceTranscriptions:a.props.displayOptions.sentenceTranscriptions.length>0?a.props.displayOptions.sentenceTranscriptions:[a.props.availableOptions.sentence.transcriptions[0]],sentenceTranslations:a.props.displayOptions.sentenceTranslations.length>0?a.props.displayOptions.sentenceTranslations:[a.props.availableOptions.sentence.translations[0]],wordTranscriptions:a.props.displayOptions.wordTranscriptions.length>0?a.props.displayOptions.wordTranscriptions:[],wordTranslations:a.props.displayOptions.wordTranslations.length>0?a.props.displayOptions.wordTranslations:[],morphemeTranscriptions:a.props.displayOptions.morphemeTranscriptions.length>0?a.props.displayOptions.morphemeTranscriptions:[],morphemeTranslations:a.props.displayOptions.morphemeTranslations.length>0?a.props.displayOptions.morphemeTranslations:[],displayNotes:a.props.displayOptions.notes,lang:a.props.displayOptions.lang,mode:a.props.displayOptions.mode,continuousPlay:a.props.displayOptions.continuousPlay};return a.state={isLoaded:!1,annotationData:[],displayOptions:s,availableOptions:a.props.availableOptions,isWordList:!1},a}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentDidMount",value:function(){window.timeList=this.props.timeList}},{key:"render",value:function(){var e,t,n,a=this,s=[],o=[],i=[],r=[],l=!1,c="",d=this.props.doi,p=0,h=document.querySelector("#player");if(null!==h&&(e=h.textTracks.getTrackById("test"),t=h.textTracks.getTrackById("trackTranscription"),n=h.textTracks.getTrackById("trackTranslation"),e.mode="showing",t.mode="showing",n.mode="showing"),void 0!==this.props.annotations.TEXT&&null!==this.props.annotations.TEXT)var u=this.props.annotations.TEXT.S;if(void 0!==this.props.annotations.WORDLIST&&null!==this.props.annotations.WORDLIST)var m=this.props.annotations.WORDLIST.W;return null!==u&&void 0!==u&&u.forEach((function(o){void 0!==o.AREA&&void 0!==o.AREA[0]&&void 0!==o.AREA[0].image&&a.props.images.forEach((function(e){c="data:image/png;base64,"+localStorage[o.AREA.image]})),p++;var i=d+"#"+o.id;if(null!==h&&t.cues.length<u.length){var r="",l="";"object"===typeof o.FORM?null!==o.FORM&&(r=o.FORM.text):null!==o.FORM[0].text&&(r=o.FORM[0].text),null!==o.TRANSL&&("object"===typeof o.TRANSL?null!==o.TRANSL&&(l=o.TRANSL.text):null!==o.TRANSL[0].text&&(l=o.TRANSL[0].text));var m=void 0!==o.AUDIO?o.AUDIO.start:0,g=void 0!==o.AUDIO?o.AUDIO.end:0,j=new VTTCue(m,g,r),b=new VTTCue(m,g,l);j.size=99,b.size=99,j.line=12,b.line=14,e.addCue(j),e.addCue(b),t.addCue(j),n.addCue(b)}s.push(Object(P.jsx)(Kn,{doi:i,sID:p,s:o,imageSrc:c,displayOptions:a.state.displayOptions}))})),null!==m&&void 0!==m&&Array.isArray(m)&&(l=!0,this.setState({isWordList:!0}),m.forEach((function(e){if(void 0!==e.M&&null!==e.M)e.M.length>0?e.M.forEach((function(e){s.push(Object(P.jsx)(Un,{w:e,wID:++p,displayOptions:a.state.displayOptions,isWordList:!0}))})):s.push(Object(P.jsx)(Un,{w:e.M,wID:++p,displayOptions:a.state.displayOptions,isWordList:!0}));else{++p;var t=d+"#W"+p;s.push(Object(P.jsx)(zn,{w:e,wID:p,displayOptions:a.state.displayOptions,availableOptions:a.props.availableOptions,isWordList:!0,doi:t}))}}))),void 0!==this.props.annotations.TEXT.FORM&&null!==this.props.annotations.TEXT.FORM&&(void 0===this.props.annotations.TEXT.FORM.length?o.push(Object(P.jsx)(L.a,{hidden:!this.state.displayOptions.textTranscriptions||!this.state.displayOptions.textTranscriptions.includes(this.props.annotations.TEXT.FORM.kindOf),variant:"body2",component:"p",className:"text-"+this.props.annotations.TEXT.FORM.kindOf+" transcription",children:this.props.annotations.TEXT.FORM.text})):this.props.annotations.TEXT.FORM.forEach((function(e){o.push(Object(P.jsx)(L.a,{hidden:!a.state.displayOptions.textTranscriptions||!a.state.displayOptions.textTranscriptions.includes(e.kindOf),variant:"body2",component:"p",className:"text-"+e.kindOf+" transcription",children:e.text},"textForm"+e.kindOf))}))),null!==this.props.annotations.TEXT.TRANSL&&void 0!==this.props.annotations.TEXT.TRANSL&&(void 0===this.props.annotations.TEXT.TRANSL.length?i.push(Object(P.jsx)(L.a,{hidden:!this.state.displayOptions.textTranslations.includes(this.props.annotations.TEXT.TRANSL["xml:lang"]),variant:"body2",component:"p",className:"translation text-".concat(this.props.annotations.TEXT.TRANSL["xml:lang"]),children:this.props.annotations.TEXT.TRANSL.text})):this.props.annotations.TEXT.TRANSL.forEach((function(e){i.push(Object(P.jsx)(L.a,{hidden:!a.state.displayOptions.textTranslations.includes(e["xml:lang"]),variant:"body2",component:"p",className:"translation text-".concat(e["xml:lang"]),children:e.text}))}))),void 0!==this.props.annotations.TEXT.NOTE&&null!==this.props.annotations.TEXT.NOTE&&(void 0===this.props.annotations.TEXT.NOTE.length?r.push(Object(P.jsx)(L.a,{hidden:!this.state.displayOptions.notes.includes(this.props.annotations.TEXT.NOTE["xml:lang"]),variant:"body2",component:"p",className:"note ".concat(this.props.annotations.TEXT.NOTE["xml:lang"]),children:this.props.annotations.TEXT.NOTE.message})):this.props.annotations.TEXT.NOTE.forEach((function(e){r.push(Object(P.jsx)(L.a,{hidden:!a.state.displayOptions.notes.includes(e["xml:lang"]),variant:"body2",component:"p",className:"note ".concat(e["xml:lang"]),children:e.message}))}))),Object(P.jsxs)("div",{ref:function(e){return a.instance=e},children:[Object(P.jsxs)("div",{className:"TEXT",children:[Object(P.jsx)(_.a,{fixed:!0,id:"documentTranscriptionsBlock",children:o}),Object(P.jsx)(_.a,{fixed:!0,id:"documentTranslationsBlock",children:i}),Object(P.jsx)(_.a,{fixed:!0,id:"documentNotesBlock",children:r})]}),Object(P.jsx)(_.a,{fixed:!0,id:"documentAnnotationsBlock",children:l?Object(P.jsx)("table",{children:s}):s}),"pdf"===this.props.extensionFile?Object(P.jsx)(_.a,{children:Object(P.jsx)("object",{data:this.props.urlFile.replace("http:","https:"),type:"application/pdf",width:"100%",height:"500px",children:Object(P.jsx)("embed",{src:this.props.urlFile.replace("http:","https:"),type:"application/pdf"})})}):Object(P.jsx)("div",{})]})}}]),n}(s.a.Component),Jn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={hasPrimaryId:!1,hasSecondaryId:!1,isLoaded:!1,isAnnotationsLoaded:!1,hasMediaError:!1,mediaError:{},hasAnnotationsError:!1,annotationsError:{},MEDIAFILE:{},annotations:{},doi:"",images:[],langOptions:{transcriptions:[],translations:[]},isWordList:!1,timeList:[],urlFile:"",extensionFile:"",playerLoaded:!1},a}return Object(c.a)(n,[{key:"convertToPlayerFormat",value:function(e){var t={},n=[],a=e.children_annotations&&"W"===e.children_annotations[0].type;return t.WORDLIST={},t.TEXT={},t.TEXT.FORM=e.forms,t.TEXT.TRANSL=[],e.translations.forEach((function(e){t.TEXT.TRANSL.push({"xml:lang":e.lang,text:e.text})})),t.WORDLIST.W=[],t.TEXT.S=[],!a&&e.children_annotations.forEach((function(e){var a={AUDIO:{}};a.FORM=e.forms,a.TRANSL=[],e.translations.forEach((function(e){a.TRANSL.push({"xml:lang":e.lang,text:e.text})})),a.id=e.type+e.rank,null!==e.imageCoords&&(a.AREA=[],e.imageCoords.forEach((function(e){a.AREA.push({image:"image"+e.image_id,shape:"rect",coords:e.areaCoords})}))),a.AUDIO.start=e.audioStart,a.AUDIO.end=e.audioEnd,n.push({start:e.audioStart,end:e.audioEnd,sentence:a.id,word:null,morpheme:null,type:"S"}),e.children_annotations.length>0&&(a.W=[],e.children_annotations.forEach((function(e){var t={AUDIO:{}};t.FORM=e.forms,t.TRANSL=[],e.translations.forEach((function(e){t.TRANSL.push({"xml:lang":e.lang,text:e.text})})),t.id=a.id+e.type+e.rank,null!==e.imageCoords&&(t.AREA={},t.AREA.image="image"+e.imageCoords[0].image_id,t.AREA.shape="rect",t.AREA.coords=e.imageCoords[0].areaCoords),t.AUDIO.start=e.audioStart,t.AUDIO.end=e.audioEnd,n.push({start:e.audioStart,end:e.audioEnd,sentence:a.id,word:t.id,morpheme:null,type:"W"}),e.children_annotations.length>0&&(t.M=[],e.children_annotations.forEach((function(e){var s={AUDIO:{}};s.FORM=e.forms,s.TRANSL=[],e.translations.forEach((function(e){s.TRANSL.push({"xml:lang":e.lang,text:e.text})})),s.id=t.id+e.type+e.rank,null!==e.areaCoords&&(s.AREA={},s.AREA.image="image"+e.image_id,s.AREA.shape="rect",s.AREA.coords=e.areaCoords),s.AUDIO.start=e.audioStart,s.AUDIO.end=e.audioEnd,n.push({start:e.audioStart,end:e.audioEnd,sentence:a.id,word:t.id,morpheme:s,type:"M"}),t.M.push(s)}))),a.W.push(t)}))),t.TEXT.S.push(a)})),a&&e.children_annotations.forEach((function(e){var a={AUDIO:{}};a.FORM=e.forms,a.TRANSL=[],e.translations.forEach((function(e){a.TRANSL.push({"xml:lang":e.lang,text:e.text})})),a.id=e.type+e.rank,null!==e.areaCoords&&(a.AREA={},a.AREA.image="image"+e.image_id,a.AREA.shape="rect",a.AREA.coords=e.areaCoords),a.AUDIO.start=e.audioStart,a.AUDIO.end=e.audioEnd,n.push({start:e.audioStart,end:e.audioEnd,sentence:null,word:a.id,morpheme:null,type:"W"}),e.children_annotations.length>0&&(a.M=[],e.children_annotations.forEach((function(e){var t={AUDIO:{}};t.FORM=e.forms,t.TRANSL=[],e.translations.forEach((function(e){t.TRANSL.push({"xml:lang":e.lang,text:e.text})})),t.id=a.id+e.type+e.rank,null!==e.areaCoords&&(t.AREA={},t.AREA.image="image"+e.image_id,t.AREA.shape="rect",t.AREA.coords=e.areaCoords),t.AUDIO.start=e.audioStart,t.AUDIO.end=e.audioEnd,n.push({start:e.audioStart,end:e.audioEnd,sentence:null,word:a.id,morpheme:t,type:"M"}),a.M.push(t)}))),t.WORDLIST.W.push(a)})),{annotations:t,timeList:n}}},{key:"playerIsLoaded",value:function(){this.setState({playerLoaded:!0})}},{key:"componentDidMount",value:function(){this.setState({isAnnotationsLoaded:!0,annotations:this.convertToPlayerFormat(this.props.annotations[0]).annotations,isWordList:"W"===this.props.annotations[0].children_annotations[0].type,urlFile:"",extensionFile:"",MEDIAFILE:{type:"audio",url:"",content:this.props.recording?this.props.recording["TO_BASE64(content)"]:null},displayOptions:this.props.displayOptions,isLoaded:!0}),window.highlight=function(e,t){"S"!==t&&(document.querySelectorAll('canvas:not([wordid=""]').forEach((function(e){e.style.border="none"})),document.querySelectorAll('[wordid="'+e+'"]').forEach((function(e){e.style.border="solid"})),document.querySelectorAll(".WORD").forEach((function(e){e.style.border="none"})),document.querySelector("#"+e).style.border="solid")}}},{key:"render",value:function(){var e=this.convertToPlayerFormat(this.props.annotations[0]),t=e.annotations,n=e.timeList,a=[];return this.props.images.forEach((function(e){a.push({id:"image"+e.id,name:e.name,rank:e.rank})})),Object(P.jsx)("div",{className:"AppPlayer",children:Object(P.jsxs)(_.a,{children:[this.props.recording&&Object(P.jsx)(Ln,{file:{type:"audio",url:"",content:this.props.recording["TO_BASE64(content)"]},playerIsLoaded:this.playerIsLoaded.bind(this)}),Object(P.jsx)(Rn,{displayOptions:this.props.displayOptions,options:this.props.typeOf,isWordList:this.state.isWordList}),this.props.recording&&this.state.playerLoaded&&Object(P.jsx)(Gn,{annotations:t,timeList:n,urlFile:this.state.urlFile,extensionFile:this.state.extensionFile,doi:this.state.doi,availableOptions:this.props.typeOf,displayOptions:this.props.displayOptions,images:a,video:"video"===this.state.MEDIAFILE.type}),!this.props.recording&&Object(P.jsx)(Gn,{annotations:t,timeList:n,urlFile:this.state.urlFile,extensionFile:this.state.extensionFile,doi:this.state.doi,availableOptions:this.props.typeOf,displayOptions:this.props.displayOptions,images:a,video:"video"===this.state.MEDIAFILE.type})]})},"AppPlayer")}}]),n}(a.Component),Yn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"render",value:function(){return Object(P.jsx)("div",{children:Object(P.jsx)(_.a,{children:"Export options : xml, LateX"})})}}]),n}(a.Component);En={textTranscriptions:[],textTranslations:[],sentenceTranscriptions:[],sentenceTranslations:[],wordTranscriptions:[],wordTranslations:[],morphemeTranscriptions:[],morphemeTranslations:[],notes:[],lang:"fr",mode:"normal",continuousPlay:!0};var $n=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).refreshDocument=function(){var e=parseInt(a.getUrlParameter("tab")),t=a.getUrlParameter("expanded");a.setState({loading:!0});for(var n=0;n<localStorage.length;n++)0===localStorage.key(n).indexOf("image")&&localStorage.removeItem(localStorage.key(n));ie.get(a.props.match.params.docId).then((function(n){if("object"===typeof n){var s={text:{}};s.text.transcriptions=[],s.text.translations=[],s.sentence={},s.sentence.transcriptions=[],s.sentence.translations=[],s.word={},s.word.transcriptions=[],s.word.translations=[],s.morpheme={},s.morpheme.transcriptions=[],s.morpheme.translations=[],s.note={},s.note.translations=[],a.parseTypeOf(n.annotations[0],s),n.typeOf=s,a.setState({currentDocument:n,typeOf:s,loading:!1,value:e,expanded:"true"===t})}}),(function(e){401===e.response.status&&a.props.history.push("/login"),a.setState({currentDocument:e.response&&e.response.data||e.message||e.toString(),loading:!1})}))},a.refreshDocumentAnnotations=function(e){var t=a.state.currentDocument;t.annotations=e;var n={text:{}};n.text.transcriptions=[],n.text.translations=[],n.sentence={},n.sentence.transcriptions=[],n.sentence.translations=[],n.word={},n.word.transcriptions=[],n.word.translations=[],n.morpheme={},n.morpheme.transcriptions=[],n.morpheme.translations=[],n.note={},n.note.translations=[],a.parseTypeOf(e[0],n),t.typeOf=n,a.setState({currentDocument:t})},a.state={currentUser:O.getCurrentUser(),currentDocument:{},value:0,loading:!0,expanded:!1},a}return Object(c.a)(n,[{key:"getUrlParameter",value:function(e){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}},{key:"buildUrl",value:function(){var e=new URLSearchParams(window.location.search);e.set("tab",this.state.value),e.set("expanded",this.state.expanded);var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+e.toString();window.history.pushState("test","",t)}},{key:"parseTypeOf",value:function(e,t){var n=this,a={T:"text",S:"sentence",W:"word",M:"morpheme"};return e.forms.forEach((function(n){!t[a[e.type]].transcriptions.includes(n.kindOf)&&t[a[e.type]].transcriptions.push(n.kindOf)})),e.translations.forEach((function(n){!t[a[e.type]].translations.includes(n.lang)&&t[a[e.type]].translations.push(n.lang)})),e.children_annotations.forEach((function(e){n.parseTypeOf(e,t)})),t}},{key:"componentDidMount",value:function(){this.refreshDocument()}},{key:"render",value:function(){var e=this;function t(e){var t=e.children,n=e.value,a=e.index,s=Object(Re.a)(e,["children","value","index"]);return Object(P.jsx)("div",Object(r.a)(Object(r.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},s),{},{children:n===a&&Object(P.jsx)(N.a,{div:3,children:Object(P.jsx)(L.a,{component:"div",children:t})})}))}function n(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return Object(P.jsxs)(_.a,{children:[this.state.loading&&Object(P.jsx)(y.a,{}),!this.state.loading&&Object(P.jsx)(Le.a,{position:"static",children:Object(P.jsxs)(Fe.a,{value:this.state.value,onChange:function(t,n){e.setState({value:n},(function(){this.buildUrl()}))},"aria-label":"tabs",children:[Object(P.jsx)(_e.a,Object(r.a)({label:"Description"},n(0))),Object(P.jsx)(_e.a,Object(r.a)({label:"Resources"},n(1))),Object(P.jsx)(_e.a,Object(r.a)({label:"Annotations"},n(2))),Object(P.jsx)(_e.a,Object(r.a)({label:"Preview"},n(3))),Object(P.jsx)(_e.a,Object(r.a)({label:"Export"},n(4)))]})}),!this.state.loading&&Object(P.jsx)(t,{value:this.state.value,index:0,children:Object(P.jsx)(ot,{document:this.state.currentDocument})}),Object(P.jsx)(t,{value:this.state.value,index:1,children:Object(P.jsx)(jt,{documentId:this.state.currentDocument.id,recording:this.state.currentDocument.recording,images:this.state.currentDocument.images})}),Object(P.jsx)(t,{value:this.state.value,index:2,children:Object(P.jsx)(An,{documentId:this.state.currentDocument.id,documentType:this.state.currentDocument.type,recording:this.state.currentDocument.recording,images:this.state.currentDocument.images,annotations:this.state.currentDocument.annotations,available_kindOf:this.state.currentDocument.available_kindOf,available_lang:this.state.currentDocument.available_lang,refreshDocumentAnnotations:this.refreshDocumentAnnotations,expanded:this.state.expanded})}),Object(P.jsx)(t,{value:this.state.value,index:3,children:Object(P.jsx)(Jn,{documentId:this.state.currentDocument.id,documentType:this.state.currentDocument.type,recording:this.state.currentDocument.recording,images:this.state.currentDocument.images,annotations:this.state.currentDocument.annotations,typeOf:this.state.currentDocument.typeOf,displayOptions:En})}),Object(P.jsx)(t,{value:this.state.value,index:4,children:Object(P.jsx)(Yn,{annotations:this.state.currentDocument.annotations})})]})}}]),n}(a.Component),Qn=Object(m.f)($n),Zn=n(286),ea=n(284),ta=n(123),na=n(207),aa=n(277),sa=n.n(aa),oa=n(201),ia=n.n(oa),ra=n(278),la=n.n(ra),ca=n(279),da=n.n(ca),pa=n(280),ha=n.n(pa),ua=n(98),ma=n(564),ga=Object(ua.a)({palette:{type:"light",primary:{main:"#1d2654"},secondary:{main:"#00a096"},background:{default:"#ede7f6"}},typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Chivo"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")}}),ja=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleToggle=function(){a.setState({openMenu:!0})},a.handleCloseMenu=function(e){a.setState({openMenu:!1})},a.redirect=function(){window.location.href=a.state.notificationLink},a.logOut=a.logOut.bind(Object(d.a)(a)),a.state={currentUser:void 0,openMenu:!1,anchorRef:s.a.createRef()},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=O.getCurrentUser();e&&this.setState({currentUser:e})}},{key:"logOut",value:function(){O.logout(),this.props.history.push("/login")}},{key:"handleListKeyDown",value:function(e){"Tab"===e.key&&(e.preventDefault(),this.setState({openMenu:!1}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.openMenu,a=t.anchorRef;return Object(P.jsx)(ma.a,{theme:ga,children:Object(P.jsxs)("div",{children:[Object(P.jsx)(S.a,{ref:a,"aria-controls":n?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:this.handleToggle,children:Object(P.jsx)(sa.a,{})}),Object(P.jsx)(_n.a,{open:n,role:void 0,anchorEl:a.current,transition:!0,disablePortal:!0,children:function(t){var a=t.TransitionProps,s=t.placement;return Object(P.jsx)(ea.a,Object(r.a)(Object(r.a)({},a),{},{style:{transformOrigin:"bottom"===s?"center top":"center bottom"},children:Object(P.jsx)(ta.a,{children:Object(P.jsx)(Zn.a,{onClickAway:e.handleCloseMenu,children:Object(P.jsx)(na.a,{autoFocusItem:n,id:"menu-list-grow",onKeyDown:e.handleListKeyDown,children:"undefined"===typeof e.state.currentUser?Object(P.jsxs)("div",{children:[Object(P.jsx)(Te.a,{children:Object(P.jsx)(S.a,{component:u.b,to:"/login",startIcon:Object(P.jsx)(ia.a,{}),disableElevation:!0,children:"Login"})}),Object(P.jsx)(Te.a,{children:Object(P.jsx)(S.a,{component:u.b,to:"/register",startIcon:Object(P.jsx)(la.a,{}),disableElevation:!0,children:"Sign Up"})})]}):Object(P.jsxs)("div",{children:[Object(P.jsx)(Te.a,{children:Object(P.jsx)(S.a,{component:u.b,to:"/profile",startIcon:Object(P.jsx)(da.a,{}),disableElevation:!0,onClick:e.handleCloseMenu,children:"My Profile"})}),Object(P.jsx)(Te.a,{children:Object(P.jsx)(S.a,{component:u.b,to:"/documents",startIcon:Object(P.jsx)(ha.a,{}),disableElevation:!0,onClick:e.handleCloseMenu,children:"My documents"})}),Object(P.jsx)(Te.a,{children:Object(P.jsx)(S.a,{component:u.b,startIcon:Object(P.jsx)(ia.a,{}),disableElevation:!0,onClick:e.logOut,children:"Logout"})})]})})})})}))}}),Object(P.jsx)(_.a,{className:"container mt-3",children:Object(P.jsxs)(m.c,{children:[Object(P.jsx)(m.a,{exact:!0,path:["/","/home"],component:ne}),Object(P.jsx)(m.a,{path:"/login",component:B}),Object(P.jsx)(m.a,{path:"/register",component:$}),Object(P.jsx)(m.a,{path:"/profile",component:se}),Object(P.jsx)(m.a,{path:"/documents/:docId",component:Qn}),Object(P.jsx)(m.a,{path:"/documents",component:Ie})]})})]})})}}]),n}(a.Component),ba=Object(m.f)(ja),fa=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,585)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),s(e),o(e),i(e)}))},Oa={"Continuous play":{en:"Continuous play",fr:"Lecture en continu"},other:{en:"other",fr:"autre"},"Text transcription":{en:"Text transcription",fr:"Transcription du texte"},"Display options":{en:"Display options",fr:"Options d'affichage"},"Text translation":{en:"Text translation",fr:"Traduction du texte"},"Sentence transcription":{en:"Sentence transcription",fr:"Transcription des phrases"},"Sentence translation":{en:"Sentence translation",fr:"Traduction des phrases"},"Word transcription":{en:"Word transcription",fr:"Transcription des mots"},"Word translation":{en:"Word translation",fr:"Traduction des mots"},"Morpheme transcription":{en:"Morpheme transcription",fr:"Transcription des morph\xe8mes"},"Morpheme translation":{en:"Morpheme translation",fr:"Traduction des morph\xe8mes"},Words:{en:"Words",fr:"Mot \xe0 mot"}};i.a.render(Object(P.jsx)(u.a,{basename:"/editor",children:Object(P.jsx)(In.a,{language:"en",translation:Oa,children:Object(P.jsx)(ba,{})})}),document.getElementById("root")),fa()}},[[501,1,2]]]);
//# sourceMappingURL=main.46f2735c.chunk.js.map